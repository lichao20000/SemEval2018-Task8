Blue NNP O O
Coat NNP O O
researchers NNS O O
have VBP O O
uncovered VBN O O
a DT O O
previously-undocumented JJ O O
, , O O
highly RB O O
automated VBN O O
, , O O
and CC O O
extremely RB O O
sophisticated JJ O O
framework NN O O
for IN O O
performing VBG O O
targeted VBN O O
attacks NNS O O
. . O O

The DT B-Entity 1
framework NN I-Entity O
is VBZ O O
notable JJ O O
for IN O O
a DT O O
number NN O O
of IN O O
reasons NNS O O
, , O O
including VBG O O
( NN O O
but CC O O
not RB O O
limited VBN O O
to TO O O
) VB O O
its PRP$ O O
use NN B-Action 2
of IN O O
a DT B-Entity 3
cloud-based JJ I-Entity O
infrastructure NN I-Entity O
for IN B-Modifier 4
command-and-control JJ B-Entity 5
and CC O O
its PRP$ O O
use NN B-Action 6
of IN O O
the DT B-Entity 7
WebDAV NN I-Entity O
protocol NN I-Entity O
to TO B-Modifier 8
send VB B-Entity 9
instructions NNS I-Entity O
and CC O O
receive VB B-Entity 10
exfiltrated JJ I-Entity O
information NN I-Entity O
from IN I-Entity O
compromised VBN I-Entity O
systems NNS I-Entity O
. . O O

Initial JJ O O
malware NN O O
components NNS O O
were VBD O O
embedded VBN O O
in IN O O
Rich NNP O O
Text VB O O
Format FW O O
( FW O O
RTF NN O O
) CD O O
files NNS O O
. . O O

Exploitation NN B-Entity 1
of IN I-Entity O
vulnerabilities NNS I-Entity O
in IN I-Entity O
this DT I-Entity O
file NN I-Entity O
format NN I-Entity O
is VBZ B-Action 2
leveraged JJ I-Action O
to TO B-Modifier 3
gain VB B-Entity 4
remote JJ I-Entity O
access NN I-Entity O
to TO I-Entity O
victim NN I-Entity O
's POS I-Entity O
computers NNS I-Entity O
. . O O

The DT B-Entity 1
framework NN I-Entity O
, , O O
thus RB O O
far RB O O
, , O O
has VBZ O O
been VBN B-Action 2
using VBG I-Action O
the DT B-Entity 3
services NNS I-Entity O
of IN I-Entity O
a DT I-Entity O
cloud NN I-Entity O
service NN I-Entity O
provider NN I-Entity O
based VBN I-Entity O
in IN I-Entity O
Sweden NNP I-Entity O
, , I-Entity O
CloudMe.com NNP I-Entity O
, , O O
for IN B-Modifier 4
its PRP$ B-Entity 5
main JJ I-Entity O
command-and-control JJ I-Entity O
infrastructure NN I-Entity O
. . O O

Malware NNP O O
payloads NNS O O
designed VBN O O
for IN O O
a DT O O
wide JJ O O
array NN O O
of IN O O
potential JJ O O
devices NNS O O
, , O O
including VBG O O
home NN O O
routers NNS O O
and CC O O
mobile JJ O O
devices NNS O O
running VBG O O
iOS NNP O O
, , O O
BlackBerryOS NNP O O
or CC O O
Android NNP O O
, , O O
were VBD O O
also RB O O
recovered VBN O O
during IN O O
the DT O O
course NN O O
of IN O O
our PRP$ O O
research NN O O
. . O O

The DT O O
framework NN O O
is VBZ O O
designed VBN O O
in IN O O
such PDT O O
a DT O O
way NN O O
that IN O O
all DT B-Entity 1
post-infection JJ I-Entity O
communication NN I-Entity O
( FW I-Entity O
i.e FW I-Entity O
. . I-Entity O
target NN I-Entity O
surveying NN I-Entity O
, , I-Entity O
configuration NN I-Entity O
updates NNS I-Entity O
, , I-Entity O
malware NN I-Entity O
updates NNS I-Entity O
, , I-Entity O
and CC I-Entity O
data NNS I-Entity O
exfiltration NN I-Entity O
) NN I-Entity O
can MD O O
be VB B-Action 2
performed VBN I-Action O
via IN B-Modifier 3
the DT B-Entity 4
cloud NN I-Entity O
service NN I-Entity O
. . O O

The DT O O
malware NN O O
components NNS O O
of IN O O
this DT O O
framework NN O O
follow VBP O O
a DT O O
plugin NN O O
model NN O O
, , O O
where WRB O O
new JJ O O
malware NN O O
rely VBP O O
on IN O O
other JJ O O
, , O O
previously RB O O
delivered VBN O O
malware NN O O
components NNS O O
to TO O O
interact VB O O
with IN O O
the DT O O
framework NN O O
. . O O

Initial JJ O O
attacks NNS O O
were VBD O O
largely RB O O
focused VBN O O
on IN O O
Russia NNP O O
and CC O O
a DT O O
few JJ O O
other JJ O O
Eastern JJ O O
European JJ O O
countries NNS O O
. . O O

However RB O O
, , O O
we PRP O O
have VBP O O
later RB O O
seen VBN O O
that IN O O
attackers NNS O O
are VBP O O
interested JJ O O
in IN O O
targets NNS O O
all DT O O
over IN O O
the DT O O
globe NN O O
. . O O

The DT O O
framework NN O O
is VBZ O O
itself PRP O O
target-agnostic JJ O O
, , O O
and CC O O
seems VBZ O O
highly RB O O
automated VBN O O
. . O O

The DT O O
operational JJ O O
security NN O O
exhibited VBN O O
by IN O O
the DT O O
attackers NNS O O
is VBZ O O
very RB O O
good JJ O O
- : O O
among IN O O
the DT O O
best JJS O O
we PRP O O
have VBP O O
seen VBN O O
. . O O

Most JJS B-Entity 1
interaction NN I-Entity O
between IN I-Entity O
attackers NNS I-Entity O
and CC I-Entity O
their PRP$ I-Entity O
infrastructure NN I-Entity O
is VBZ B-Action 2
performed VBN I-Action O
via IN B-Modifier 3
a DT B-Entity 4
convoluted JJ I-Entity O
network NN I-Entity O
of IN I-Entity O
router NN I-Entity O
proxies NNS I-Entity O
and CC I-Entity O
rented VBN I-Entity O
hosts NNS I-Entity O
. . O O

Although IN O O
the DT O O
attackers NNS O O
have VBP O O
left VBN O O
a DT O O
few JJ O O
clues NNS O O
, , O O
we PRP O O
have VBP O O
been VBN O O
unable JJ O O
to TO O O
provide VB O O
attribution NN O O
with IN O O
any DT O O
degree NN O O
of IN O O
accuracy NN O O
. . O O

The DT O O
use NN O O
of IN O O
software NN O O
vulnerabilities NNS O O
in IN O O
order NN O O
to TO O O
execute VB O O
malicious JJ O O
software NN O O
on IN O O
unsuspecting JJ O O
users NNS O O
' POS O O
computers NNS O O
is VBZ O O
an DT O O
important JJ O O
parameter NN O O
to TO O O
monitor VB O O
. . O O

This DT O O
method NN O O
of IN O O
attack NN O O
is VBZ O O
not RB O O
only RB O O
known VBN O O
to TO O O
have VB O O
a DT O O
considerable JJ O O
success NN O O
rate NN O O
, , O O
it PRP O O
is VBZ O O
also RB O O
often RB O O
deployed VBN O O
by IN O O
resourceful JJ O O
attackers NNS O O
and CC O O
, , O O
as IN O O
such JJ O O
, , O O
marks VBZ O O
a DT O O
threat NN O O
worth JJ O O
paying VBG O O
attention NN O O
to TO O O
. . O O

The DT O O
use NN O O
of IN O O
exploits NNS O O
in IN O O
document NN O O
formats NNS O O
like IN O O
PDF NN O O
, , O O
DOC NN O O
and CC O O
RTF NN O O
is VBZ O O
in IN O O
some DT O O
ways NNS O O
especially RB O O
noteworthy JJ O O
. . O O

Documents NNS O O
are VBP O O
commonly RB O O
exchanged VBN O O
via IN O O
mail NN O O
, , O O
which WDT O O
make VBP O O
them PRP O O
perfect JJ O O
for IN O O
email-borne JJ O O
targeted JJ O O
attacks NNS O O
; : O O
what WP O O
is VBZ O O
otherwise RB O O
known VBN O O
as IN O O
spear NN O O
phishing NN O O
. . O O

In IN O O
March NNP O O
, , O O
2014 CD O O
, , O O
Microsoft NNP O O
published VBD O O
information NN O O
about IN O O
a DT O O
new JJ O O
vulnerability NN O O
in IN O O
Rich NNP O O
Text VB O O
Format FW O O
( FW O O
RTF NN O O
) NN O O
. . O O

This DT O O
vulnerability NN O O
, , O O
named VBN O O
CVE-2014-1761 NN O O
( NN O O
Microsoft NNP O O
Word NNP O O
RTF NNP O O
Object NNP O O
Confusion NNP O O
) NNP O O
, , O O
had VBD O O
already RB O O
been VBN O O
used VBN O O
effectively RB O O
by IN O O
attackers NNS O O
at IN O O
the DT O O
time NN O O
of IN O O
the DT O O
announcement NN O O
. . O O

Two CD O O
previous JJ O O
vulnerabilities NNS O O
in IN O O
the DT O O
RTF NN O O
file NN O O
format NN O O
, , O O
known VBN O O
as IN O O
CVE-2010-3333 NN O O
and CC O O
CVE-2012-0158 NN O O
, , O O
had VBD O O
become VBN O O
, , O O
by IN O O
that DT O O
time NN O O
, , O O
mainstays NNS O O
of IN O O
targeted VBN O O
attacks NNS O O
, , O O
so IN O O
we PRP O O
tracked VBD O O
how WRB O O
attackers NNS O O
implemented VBD O O
this DT O O
new JJ O O
exploit VBP O O
with IN O O
keen JJ O O
interest NN O O
. . O O

By IN O O
late JJ O O
August NNP O O
, , O O
we PRP O O
identified VBD O O
a DT O O
malware NN O O
espionage NN O O
operation NN O O
that WDT O O
used VBD O O
both DT O O
the DT O O
CVE-2014-1761 NN O O
and CC O O
CVE-2012-0158 NN O O
vulnerabilities NNS O O
to TO O O
trigger VB O O
execution NN O O
of IN O O
the DT O O
malicious JJ O O
payload NN O O
, , O O
and CC O O
which WDT O O
leveraged VBD O O
a DT O O
single JJ O O
cloud NN O O
service NN O O
as IN O O
the DT O O
backbone NN O O
of IN O O
its PRP$ O O
entire JJ O O
visible JJ O O
infrastructure NN O O
. . O O

When WRB O O
we PRP O O
examined VBD O O
the DT O O
suspicious JJ O O
documents NNS O O
, , O O
it PRP O O
was VBD O O
discovered VBN O O
that IN O O
they PRP O O
were VBD O O
somewhat RB O O
anomalous JJ O O
compared VBN O O
to TO O O
the DT O O
run-of-the-mill JJ O O
material NN O O
. . O O

They PRP O O
turned VBD O O
out RP O O
to TO O O
belong VB O O
to TO O O
a DT B-Entity 1
highly RB I-Entity O
advanced JJ I-Entity O
and CC I-Entity O
professional JJ I-Entity O
targeted VBN I-Entity O
attack NN I-Entity O
framework NN I-Entity O
, , O O
which WDT O O
utilized VBD B-Action 2
a DT B-Entity 3
complex JJ I-Entity O
series NN I-Entity O
of IN I-Entity O
techniques NNS I-Entity O
to TO B-Modifier 4
survey VB B-Entity 5
potential JJ I-Entity O
targets NNS I-Entity O
. . O O

Due JJ O O
to TO O O
the DT O O
many JJ O O
levels NNS O O
of IN O O
obfuscation NN O O
and CC O O
indirection NN O O
, , O O
we PRP O O
named VBD O O
this DT O O
the DT O O
Inception NNP O O
framework NN O O
; : O O
but CC O O
there EX O O
ends VBZ O O
all DT O O
similarity NN O O
with IN O O
the DT O O
movie NN O O
by IN O O
the DT O O
same JJ O O
name NN O O
. . O O

Leonardo NNP O O
DiCaprio NNP O O
is VBZ O O
not RB O O
associated VBN O O
with IN O O
this DT O O
investigation NN O O
. . O O

We PRP O O
initially RB O O
knew VBD O O
little JJ O O
about IN O O
who WP O O
the DT O O
actual JJ O O
targets NNS O O
were VBD O O
; : O O
apart RB O O
from IN O O
one CD O O
. . O O

In IN O O
that DT O O
particular JJ O O
case NN O O
we PRP B-Entity 1
had VBD B-Action 2
the DT B-Entity 3
actual JJ I-Entity O
phishing NN I-Entity O
email NN I-Entity O
, , O O
so IN O O
we PRP O O
knew VBD O O
the DT O O
apparent JJ O O
recipient JJ O O
â€“ NN O O
the DT O O
CEO NN O O
of IN O O
a DT O O
large JJ O O
Russian JJ O O
bank NN O O
. . O O

The DT O O
email NN O O
was VBD O O
apparently RB O O
sent VBN O O
from IN O O
'' '' O O
Mrs. NNP O O
World NNP O O
'' '' O O
; : O O
note VB O O
the DT O O
Mrs. NNP O O
, , O O
and CC O O
not RB O O
Miss NNP O O
- : O O
World NNP O O
. . O O

We PRP O O
soon RB O O
discovered VBD O O
that IN O O
our PRP$ O O
malware NN O O
repository NN O O
contained VBD O O
several JJ O O
other JJ O O
, , O O
similar JJ O O
documents NNS O O
, , O O
but CC O O
these DT O O
had VBD O O
come VBN O O
from IN O O
other JJ O O
sources NNS O O
which WDT O O
did VBD O O
not RB O O
include VB O O
the DT O O
email NN O O
message NN O O
, , O O
or CC O O
any DT O O
identifiable JJ O O
information NN O O
about IN O O
the DT O O
targets NNS O O
. . O O

However RB O O
, , O O
the DT O O
text NN O O
of IN O O
the DT O O
documents NNS O O
covered VBD O O
a DT O O
variety NN O O
of IN O O
topics NNS O O
mostly RB O O
revolving VBG O O
around IN O O
Russian JJ O O
issues NNS O O
relating VBG O O
to TO O O
a DT O O
variety NN O O
of IN O O
business NN O O
sectors NNS O O
. . O O

The DT O O
following JJ O O
pages NNS O O
highlight VBP O O
a DT O O
representative JJ O O
selection NN O O
of IN O O
these DT O O
documents NNS O O
. . O O

All DT O O
documents NNS O O
that IN O O
we PRP O O
have VBP O O
found VBN O O
so RB O O
far RB O O
have VBP O O
been VBN O O
rather RB O O
standard JJ O O
Word NN O O
documents NNS O O
, , O O
of IN O O
the DT O O
old JJ O O
97-2003 CD O O
compatible JJ O O
format NN O O
based VBN O O
on IN O O
OLE2 NN O O
. . O O

Such JJ O O
documents NNS O O
can MD O O
, , O O
and CC O O
typically RB O O
do VBP O O
, , O O
contain VBP O O
quite RB O O
a DT O O
bit NN O O
of IN O O
metadata NN O O
: : O O
The DT O O
name NN O O
of IN O O
the DT O O
document NN O O
creator NN O O
; : O O
the DT O O
user NN O O
who WP O O
edited VBD O O
it PRP O O
most RBS O O
recently RB O O
; : O O
the DT O O
name NN O O
of IN O O
the DT O O
company NN O O
whose WP$ O O
copy NN O O
of IN O O
Word NN O O
was VBD O O
used VBN O O
to TO O O
create VB O O
the DT O O
document NN O O
, , O O
et FW O O
al FW O O
. . O O

Users NNS O O
can MD O O
optionally RB O O
configure VB O O
Word NN O O
to TO O O
remove VB O O
this DT O O
metadata NN O O
when WRB O O
a DT O O
document NN O O
is VBZ O O
saved VBN O O
, , O O
and CC O O
that DT O O
's VBZ O O
exactly RB O O
what WP O O
the DT O O
creator NN O O
of IN O O
these DT O O
documents NNS O O
did VBD O O
, , O O
stripping VBG O O
out RP O O
this DT O O
potential JJ O O
source NN O O
of IN O O
attribution NN O O
data NNS O O
. . O O

However RB O O
, , O O
Word NN O O
documents NNS O O
in IN O O
this DT O O
format NN O O
contain VBP O O
additional JJ O O
information NN O O
, , O O
if IN O O
you PRP O O
know VBP O O
where WRB O O
to TO O O
look VB O O
. . O O

All NNP O O
Word NNP O O
documents NNS O O
of IN O O
this DT O O
format NN O O
contain VBP O O
what WP O O
's VBZ O O
known VBN O O
as IN O O
a DT O O
File NNP O O
Information NNP O O
Block NNP O O
( FW O O
FIB FW O O
) FW O O
. . O O

The DT O O
FIB NN O O
contains VBZ O O
information NN O O
about IN O O
the DT O O
file NN O O
's POS O O
internal JJ O O
structure NN O O
, , O O
and CC O O
also RB O O
â€“ CD O O
to TO O O
some DT O O
extent NN O O
â€“ CD O O
data NNS O O
on IN O O
the DT O O
program NN O O
used VBN O O
to TO O O
create VB O O
the DT O O
file NN O O
. . O O

In IN O O
the DT O O
case NN O O
of IN O O
the DT O O
samples NNS O O
we PRP O O
analyzed VBD O O
, , O O
all DT O O
of IN O O
the DT O O
documents NNS O O
were VBD O O
saved VBN O O
using VBG O O
the DT O O
same JJ O O
build VB O O
of IN O O
Microsoft NNP O O
Word NNP O O
from IN O O
Office14 FW O O
( FW O O
better RBR O O
known VBN O O
as IN O O
Office NNP O O
2010 CD O O
) NNP O O
. . O O

In IN O O
addition NN O O
, , O O
documents NNS O O
can MD O O
contain VB O O
slack JJ O O
space NN O O
in IN O O
which WDT O O
old JJ O O
data NNS O O
remains VBZ O O
. . O O

For IN O O
example NN O O
, , O O
the DT O O
decoy NN O O
that WDT O O
came VBD O O
with IN O O
the DT O O
attack NN O O
named VBN O O
'' '' O O
Organigrama FW O O
Gobierno FW O O
Rusia.doc NN O O
'' '' O O
contains VBZ O O
Visual JJ O O
Basic JJ O O
leftovers NNS O O
indicating VBG O O
that IN O O
it PRP O O
originally RB O O
was VBD O O
created VBN O O
on IN O O
a DT O O
computer NN O O
that WDT O O
was VBD O O
configured VBN O O
to TO O O
be VB O O
used VBN O O
by IN O O
a DT O O
native JJ O O
Spanish JJ O O
speaker NN O O
, , O O
apparently RB O O
by IN O O
an DT O O
advisor NN O O
at IN O O
the DT O O
Spanish NNP O O
Embassy NNP O O
in IN O O
Moscow NNP O O
. . O O

This DT B-Entity 1
document NN I-Entity O
was VBD B-Action 2
presumably RB I-Action O
obtained VBN I-Action O
by IN O O
the DT B-Entity 3
attackers NNS I-Entity O
and CC O O
repurposed VBN B-Action 4
for IN B-Modifier 5
the DT B-Entity 6
attack NN I-Entity O
. . O O

Despite IN O O
the DT O O
limited JJ O O
information NN O O
at IN O O
our PRP$ O O
disposal NN O O
about IN O O
the DT O O
targets NNS O O
of IN O O
these DT O O
attacks NNS O O
, , O O
their PRP$ O O
content NN O O
reveals VBZ O O
some DT O O
context NN O O
about IN O O
who WP O O
the DT O O
possible JJ O O
targets NNS O O
may MD O O
have VB O O
been VBN O O
. . O O

First NNP O O
of IN O O
all DT O O
, , O O
we PRP B-Entity 1
have VBP B-Action 2
the DT B-Entity 3
decoy NN I-Entity O
documents NNS I-Entity O
which WDT O O
indicate VBP O O
an DT O O
interest NN O O
in IN O O
: : O O
We PRP B-Entity 4
also RB O O
have VBP B-Action 5
a DT B-Entity 6
set NN I-Entity O
of IN I-Entity O
phishing FW I-Entity O
mails FW I-Entity O
, , O O
which WDT O O
were VBD O O
targeted VBN O O
at IN O O
: : O O
The DT O O
shellcode NN O O
used VBN O O
is VBZ O O
a DT O O
pretty RB O O
standard JJ O O
variant NN O O
previously RB O O
used VBN O O
by IN O O
a DT O O
number NN O O
of IN O O
campaigns NNS O O
typically RB O O
operating VBG O O
out IN O O
of IN O O
China NNP O O
, , O O
but CC O O
with IN O O
some DT O O
minor JJ O O
changes NNS O O
. . O O

The DT B-Entity 1
malicious JJ I-Entity O
content NN I-Entity O
is VBZ B-Action 2
stored VBN I-Action O
inside IN B-Modifier 3
the DT B-Entity 4
document NN I-Entity O
in IN B-Modifier 5
encoded VBN B-Entity 6
form NN I-Entity O
, , O O
and CC O O
the DT B-Entity 7
shellcode NN I-Entity O
decodes VBZ O O
and CC O O
writes VBZ B-Action 8
this DT B-Entity 9
to TO B-Modifier 10
disk NN B-Entity 11
. . O O

Upon IN O O
successful JJ O O
execution NN O O
this DT B-Entity 1
code NN I-Entity O
drops VBZ B-Action 2
a DT B-Entity 3
Word NN I-Entity O
document NN I-Entity O
and CC I-Entity O
a DT I-Entity O
Visual JJ I-Entity O
Basic JJ I-Entity O
script NN I-Entity O
. . O O

The DT O O
Word NN O O
document NN O O
is VBZ O O
displayed VBN O O
to TO O O
the DT O O
user NN O O
to TO O O
avoid VB O O
arousing VBG O O
any DT O O
suspicion NN O O
while IN O O
the DT B-Entity 1
script NN I-Entity O
is VBZ B-Action 2
executed VBN I-Action O
in IN B-Modifier 3
the DT B-Entity 4
background NN I-Entity O
. . O O

Unusual JJ O O
for IN O O
many JJ O O
exploit VBP O O
campaigns NNS O O
, , O O
the DT B-Entity 1
names NNS I-Entity O
of IN I-Entity O
the DT I-Entity O
dropped VBN I-Entity O
files NNS I-Entity O
vary VBP O O
; : O O
for IN O O
example NN O O
HyHa9AJ.vbs NNS O O
, , O O
ewRg.vbs NNS O O
, , O O
0QHdN.vbs NNS O O
, , O O
etc FW O O
. . O O

â€“ NN O O
clearly RB O O
randomized VBN B-Action 1
in IN B-Modifier 2
order NN I-Modifier O
to TO I-Modifier O
avoid VB B-Entity 3
detection NN I-Entity O
by IN I-Entity O
name NN I-Entity O
. . O O

The DT O O
VBScript NN O O
dropper NN O O
code NN O O
is VBZ O O
also RB O O
a DT O O
little RB O O
unusual JJ O O
. . O O

It PRP O O
declares VBZ O O
a DT O O
Windows NNP O O
Management NNP O O
Instrumentation NNP O O
( FW O O
WMI FW O O
) FW O O
object NN O O
in IN O O
order NN O O
to TO O O
reach VB O O
components NNS O O
like IN O O
the DT O O
registry NN O O
and CC O O
file NN O O
system NN O O
. . O O

This DT O O
seems VBZ O O
adapted VBN O O
from IN O O
Microsoft NNP O O
example NN O O
code NN O O
, , O O
like IN O O
the DT O O
one NN O O
found VBN O O
at IN O O
http NN O O
: : O O
//msdn.microsoft.com/en-us/library/aa387236 FW O O
( FW O O
v=vs.85 FW O O
) FW O O
.aspx FW O O

When WRB O O
the DT O O
VBSript NN O O
is VBZ O O
run VBN O O
it PRP B-Entity 1
drops VBZ B-Action 2
two CD B-Entity 3
files NNS I-Entity O
to TO B-Modifier 4
disk NN B-Entity 5
. . O O

One CD O O
is VBZ O O
a DT O O
polymorphed JJ O O
dll NN O O
file NN O O
and CC O O
the DT O O
other JJ O O
a DT O O
binary JJ O O
data NN O O
file NN O O
with IN O O
no DT O O
obvious JJ O O
internal JJ O O
structure NN O O
. . O O

This DT B-Entity 1
data NNS I-Entity O
file NN I-Entity O
turns VBZ O O
out RP O O
to TO O O
be VB B-Action 2
encrypted VBN I-Action O
using VBG B-Modifier 3
AES-256 NN B-Entity 4
. . O O

The DT B-Entity 1
files NNS I-Entity O
will MD O O
be VB B-Action 2
installed VBN I-Action O
in IN B-Modifier 3
several JJ B-Entity 4
locations NNS I-Entity O
: : O O
These DT O O
locations NNS O O
will MD O O
vary VB O O
some DT O O
between IN O O
operating VBG O O
system NN O O
versions NNS O O
. . O O

The DT B-Entity 1
VBScript NN I-Entity O
then RB O O
sets VBZ B-Action 2
a DT B-Entity 3
startup NN I-Entity O
key NN I-Entity O
in IN B-Modifier 4
the DT B-Entity 5
'' '' I-Entity O
HKCU\Software\Microsoft\Windows\CurrentVersion\Run NN I-Entity O
'' '' I-Entity O
registry NN I-Entity O
path NN I-Entity O
to TO O O
execute VB B-Action 6
the DT B-Entity 7
DLLs NNS I-Entity O
at IN B-Modifier 8
boot NN B-Entity 9
time NN I-Entity O
. . O O

Regardless RB O O
of IN O O
whether IN O O
the DT O O
registry NN O O
launches VBZ O O
the DT O O
DLL NNP O O
or CC O O
when WRB O O
another DT O O
malware FW O O
executable FW O O
starts VBZ O O
the DT O O
DLL NNP O O
directly RB O O
, , O O
the DT B-Entity 1
DLL NNP I-Entity O
is VBZ B-Action 2
launched VBN I-Action O
using VBG B-Modifier 3
regsrv32.exe NN B-Entity 4
with IN B-Modifier 5
the DT B-Entity 6
/s FW I-Entity O
( FW I-Entity O
silent JJ I-Entity O
) NN I-Entity O
option NN I-Entity O
. . O O

The DT O O
names NNS O O
of IN O O
these DT O O
dropped VBN O O
files NNS O O
change VBP O O
from IN O O
attack NN O O
to TO O O
attack NN O O
. . O O

The DT B-Entity 1
one CD I-Entity O
above JJ I-Entity O
drops NNS B-Action 2
ctfmonrc.dll NN B-Entity 3
. . O O

Other JJ O O
names NNS O O
observed VBN O O
were VBD O O
: : O O
The DT O O
encrypted JJ O O
data NN O O
files NNS O O
are VBP O O
named VBN O O
using VBG O O
random JJ O O
words NNS O O
apparently RB O O
taken VBN O O
from IN O O
a DT O O
dictionary NN O O
â€“ NN O O
'' '' O O
acholias FW O O
'' '' O O
, , O O
'' '' O O
arzner NN O O
'' '' O O
, , O O
'' '' O O
bicorporate NN O O
'' '' O O
, , O O
'' '' O O
crockrell NN O O
'' '' O O
, , O O
'' '' O O
damnatorily RB O O
'' '' O O
etc FW O O
. . O O

Looking VBG O O
at IN O O
one CD O O
of IN O O
the DT O O
dropped VBN O O
dlls NNS O O
we PRP O O
can MD O O
see VB O O
the DT O O
authors NNS O O
originally RB O O
called VBD O O
it PRP O O
95Num3P3gm.dll.polymorphed.dll NN O O
. . O O

When WRB O O
executed VBN O O
it PRP O O
will MD O O
rebuild VB O O
the DT O O
original JJ O O
dll FW O O
( FW O O
95Num3p3gm.dll NN O O
, , O O
presumably RB O O
) CD O O
, , O O
load VB B-Action 1
it PRP B-Entity 2
from IN B-Modifier 3
memory NN B-Entity 4
and CC O O
pass NN O O
over IN O O
execution NN O O
. . O O

It PRP O O
is VBZ O O
hard JJ O O
to TO O O
describe VB O O
the DT O O
polymorphed JJ O O
dlls NNS O O
with IN O O
any DT O O
real JJ O O
depth NN O O
, , O O
as IN O O
there EX O O
is VBZ O O
little JJ O O
consistency NN O O
between IN O O
them PRP O O
. . O O

When WRB O O
two CD O O
nearly RB O O
identical JJ O O
dlls NNS O O
are VBP O O
encoded VBN O O
using VBG O O
the DT O O
polymorphic JJ O O
scheme NN O O
there EX O O
is VBZ O O
very RB O O
little JJ O O
code NN O O
in IN O O
common JJ O O
. . O O

The DT O O
call NN O O
graphs NNS O O
are VBP O O
different JJ O O
and CC O O
key JJ O O
functions NNS O O
have VBP O O
varying VBG O O
number NN O O
of IN O O
arguments NNS O O
. . O O

The DT B-Entity 1
polymorphing VBG I-Entity O
mechanism NN I-Entity O
also RB O O
generates VBZ O O
, , O O
and CC O O
inserts NNS O O
, , O O
unique JJ O O
functions NNS O O
all DT O O
of IN O O
which WDT O O
make VBP O O
calls NNS O O
to TO O O
different JJ O O
floating-point JJ O O
operations NNS O O
â€“ VBP O O
all DT O O
done VBN O O
just RB O O
to TO O O
obfuscate VB B-Action 2
the DT B-Entity 3
actual JJ I-Entity O
decoding NN I-Entity O
process NN I-Entity O
. . O O

The DT O O
sizes NNS O O
of IN O O
buffers NNS O O
allocated VBN O O
are VBP O O
also RB O O
randomized VBN O O
to TO O O
mask NN O O
their PRP$ O O
intent NN O O
. . O O

What WP O O
is VBZ O O
common JJ O O
is VBZ O O
that IN O O
somewhere RB O O
along IN O O
the DT O O
execution NN O O
cycle NN O O
is VBZ O O
one CD O O
extremely RB O O
large JJ O O
function NN O O
( NN O O
over IN O O
200 CD O O
kb NN O O
in IN O O
length NN O O
) NN O O
where WRB O O
early RB O O
in IN O O
a DT O O
large JJ O O
allocation NN O O
is VBZ O O
made VBN O O
where WRB O O
the DT O O
un-obfuscated JJ O O
binary JJ O O
will MD O O
be VB O O
placed VBN O O
. . O O

The DT O O
binary JJ O O
is VBZ O O
then RB O O
built VBN O O
from IN O O
de- NN O O
obfuscating VBG O O
segments NNS O O
of IN O O
it PRP O O
that WDT O O
have VBP O O
been VBN O O
dispersed VBN O O
through IN O O
the DT O O
'.rdata NN O O
' POS O O
section NN O O
. . O O

The DT O O
order NN O O
, , O O
size NN O O
, , O O
and CC O O
locations NNS O O
of IN O O
these DT O O
segments NNS O O
vary VBP O O
from IN O O
build VB O O
to TO O O
build VB O O
but CC O O
somewhere RB O O
near IN O O
the DT O O
end NN O O
of IN O O
the DT O O
large JJ O O
function NN O O
there EX O O
will MD O O
be VB O O
a DT B-Entity 1
call NN I-Entity O
to TO I-Entity O
a DT I-Entity O
subfunction NN I-Entity O
that IN O O
loads NNS B-Action 2
the DT B-Entity 3
PE NN I-Entity O
image NN I-Entity O
into IN B-Modifier 4
memory NN B-Entity 5
, , O O
followed VBN O O
by IN O O
a DT B-Entity 6
call NN I-Entity O
to TO O O
free VB B-Action 7
the DT B-Entity 8
PE NN I-Entity O
image NN I-Entity O
allocation NN I-Entity O
from IN B-Modifier 9
memory NN B-Entity 10
. . O O

Simply RB O O
halting VBG O O
execution NN O O
before IN O O
this DT O O
function NN O O
call NN O O
permits VBZ O O
a DT O O
researcher NN O O
to TO O O
extract VB O O
the DT O O
reconstructed JJ O O
DLL NN O O
from IN O O
memory NN O O
. . O O

Here RB O O
, , O O
pausing VBG O O
execution NN O O
before IN O O
the DT O O
call NN O O
to TO O O
'loadpefrommemory NN O O
' '' O O
reveals VBZ O O
the DT O O
extracted VBN O O
PE NN O O
at IN O O
the DT O O
memory NN O O
address NN O O
pointed VBD O O
to TO O O
by IN O O
edx NN O O
. . O O

This NNP O O
reconstructed VBD O O
DLL NNP O O
, , O O
once RB O O
loaded VBN O O
, , O O
will MD O O
decode VB O O
a DT O O
configuration NN O O
structure NN O O
from IN O O
its PRP$ O O
'.data NN O O
' '' O O
section NN O O
which WDT O O
contains VBZ O O
three CD O O
important JJ O O
details NNS O O
: : O O
the DT O O
name NN O O
of IN O O
the DT O O
encrypted JJ O O
data NNS O O
file NN O O
dropped VBN O O
by IN O O
the DT O O
VBScript NN O O
; : O O
the DT O O
AES NN O O
key NN O O
used VBN O O
to TO O O
decrypt VB O O
the DT O O
file NN O O
; : O O
and CC O O
the DT O O
name NN O O
of IN O O
a DT O O
unique JJ O O
global JJ O O
mutex NN O O
to TO O O
hold VB O O
while IN O O
running VBG O O
to TO O O
prevent VB O O
multiple JJ O O
instances NNS O O
. . O O

This DT B-Entity 1
configuration NN I-Entity O
information NN I-Entity O
is VBZ O O
used VBN O O
to TO O O
load VB B-Action 2
the DT B-Entity 3
encrypted JJ I-Entity O
file NN I-Entity O
into IN B-Modifier 4
memory NN B-Entity 5
and CC O O
decrypt VB O O
it PRP O O
. . O O

This DT O O
turns VBZ O O
out RP O O
to TO O O
be VB O O
yet RB O O
another DT O O
dll NN O O
. . O O

The DT O O
first JJ O O
ordinal NN O O
exported VBN O O
by IN O O
this DT O O
dll NN O O
is VBZ O O
located JJ O O
and CC O O
then RB O O
called VBN O O
, , O O
passing VBG O O
in IN O O
the DT O O
configuration NN O O
and CC O O
the DT O O
name NN O O
of IN O O
the DT O O
encrypted JJ O O
file NN O O
on IN O O
disk NN O O
as IN O O
parameters NNS O O
. . O O

This DT O O
last JJ O O
dll NN O O
is VBZ O O
the DT O O
heart NN O O
of IN O O
the DT O O
threat NN O O
( NN O O
originally RB O O
called VBN O O
q5Byo.dll NN O O
in IN O O
this DT O O
instance NN O O
. . O O

This DT O O
file NN O O
contains VBZ O O
the DT O O
true JJ O O
intent NN O O
of IN O O
this DT O O
campaign NN O O
. . O O

It PRP B-Entity 1
is VBZ B-Action 2
designed VBN I-Action O
as IN B-Modifier 3
a DT B-Entity 4
survey NN I-Entity O
tool NN I-Entity O
. . O O

The DT B-Entity 1
PE NN I-Entity O
file NN I-Entity O
gathers VBZ B-Action 2
system NN B-Entity 3
information NN I-Entity O
including VBG O O
OS NN B-Entity 4
version NN I-Entity O
, , O O
computer NN B-Entity 5
name NN I-Entity O
, , O O
user NN B-Entity 6
name NN I-Entity O
, , O O
user NN B-Entity 7
group NN I-Entity O
membership NN I-Entity O
, , O O
the DT B-Entity 8
process NN I-Entity O
it PRP I-Entity O
is VBZ I-Entity O
running VBG I-Entity O
in RP I-Entity O
, , O O
locale NN B-Entity 9
ID NNP I-Entity O
's POS I-Entity O
, , O O
as RB O O
well RB O O
as IN O O
system NN B-Entity 10
drive NN I-Entity O
and CC I-Entity O
volume NN I-Entity O
information NN I-Entity O
. . O O

All DT B-Entity 1
of IN I-Entity O
this DT I-Entity O
is VBZ B-Action 2
encrypted JJ I-Action O
and CC O O
then RB O O
sent VBD B-Action 3
to TO B-Modifier 4
cloud VB B-Entity 5
storage NN I-Entity O
via IN B-Modifier 6
WebDAV NN B-Entity 7
. . O O

WebDAV NN O O
is VBZ O O
a DT O O
communication NN O O
standard NN O O
that WDT O O
allows VBZ O O
file NN O O
management NN O O
over IN O O
HTTP NNP O O
or CC O O
HTTPS NNP O O
. . O O

Windows NNP O O
allows VBZ O O
WebDAV NN O O
sessions NNS O O
to TO O O
be VB O O
mapped VBN O O
as IN O O
network NN O O
resources NNS O O
. . O O

The DT O O
use NN O O
of IN O O
WebDAV NN O O
as IN O O
the DT O O
communication NN O O
channel NN O O
is VBZ O O
atypical JJ O O
for IN O O
most JJS O O
malware NN O O
samples NNS O O
we PRP O O
see VBP O O
. . O O

By IN O O
using VBG O O
a DT O O
network NN O O
resource NN O O
, , O O
the DT O O
actual JJ O O
web NN O O
traffic NN O O
originates VBZ O O
from IN O O
the DT O O
system NN O O
itself PRP O O
, , O O
and CC O O
not RB O O
from IN O O
the DT O O
process NN O O
in IN O O
which WDT O O
the DT O O
malware NN O O
resides VBZ O O
. . O O

Additionally RB O O
, , O O
once RB O O
the DT O O
resource NN O O
is VBZ O O
established VBN O O
, , O O
the DT B-Entity 1
malware NN I-Entity O
can MD O O
transfer VB B-Action 2
files NNS B-Entity 3
to TO B-Modifier 4
and CC O O
from IN B-Modifier 5
the DT B-Entity 6
command NN I-Entity O
and CC I-Entity O
control NN I-Entity O
servers NNS I-Entity O
using VBG B-Modifier 7
standard JJ B-Entity 8
file NN I-Entity O
IO NN I-Entity O
commands NNS I-Entity O
. . O O

All PDT O O
the DT O O
authentication NN O O
information NN O O
for IN O O
the DT O O
WebDAV NN O O
session NN O O
including VBG O O
the DT O O
URL NN O O
, , O O
folders NNS O O
, , O O
path NN O O
, , O O
user NN O O
name NN O O
, , O O
and CC O O
password NN O O
is VBZ O O
stored VBN O O
within IN O O
this DT O O
last JJ O O
DLL NNP O O
in IN O O
another DT O O
AES-encrypted JJ O O
configuration NN O O
structure NN O O
in IN O O
the DT O O
binary JJ O O
. . O O

A DT O O
unique JJ O O
path NN O O
, , O O
username NN O O
, , O O
and CC O O
password NN O O
were VBD O O
used VBN O O
for IN O O
each DT O O
malware NN O O
instance NN O O
we PRP O O
've VBP O O
seen VBN O O
in IN O O
the DT O O
wild JJ O O
. . O O

This DT O O
allows VBZ O O
the DT B-Entity 1
attackers NNS I-Entity O
to TO O O
uniquely RB O O
identify VB B-Action 2
every DT B-Entity 3
targeted VBN I-Entity O
attack NN I-Entity O
and CC O O
track NN O O
how WRB O O
successful JJ O O
each DT O O
phishing VBG O O
campaign NN O O
is VBZ O O
. . O O

Also RB O O
contained VBN O O
within IN O O
the DT O O
configuration NN O O
structure NN O O
is VBZ O O
information NN O O
on IN O O
how WRB O O
to TO O O
name VB O O
the DT O O
survey NN O O
data NNS O O
on IN O O
the DT O O
remote JJ O O
file NN O O
server NN O O
. . O O

The DT O O
binary JJ O O
reads VBZ O O
from IN O O
its PRP$ O O
configuration NN O O
a DT O O
string NN O O
on IN O O
how WRB O O
to TO O O
generate VB O O
the DT O O
remote JJ O O
filename NN O O
, , O O
and CC O O
a DT O O
list NN O O
of IN O O
extensions NNS O O
to TO O O
use VB O O
. . O O

An DT O O
example NN O O
would MD O O
be VB O O
'' '' O O
1-7d0-8s NNS O O
'' '' O O
, , O O
[ NNP O O
'' '' O O
TIF NNP O O
'' '' O O
, , O O
'' '' O O
TAR NN O O
'' '' O O
, , O O
'' '' O O
SIT NN O O
'' '' O O
] NN O O
which WDT O O
instructs VBZ O O
the DT O O
binary JJ O O
to TO O O
generate VB O O
a DT O O
filename NN O O
with IN O O
1 CD O O
to TO O O
7 CD O O
numeric JJ O O
digit NN O O
characters NNS O O
followed VBN O O
by IN O O
0 CD O O
to TO O O
8 CD O O
ASCII NN O O
letters NNS O O
with IN O O
one CD O O
of IN O O
the DT O O
three CD O O
listed VBN O O
extensions NNS O O
such JJ O O
as IN O O
'' '' O O
664gher.TAR NN O O
'' '' O O
. . O O

The DT B-Entity 1
survey NN I-Entity O
is VBZ B-Action 2
then RB I-Action O
uploaded VBN I-Action O
to TO B-Modifier 3
the DT B-Entity 4
server NN I-Entity O
in IN B-Modifier 5
a DT B-Entity 6
specified JJ I-Entity O
folder NN I-Entity O
with IN B-Modifier 7
the DT B-Entity 8
generated VBN I-Entity O
name NN I-Entity O
. . O O

Files NNS B-Entity 1
are VBP B-Action 2
compressed VBN I-Action O
using VBG B-Modifier 3
a DT B-Entity 4
modified VBN I-Entity O
LZMA-compression NN I-Entity O
and CC O O
encrypted VBN B-Action 5
using VBG B-Modifier 6
AES NN B-Entity 7
cipher-block-chaining JJ I-Entity O
( NN I-Entity O
CBC NN I-Entity O
) NN I-Entity O
before IN O O
being VBG B-Action 8
uploaded VBN I-Action O
to TO B-Modifier 9
the DT B-Entity 10
cloud NN I-Entity O
server NN I-Entity O
. . O O

The DT B-Entity 1
binary JJ I-Entity O
also RB O O
checks VBZ B-Action 2
a DT B-Entity 3
separate JJ I-Entity O
folder NN I-Entity O
on IN I-Entity O
the DT I-Entity O
cloud NN I-Entity O
service NN I-Entity O
designated VBN I-Entity O
to TO I-Entity O
contain VB I-Entity O
new JJ I-Entity O
configuration NN I-Entity O
information NN I-Entity O
. . O O

If IN O O
such PDT O O
a DT O O
file NN O O
is VBZ O O
present JJ O O
on IN O O
the DT O O
server NN O O
, , O O
the DT B-Entity 1
malware NN I-Entity O
downloads NNS B-Action 2
the DT B-Entity 3
new JJ I-Entity O
configuration NN I-Entity O
file NN I-Entity O
then RB O O
deletes VBZ B-Action 4
it PRP B-Entity 5
from IN B-Modifier 6
the DT B-Entity 7
server NN I-Entity O
. . O O

The DT O O
cloud NN O O
storage NN O O
provider NN O O
in IN O O
every DT O O
case NN O O
we PRP O O
have VBP O O
seen VBN O O
was VBD O O
the DT O O
Swedish JJ O O
company NN O O
CloudMe.com NN O O
, , O O
which WDT O O
offers VBZ O O
free JJ O O
and CC O O
paid VBN O O
WebDAV NN O O
cloud NN O O
storage NN O O
. . O O

The DT O O
URI NNP O O
model NN O O
used VBN O O
by IN O O
the DT O O
malware NN O O
is VBZ O O
http JJ O O
: : O O
//webdav.cloudme.com/ CD O O
% NN O O
username JJ O O
% NN O O
/CloudDrive/ NN O O
which WDT O O
is VBZ O O
a DT O O
direct JJ O O
reference NN O O
to TO O O
file VB O O
storage NN O O
. . O O

It PRP O O
must MD O O
be VB O O
noted VBN O O
that IN O O
the DT O O
CloudMe NN O O
service NN O O
is VBZ O O
not RB O O
actively RB O O
spreading VBG O O
the DT O O
malicious JJ O O
content NN O O
; : O O
the DT O O
attackers NNS O O
are VBP O O
only RB O O
using VBG O O
it PRP O O
for IN O O
storing VBG O O
their PRP$ O O
files NNS O O
. . O O

We PRP O O
notified VBD O O
CloudMe.com NNP O O
about IN O O
the DT O O
abuse NN O O
of IN O O
their PRP$ O O
services NNS O O
. . O O

Their PRP$ O O
CEO NN O O
, , O O
Mr. NNP O O
Daniel NNP O O
Arthursson NNP O O
, , O O
was VBD O O
none NN O O
too RB O O
happy JJ O O
about IN O O
this DT O O
, , O O
and CC O O
was VBD O O
very RB O O
helpful JJ O O
in IN O O
our PRP$ O O
further JJ O O
research NN O O
. . O O

CloudMe NN O O
has VBZ O O
shared VBN O O
a DT O O
great JJ O O
deal NN O O
of IN O O
log NN O O
information NN O O
related VBN O O
to TO O O
this DT O O
attack NN O O
. . O O

These DT O O
indicate VBP O O
that IN O O
there EX O O
are VBP O O
many JJ O O
other JJ O O
accounts NNS O O
( CD O O
over IN O O
100 CD O O
) CD O O
likely RB O O
related JJ O O
to TO O O
this DT O O
attack NN O O
system NN O O
. . O O

We PRP O O
have VBP O O
no DT O O
way NN O O
of IN O O
verifying VBG O O
this DT O O
with IN O O
absolute JJ O O
certainty NN O O
, , O O
but CC O O
this DT O O
is VBZ O O
what WP O O
we PRP O O
regard VBP O O
as IN O O
a DT O O
high JJ O O
confidence NN O O
assumption NN O O
. . O O

The DT O O
cloud NN O O
accounts NNS O O
are VBP O O
not RB O O
used VBN O O
for IN O O
one-way JJ O O
communication NN O O
only RB O O
. . O O

The DT B-Entity 1
malware NN I-Entity O
also RB O O
checks NNS B-Action 2
configured VBD B-Entity 3
subfolders NNS I-Entity O
for IN B-Modifier 4
updates NNS B-Entity 5
; : O O
and CC O O
if IN O O
these DT O O
are VBP O O
found VBN O O
they PRP B-Entity 6
will MD O O
be VB B-Action 7
downloaded VBN I-Action O
, , O O
decrypted VBN O O
and CC O O
used VBN O O
as IN O O
appropriate JJ O O
. . O O

One CD O O
such JJ O O
case NN O O
is VBZ O O
the DT O O
franko7046 NN O O
account NN O O
, , O O
used VBN O O
against IN O O
the DT O O
previously RB O O
mentioned VBN O O
bank NN O O
CEO NN O O
. . O O

In IN O O
this DT O O
account NN O O
there EX O O
was VBD O O
hidden VBN O O
another DT B-Entity 1
encrypted JJ I-Entity O
configuration NN I-Entity O
file NN I-Entity O
which WDT O O
the DT B-Entity 2
malware NN I-Entity O
downloaded VBN B-Action 3
and CC O O
decrypted VBN O O
. . O O

This DT O O
is VBZ O O
how WRB O O
we PRP O O
found VBD O O
the DT O O
depp3353 NN O O
account NN O O
. . O O

In IN O O
this DT O O
new JJ O O
account NN O O
there EX O O
was VBD O O
another DT O O
surprise NN O O
waiting VBG O O
for IN O O
us PRP O O
â€“ VBD O O
a DT O O
download NN O O
folder NN O O
with IN O O
two CD O O
new JJ O O
encrypted JJ O O
files NNS O O
, , O O
921.bin NN O O
and CC O O
922.bin NN O O
. . O O

Once RB O O
decrypted VBN O O
, , O O
these DT O O
turned VBD O O
out RP O O
to TO O O
be VB O O
PE JJ O O
executables NNS O O
. . O O

The DT O O
two CD O O
new JJ O O
executables NNS O O
are VBP O O
plugins NNS O O
- : O O
quite RB O O
similar JJ O O
to TO O O
each DT O O
other JJ O O
and CC O O
obviously RB O O
compiled VBN O O
on IN O O
the DT O O
same JJ O O
setup NN O O
. . O O

They PRP B-Entity 1
are VBP O O
lightweight JJ O O
and CC O O
intended VBN O O
to TO O O
pull VB B-Action 2
specific JJ B-Entity 3
survey NN I-Entity O
information NN I-Entity O
from IN B-Modifier 4
their PRP$ B-Entity 5
target NN I-Entity O
. . O O

Of IN O O
interest NN O O
, , O O
both DT O O
of IN O O
the DT O O
DLLs NNS O O
originally RB O O
had VBD O O
the DT O O
same JJ O O
internal JJ O O
name NN O O
( FW O O
78wO13YrJ0cB.dll FW O O
) FW O O
. . O O

Presumably RB O O
the DT O O
same JJ O O
PE NN O O
sanitization NN O O
script NN O O
and CC O O
parameters NNS O O
were VBD O O
used VBN O O
on IN O O
both DT O O
. . O O

None NN O O
of IN O O
these DT O O
plugins NNS O O
contain VBP O O
any DT O O
means NNS O O
of IN O O
CnC NN O O
communication NN O O
. . O O

Instead RB O O
, , O O
when WRB O O
they PRP O O
are VBP O O
executed VBN O O
they PRP B-Entity 1
are VBP B-Action 2
passed VBN I-Action O
a DT B-Entity 3
pointer NN I-Entity O
to TO I-Entity O
a DT I-Entity O
function NN I-Entity O
to TO B-Modifier 4
use VB B-Entity 5
for IN I-Entity O
sending VBG I-Entity O
data NNS I-Entity O
back RB I-Entity O
home RB I-Entity O
. . O O

Neither DT O O
are VBP O O
they PRP O O
ever RB O O
written VBD O O
to TO O O
disk NN O O
. . O O

They PRP B-Entity 1
are VBP B-Action 2
executed VBN I-Action O
in IN B-Modifier 3
memory NN B-Entity 4
only RB O O
, , O O
and CC O O
once RB B-Modifier 5
they PRP B-Entity 6
have VBP I-Entity O
completed VBN I-Entity O
the DT B-Entity 7
memory NN I-Entity O
is VBZ B-Action 8
freed VBN I-Action O
. . O O

This DT O O
makes VBZ O O
these DT O O
modules NNS O O
extremely RB O O
stealthy JJ O O
, , O O
flexible JJ O O
and CC O O
compatible JJ O O
with IN O O
multiple JJ O O
toolsets NNS O O
independent JJ O O
of IN O O
what WDT O O
CnC NN O O
method NN O O
is VBZ O O
being VBG O O
used VBN O O
. . O O

921.bin NN B-Entity 1
retrieves VBZ B-Action 2
several JJ B-Entity 3
datapoints NNS I-Entity O
about IN B-Modifier 4
the DT B-Entity 5
infected JJ I-Entity O
machine NN I-Entity O
: : O O
Domain NN B-Entity 6
info NN I-Entity O
; : O O
a DT B-Entity 7
list NN I-Entity O
of IN I-Entity O
running VBG I-Entity O
processes NNS I-Entity O
with IN I-Entity O
all DT I-Entity O
loaded JJ I-Entity O
modules NNS I-Entity O
in IN I-Entity O
each DT I-Entity O
; : O O
the DT B-Entity 8
list NN I-Entity O
of IN I-Entity O
installed JJ I-Entity O
software NN I-Entity O
; : O O
and CC O O
a DT B-Entity 9
complete JJ I-Entity O
hardware NN I-Entity O
profile NN I-Entity O
of IN I-Entity O
the DT I-Entity O
target NN I-Entity O
machine NN I-Entity O
. . O O

922.bin NN B-Entity 1
compiles VBZ B-Action 2
a DT B-Entity 3
dirwalk FW I-Entity O
â€“ FW I-Entity O
a DT I-Entity O
complete JJ I-Entity O
listing NN I-Entity O
of IN I-Entity O
every DT I-Entity O
file NN I-Entity O
path NN I-Entity O
â€“ NN I-Entity O
of IN I-Entity O
each DT I-Entity O
fixed VBN I-Entity O
drive NN I-Entity O
. . O O

All DT B-Entity 1
of IN I-Entity O
this DT I-Entity O
information NN I-Entity O
is VBZ B-Action 2
exfiltrated VBN I-Action O
back RB B-Modifier 3
via IN I-Modifier O
the DT B-Entity 4
same JJ I-Entity O
WebDAV NN I-Entity O
connection NN I-Entity O
. . O O

This DT O O
model NN O O
makes VBZ O O
it PRP O O
possible JJ O O
to TO O O
do VB O O
the DT O O
intrusion NN O O
in IN O O
steps NNS O O
, , O O
with IN O O
verification NN O O
stages NNS O O
in IN O O
between IN O O
; : O O
and CC O O
the DT O O
files NNS O O
will MD O O
not RB O O
be VB O O
easily RB O O
found VBN O O
on IN O O
affected JJ O O
computers NNS O O
. . O O

Based VBN O O
on IN O O
the DT O O
information NN O O
gathered VBN O O
from IN O O
these DT O O
modules NNS O O
, , O O
the DT O O
attackers NNS O O
appear VBP O O
to TO O O
move VB O O
to TO O O
the DT O O
next JJ O O
stage NN O O
of IN O O
their PRP$ O O
attack NN O O
by IN O O
placing VBG O O
more JJR O O
new JJ O O
components NNS O O
on IN O O
the DT O O
WebDAV JJ O O
shares NNS O O
. . O O

Information NNP O O
about IN O O
these DT O O
uploads NNS O O
is VBZ O O
limited VBN O O
by IN O O
the DT O O
fact NN O O
that IN O O
we PRP O O
do VBP O O
not RB O O
have VB O O
the DT O O
AES NN O O
keys NNS O O
to TO O O
decrypt VB O O
much JJ O O
of IN O O
the DT O O
uploaded JJ O O
data NNS O O
, , O O
but CC O O
we PRP O O
have VBP O O
been VBN O O
able JJ O O
to TO O O
see VB O O
some DT O O
upload NN O O
patterns NNS O O
. . O O

What WP O O
we PRP O O
assume VBP O O
to TO O O
be VB O O
third-stage JJ O O
plugins NNS O O
appear VBP O O
on IN O O
the DT O O
shares NNS O O
as IN O O
*.bin NN O O
files NNS O O
of IN O O
roughly RB O O
72kb JJ O O
. . O O

As IN O O
with IN O O
other JJ O O
plugins NNS O O
, , O O
these DT B-Entity 1
are VBP B-Action 2
downloaded VBN I-Action O
and CC O O
deleted VBN B-Action 3
from IN B-Modifier 4
the DT B-Entity 5
share NN I-Entity O
in IN B-Modifier 6
one CD B-Entity 7
go NN I-Entity O
. . O O

However RB O O
, , O O
the DT O O
next JJ O O
day NN O O
, , O O
another DT O O
*.bin NN O O
file NN O O
of IN O O
the DT O O
same JJ O O
size NN O O
will MD O O
be VB O O
uploaded VBN O O
to TO O O
the DT O O
share NN O O
. . O O

This DT O O
is VBZ O O
a DT O O
pattern NN O O
that WDT O O
repeats VBZ O O
itself PRP O O
over IN O O
all DT O O
live JJ O O
accounts NNS O O
. . O O

It PRP O O
seems VBZ O O
that IN O O
because IN O O
the DT O O
plugins NNS O O
exist VBP O O
in IN O O
memory NN O O
only RB O O
, , O O
they PRP B-Entity 1
are VBP B-Action 2
injected VBN I-Action O
daily RB B-Entity 3
to TO B-Modifier 4
ensure VB B-Entity 5
persistence NN I-Entity O
on IN I-Entity O
victim NN I-Entity O
computers NNS I-Entity O
. . O O

Our PRP$ O O
theory NN O O
is VBZ O O
that IN O O
this DT B-Entity 1
malware NN I-Entity O
is VBZ B-Action 2
a DT B-Entity 3
more RBR I-Entity O
typical JJ I-Entity O
datastealer NN I-Entity O
, , O O
and CC O O
we PRP O O
have VBP O O
observed VBN O O
that IN O O
after IN O O
this DT O O
type NN O O
of IN O O
file NN O O
is VBZ O O
planted VBN O O
on IN O O
the DT O O
account NN O O
, , O O
encrypted JJ B-Entity 4
data NN I-Entity O
uploads NNS I-Entity O
from IN I-Entity O
compromised VBN I-Entity O
users NNS I-Entity O
increase VBP B-Action 5
. . O O

Victims NNS B-Entity 1
of IN I-Entity O
this DT I-Entity O
attack NN I-Entity O
will MD O O
connect VB B-Action 2
using VBG B-Modifier 3
the DT B-Entity 4
Windows NNP I-Entity O
WebDAV NN I-Entity O
redirector NN I-Entity O
, , O O
and CC O O
the DT O O
HTTP NN O O
request NN O O
user-agent JJ O O
string NN O O
will MD O O
reflect VB O O
this DT O O
. . O O

For IN O O
Windows NNP O O
XP NN O O
this DT O O
will MD O O
typically RB O O
be VB O O
'' '' O O
Microsoft-WebDAV-MiniRedir/5.1.2600 NN O O
'' '' O O
, , O O
and CC O O
for IN O O
Windows NNP O O
7 CD O O
a DT O O
common JJ O O
user-agent NN O O
is VBZ O O
'' '' O O
Microsoft-WebDAV-MiniRedir/6.1.7601 NN O O
'' '' O O
. . O O

Security NNP O O
researchers NNS O O
â€“ NN O O
and CC O O
there EX O O
are VBP O O
a DT O O
few JJ O O
of IN O O
them PRP O O
- : O O
connect VB O O
in IN O O
a DT O O
variety NN O O
of IN O O
ways NNS O O
; : O O
first RB O O
of IN O O
all DT O O
, , O O
we PRP O O
see VBP O O
a DT O O
number NN O O
of IN O O
connections NNS O O
that WDT O O
are VBP O O
indistinguishable JJ O O
from IN O O
the DT O O
way NN O O
victims NNS O O
connect VBP O O
. . O O

This DT O O
happens VBZ O O
when WRB O O
researchers NNS O O
use VBP O O
lab NN O O
machines NNS O O
with IN O O
live JJ O O
internet NN O O
access NN O O
to TO O O
run VB O O
the DT O O
malware NN O O
. . O O

The DT O O
only JJ O O
way NN O O
we PRP O O
can MD O O
tell VB O O
these DT O O
are VBP O O
researchers NNS O O
is VBZ O O
because IN O O
they PRP O O
connect VBP O O
from IN O O
IP NNP O O
address NN O O
ranges NNS O O
that WDT O O
are VBP O O
unlikely JJ O O
to TO O O
be VB O O
victims NNS O O
; : O O
and CC O O
they PRP O O
also RB O O
tend VBP O O
to TO O O
consist VB O O
of IN O O
short-lived JJ O O
sessions NNS O O
. . O O

Some DT O O
researchers NNS O O
set VBD O O
up RP O O
scheduled JJ O O
tasks NNS O O
to TO O O
scan VB O O
the DT O O
shares NNS O O
for IN O O
new JJ O O
updates NNS O O
and CC O O
malware NN O O
. . O O

We PRP O O
see VBP O O
a DT O O
few JJ O O
variations NNS O O
of IN O O
these DT O O
â€“ CD O O
one CD O O
typical JJ O O
configuration NN O O
is VBZ O O
where WRB O O
the DT O O
requests NNS O O
contain VBP O O
a DT O O
Python-related JJ O O
user-agent JJ O O
string NN O O
. . O O

Attackers NNPS O O
, , O O
on IN O O
the DT O O
other JJ O O
hand NN O O
, , O O
do VBP O O
n't RB O O
appear VB O O
to TO O O
use VB O O
Windows NNP O O
. . O O

Common NNP O O
across IN O O
multiple JJ O O
accounts NNS O O
, , O O
multiple JJ O O
IP NNP O O
's POS O O
, , O O
and CC O O
over IN O O
time NN O O
, , O O
is VBZ O O
that IN O O
the DT B-Entity 1
probable JJ I-Entity O
attackers NNS I-Entity O
have VBP O O
used VBN B-Action 2
a DT B-Entity 3
HTTP NN I-Entity O
user-agent NN I-Entity O
of IN I-Entity O
'' '' I-Entity O
davfs2/1.4.6 FW I-Entity O
neon/0.29.6 FW I-Entity O
'' '' I-Entity O
. . O O

We PRP O O
know VBP O O
these DT O O
are VBP O O
not RB O O
researchers NNS O O
, , O O
because IN O O
we PRP O O
can MD O O
see VB O O
malware NN O O
files NNS O O
being VBG O O
uploaded VBN O O
by IN O O
them PRP O O
: : O O
We PRP O O
have VBP O O
a DT O O
log NN O O
fragment NN O O
in IN O O
which WDT O O
the DT O O
attackers NNS O O
uploaded VBD O O
a DT O O
sequential JJ O O
series NN O O
of IN O O
updates NNS O O
( VBP O O
from IN O O
1746.bin NN O O
to TO O O
1774.bin FW O O
) FW O O
within IN O O
1.5 CD O O
hours NNS O O
on IN O O
Sept NNP O O
17th JJ O O
, , O O
spread VBN O O
over IN O O
27 CD O O
different JJ O O
accounts NNS O O
and CC O O
using VBG O O
27 CD O O
different JJ O O
IP NNP O O
addresses NNS O O
in IN O O
the DT O O
process NN O O
. . O O

The DT O O
user-agent JJ O O
string NN O O
shows VBZ O O
that IN O O
attackers NNS O O
likely RB O O
have VBP O O
used VBN O O
a DT O O
client NN O O
based VBN O O
on IN O O
the DT O O
open JJ O O
source NN O O
davfs2 NN O O
file NN O O
system NN O O
for IN O O
Linux NNP O O
to TO O O
mount VB O O
the DT O O
WebDAV NNP O O
shares NNS O O
. . O O

This DT O O
client NN O O
is VBZ O O
used VBN O O
when WRB O O
uploading VBG O O
new JJ O O
malware NN O O
, , O O
but CC O O
also RB O O
when WRB O O
the DT O O
attackers NNS O O
scan VBP O O
their PRP$ O O
shares NNS O O
for IN O O
new JJ O O
victim NN O O
updates NNS O O
, , O O
in IN O O
which WDT O O
case NN O O
the DT O O
shares NNS O O
are VBP O O
enumerated VBN O O
by IN O O
requests NNS O O
in IN O O
a DT O O
scheduled JJ O O
manner NN O O
. . O O

The DT O O
attackers NNS O O
have VBP O O
used VBN O O
a DT O O
large JJ O O
number NN O O
of IN O O
IP NNP O O
addresses NNS O O
to TO O O
access VB O O
the DT O O
shares NNS O O
. . O O

As IN O O
mentioned VBN O O
above RB O O
, , O O
there EX O O
is VBZ O O
a DT O O
rotation NN O O
scheme NN O O
in IN O O
place NN O O
in IN O O
which WDT O O
a DT O O
new JJ O O
IP NNP O O
address NN O O
will MD O O
be VB O O
used VBN O O
after IN O O
a DT O O
few JJ O O
minutes NNS O O
of IN O O
access NN O O
against IN O O
CloudMe NN O O
accounts NNS O O
. . O O

These DT O O
IP NNP O O
's POS O O
are VBP O O
distributed VBN O O
widely RB O O
over IN O O
geographical JJ O O
locations NNS O O
and CC O O
service NN O O
providers NNS O O
, , O O
with IN O O
a DT O O
heavy JJ O O
bias NN O O
towards IN O O
South JJ O O
Korean JJ O O
ranges NNS O O
. . O O

At IN O O
first RB O O
we PRP O O
thought VBD O O
these DT O O
IP NNP O O
's POS O O
belonged VBD O O
to TO O O
some DT O O
commercial JJ O O
proxy NN O O
service NN O O
, , O O
particularly RB O O
since IN O O
several JJ O O
such JJ O O
proxy NN O O
services NNS O O
also RB O O
offer VBP O O
IP NNP O O
rotation NN O O
. . O O

However RB O O
, , O O
this DT O O
turned VBD O O
out RP O O
to TO O O
be VB O O
a DT O O
wrong JJ O O
assumption NN O O
. . O O

A DT O O
superficial JJ O O
examination NN O O
of IN O O
the DT O O
proxy JJ O O
IP NNP O O
addresses NNS O O
that WDT O O
connected VBD O O
to TO O O
CloudMe NN O O
showed VBD O O
them PRP O O
to TO O O
be VB O O
internet-connected JJ O O
devices NNS O O
of IN O O
various JJ O O
kinds NNS O O
. . O O

Many JJ O O
were VBD O O
Korean NNP O O
Tera-EP NNP O O
home NN O O
routers NNS O O
; : O O
but CC O O
there EX O O
were VBD O O
several JJ O O
other JJ O O
products NNS O O
represented VBN O O
. . O O

It PRP O O
is VBZ O O
believed VBN O O
that IN O O
the DT B-Entity 1
attackers NNS I-Entity O
were VBD O O
able JJ O O
to TO O O
compromise VB B-Action 2
these DT B-Entity 3
devices NNS I-Entity O
based VBN B-Modifier 4
on IN I-Modifier O
poor JJ B-Entity 5
configurations NNS I-Entity O
or CC I-Entity O
default NN I-Entity O
credentials NNS I-Entity O
. . O O

We PRP O O
were VBD O O
able JJ O O
to TO O O
do VB O O
some DT O O
forensic JJ O O
work NN O O
on IN O O
a DT O O
compromised VBN O O
Tera-EP NN O O
TE-800 NN O O
device NN O O
and CC O O
discovered VBD O O
another DT O O
dimension NN O O
of IN O O
the DT O O
attacker NN O O
's POS O O
infrastructure NN O O
. . O O

Under IN O O
the DT O O
ramfs NNS O O
mounted VBD O O
partition NN O O
we PRP O O
found VBD O O
a DT O O
stripped VBN O O
and CC O O
statically RB O O
linked VBN O O
MIPS-el NN O O
binary JJ O O
named VBN O O
tail- NN O O
. . O O

Instances NNS O O
of IN O O
this DT O O
were VBD O O
also RB O O
found VBN O O
under IN O O
the DT O O
running VBG O O
process NN O O
list NN O O
. . O O

tail- NN B-Entity 1
serves VBZ B-Action 2
as IN B-Modifier 3
a DT B-Entity 4
SOCKS NNP I-Entity O
proxy NN I-Entity O
for IN B-Modifier 5
the DT B-Entity 6
attackers NNS I-Entity O
. . O O

Each DT O O
sample NN O O
of IN O O
the DT O O
binary JJ O O
we PRP O O
were VBD O O
able JJ O O
to TO O O
acquire VB O O
was VBD O O
configured VBN O O
with IN O O
a DT O O
unique JJ O O
32byte FW O O
blowfish FW O O
key NN O O
and CC O O
a DT O O
small JJ O O
, , O O
encrypted JJ O O
section NN O O
appended VBN O O
to TO O O
the DT O O
end NN O O
of IN O O
the DT O O
binary JJ O O
. . O O

Upon IN O O
execution NN O O
the DT B-Entity 1
binary JJ I-Entity O
uses VBZ O O
its PRP$ O O
hardcoded JJ O O
key NN O O
to TO O O
decrypt VB O O
the DT O O
configuration NN O O
section NN O O
and CC O O
retrieve VB B-Action 2
the DT B-Entity 3
listening NN I-Entity O
port NN I-Entity O
to TO B-Modifier 4
use VB B-Entity 5
for IN I-Entity O
incoming JJ I-Entity O
connections NNS I-Entity O
. . O O

This DT O O
acts VBZ O O
as IN O O
a DT O O
management NN O O
interface NN O O
. . O O

From IN O O
here RB O O
the DT O O
attackers NNS O O
can MD O O
request VB O O
a DT O O
specific JJ O O
port NN O O
to TO O O
be VB O O
opened VBN O O
as IN O O
one CD O O
of IN O O
the DT O O
following JJ O O
types NNS O O
: : O O
SOCKET NN O O
, , O O
SOCKSS NN O O
, , O O
SOCKAT NN O O
, , O O
SOCKS5 NN O O
, , O O
or CC O O
STATUSPORT NNP O O
. . O O

To TO O O
prevent VB O O
anyone NN O O
else RB O O
from IN O O
accessing VBG O O
this DT O O
service NN O O
all DT O O
communication NN O O
on IN O O
the DT O O
management NN O O
interface NN O O
is VBZ O O
encrypted VBN O O
using VBG O O
the DT O O
same JJ O O
blowfish JJ O O
key NN O O
. . O O

This DT O O
means VBZ O O
that IN O O
the DT B-Entity 1
attackers NNS I-Entity O
must MD O O
maintain VB B-Action 2
a DT B-Entity 3
list NN I-Entity O
of IN I-Entity O
where WRB I-Entity O
each DT I-Entity O
of IN I-Entity O
these DT I-Entity O
implants NNS I-Entity O
are VBP I-Entity O
installed VBN I-Entity O
, , I-Entity O
as RB I-Entity O
well RB I-Entity O
as IN I-Entity O
what WDT I-Entity O
port NN I-Entity O
and CC I-Entity O
key VB I-Entity O
each DT I-Entity O
is VBZ I-Entity O
configured VBN I-Entity O
to TO I-Entity O
use VB I-Entity O
. . O O

This DT O O
setup NN O O
makes VBZ O O
it PRP O O
difficult JJ O O
to TO O O
identify VB O O
embedded JJ O O
devices NNS O O
compromised VBN O O
with IN O O
this DT O O
malware NN O O
by IN O O
scanning VBG O O
open JJ O O
ports NNS O O
. . O O

In IN O O
the DT O O
wild JJ O O
we PRP O O
witnessed VBD O O
the DT O O
attackers NNS O O
connect VBP O O
to TO O O
the DT O O
management NN O O
port NN O O
and CC O O
request NN O O
SOCKSS NN O O
connections NNS O O
. . O O

This DT O O
would MD O O
open VB O O
the DT O O
specified VBN O O
port NN O O
and CC O O
wait VB O O
for IN O O
configuration NN O O
data NNS O O
, , O O
which WDT O O
consists VBZ O O
of IN O O
a DT O O
domain NN O O
name NN O O
( NNP O O
webdav.cloudme.com NNP O O
) NNP O O
, , O O
the DT O O
destination NN O O
port NN O O
, , O O
and CC O O
a DT O O
variable JJ O O
length NN O O
RC4 NN O O
key NN O O
, , O O
all DT O O
of IN O O
which WDT O O
encrypted VBD O O
using VBG O O
the DT O O
blowfish JJ O O
key NN O O
. . O O

Once RB O O
received VBD O O
the DT B-Entity 1
malware NN I-Entity O
would MD O O
attempt VB O O
to TO O O
connect VB B-Action 2
to TO B-Modifier 3
the DT B-Entity 4
domain NN I-Entity O
name NN I-Entity O
on IN B-Modifier 5
the DT B-Entity 6
specified VBN I-Entity O
port NN I-Entity O
and CC O O
would MD O O
start VB O O
tunneling VBG B-Action 7
all DT B-Entity 8
traffic NN I-Entity O
received VBN I-Entity O
from IN I-Entity O
the DT I-Entity O
SOCKSS NNP I-Entity O
port NN I-Entity O
to TO B-Modifier 9
the DT B-Entity 10
destination NN I-Entity O
and CC O O
vise-versa NN O O
. . O O

The DT B-Entity 1
communication NN I-Entity O
between IN I-Entity O
the DT I-Entity O
attacker NN I-Entity O
and CC I-Entity O
the DT I-Entity O
SOCKSS NNP I-Entity O
is VBZ B-Action 2
encoded VBN I-Action O
using VBG B-Modifier 3
the DT B-Entity 4
RC4 NN I-Entity O
key NN I-Entity O
. . O O

The DT O O
graphic JJ O O
below IN O O
illustrates VBZ O O
a DT O O
typical JJ O O
session NN O O
. . O O

The DT O O
router NN O O
proxy NN O O
network NN O O
provides VBZ O O
another DT O O
layer NN O O
of IN O O
indirection NN O O
masking VBG O O
the DT O O
attackers NNS O O
' POS O O
infrastructure NN O O
. . O O

However RB O O
, , O O
because IN O O
we PRP O O
captured VBD O O
traffic NN O O
through IN O O
one CD O O
of IN O O
these DT O O
embedded JJ O O
devices NNS O O
we PRP O O
could MD O O
identify VB O O
other JJ O O
parts NNS O O
of IN O O
their PRP$ O O
operation NN O O
. . O O

We PRP O O
identified VBD O O
four CD B-Entity 1
IP NNP I-Entity O
addresses NNS I-Entity O
that WDT O O
connected VBD B-Action 2
to TO B-Modifier 3
the DT B-Entity 4
proxy NN I-Entity O
malware NN I-Entity O
: : O O
This DT B-Entity 5
host NN I-Entity O
belongs VBZ O O
to TO O O
a DT O O
Bulgarian JJ O O
VPS NN O O
service NN O O
and CC O O
would MD O O
use VB B-Action 6
the DT B-Entity 7
router NN I-Entity O
proxy NN I-Entity O
to TO B-Modifier 8
connect VB B-Entity 9
to TO I-Entity O
webdav.cloudme.com NNP I-Entity O
. . O O

This DT B-Entity 1
host NN I-Entity O
does VBZ O O
all DT O O
scanning NN O O
of IN O O
webdav JJ O O
shares NNS O O
for IN O O
stolen VBN O O
user NN O O
data NNS O O
, , O O
and CC O O
also RB O O
uploads VBZ B-Action 2
new JJ B-Entity 3
malware NN I-Entity O
components NNS I-Entity O
. . O O

This NNP O O
IP NNP O O
would MD O O
make VB O O
connections NNS O O
hourly JJ O O
and CC O O
poll VB O O
the DT O O
status NN O O
of IN O O
the DT O O
router NN O O
proxy NN O O
malware NN O O
. . O O

This DT O O
machine NN O O
is VBZ O O
most RBS O O
likely RB O O
used VBN O O
to TO O O
track VB O O
which WDT O O
compromised VBD O O
routers NNS O O
are VBP O O
currently RB O O
available JJ O O
for IN O O
use NN O O
. . O O

Traffic NN O O
from IN O O
this DT O O
IP NNP O O
had VBD O O
a DT O O
very RB O O
specific JJ O O
purpose NN O O
: : O O
It PRP B-Entity 1
unlocked VBD B-Action 2
routers NNS B-Entity 3
for IN B-Modifier 4
proxying VBG B-Entity 5
in IN B-Modifier 6
connection NN I-Modifier O
with IN I-Modifier O
the DT B-Entity 7
sending VBG I-Entity O
of IN I-Entity O
phishing NN I-Entity O
emails NNS I-Entity O
. . O O

In IN O O
the DT O O
wild JJ O O
we PRP O O
observed VBD O O
this DT B-Entity 1
IP NNP I-Entity O
connect VB B-Action 2
to TO B-Modifier 3
our PRP$ B-Entity 4
router NN I-Entity O
on IN B-Modifier 5
the DT B-Entity 6
malware NN I-Entity O
management NN I-Entity O
port NN I-Entity O
and CC O O
specify VB O O
a DT O O
SOCKSS NNP O O
proxy NN O O
port NN O O
to TO O O
be VB O O
opened VBN O O
. . O O

Immediately RB O O
after RB O O
, , O O
the DT B-Entity 1
newly RB I-Entity O
opened VBN I-Entity O
port NN I-Entity O
would MD O O
be VB B-Action 2
connected VBN I-Action O
to TO B-Modifier 3
by IN O O
another DT B-Entity 4
IP NNP I-Entity O
and CC O O
used VBN O O
to TO O O
send VB B-Action 5
phishing VBG B-Entity 6
emails NNS I-Entity O
with IN I-Entity O
malicious JJ I-Entity O
attachments NNS I-Entity O
. . O O

However RB O O
, , O O
later RB O O
we PRP O O
observed VBD O O
that IN O O
the DT O O
Email VB O O
sender NN O O
IP NNP O O
at IN O O
VOLIA NNP O O
vanished VBD O O
and CC O O
the DT O O
Unlocker NNP O O
server NN O O
taking VBG O O
over RP O O
its PRP$ O O
role NN O O
as RB O O
well RB O O
. . O O

After IN O O
a DT O O
router NN O O
SOCKSS NN O O
port NN O O
was VBD O O
opened VBN O O
by IN O O
Unlocker NNP O O
, , O O
this DT B-Entity 1
IP NNP I-Entity O
would MD O O
connect VB B-Action 2
to TO B-Modifier 3
the DT B-Entity 4
opened VBN I-Entity O
port NN I-Entity O
and CC O O
tunnel NN B-Action 5
its PRP$ B-Entity 6
email NN I-Entity O
traffic NN I-Entity O
through IN B-Modifier 7
the DT B-Entity 8
router NN I-Entity O
. . O O

Each DT O O
of IN O O
these DT O O
connections NNS O O
used VBD O O
the DT O O
correct JJ O O
encryption NN O O
key NN O O
, , O O
so IN O O
we PRP O O
know VBP O O
that IN O O
these DT O O
accesses NNS O O
came VBD O O
from IN O O
the DT O O
attackers NNS O O
and CC O O
not RB O O
some DT O O
opportunistic JJ O O
third JJ O O
party NN O O
. . O O

Mail NNP O O
proxies NNS O O
: : O O
Through IN O O
our PRP$ O O
router NN O O
monitoring NN O O
we PRP O O
identified VBD O O
two CD B-Entity 1
mail NN I-Entity O
proxies NNS I-Entity O
used VBN B-Action 2
by IN O O
the DT B-Entity 3
attackers NNS I-Entity O
. . O O

We PRP O O
were VBD O O
later RB O O
notified VBN O O
by IN O O
Symantec FW O O
( FW O O
thanks NNS O O
, , O O
guys NNS O O
! . O O
) CD O O
about IN O O
a DT O O
third JJ O O
. . O O

These DT O O
servers NNS O O
were VBD O O
hosted VBN O O
on IN O O
domains NNS O O
that WDT O O
were VBD O O
registered VBN O O
by IN O O
the DT O O
attackers NNS O O
, , O O
using VBG O O
domain NN O O
names NNS O O
clearly RB O O
meant VBD O O
to TO O O
look VB O O
legitimate JJ O O
. . O O

This DT O O
is VBZ O O
the DT O O
only JJ O O
time NN O O
we PRP O O
have VBP O O
seen VBN O O
attackers NNS O O
register VBP O O
domains NNS O O
in IN O O
this DT O O
investigation NN O O
. . O O

The DT O O
mail NN O O
proxies NNS O O
were VBD O O
: : O O
Registrant NNP O O
WHOIS NNP O O
information NN O O
seems VBZ O O
forged VBN O O
: : O O
The DT O O
connections NNS O O
made VBN O O
from IN O O
the DT O O
Ukrainian JJ O O
host NN O O
to TO O O
the DT O O
router NN O O
were VBD O O
interesting JJ O O
. . O O

After IN O O
being VBG O O
proxied VBN O O
though IN O O
the DT O O
router NN O O
, , O O
each DT B-Entity 1
of IN I-Entity O
these DT I-Entity O
would MD O O
authenticate VB O O
with IN O O
one CD O O
of IN O O
the DT O O
dedicated JJ O O
mail NN O O
proxies NNS O O
and CC O O
send VB B-Action 2
out RP B-Modifier 3
phishing NN B-Entity 4
attacks NNS I-Entity O
. . O O

From IN O O
captured VBN O O
traffic NN O O
it PRP O O
appears VBZ O O
that IN O O
the DT O O
mail NN O O
proxies NNS O O
have VBP O O
SOCKSv5 NN O O
services NNS O O
running VBG O O
on IN O O
obscure JJ O O
high JJ O O
ports NNS O O
. . O O

We PRP O O
have VBP O O
documented VBN O O
that IN O O
the DT O O
attackers NNS O O
log VBP O O
in RP O O
to TO O O
these DT O O
using VBG O O
apparently RB O O
randomly RB O O
generated VBN O O
usernames NNS O O
and CC O O
passwords NNS O O
, , O O
a DT O O
unique JJ O O
pair NN O O
for IN O O
each DT O O
server NN O O
. . O O

The DT B-Entity 1
mail NN I-Entity O
proxy NN I-Entity O
would MD O O
then RB O O
relay VB B-Action 2
the DT B-Entity 3
spearphishing NN I-Entity O
mail NN I-Entity O
as IN B-Modifier 4
seen VBN B-Entity 5
below IN I-Entity O
. . O O

This DT O O
way NN O O
the DT B-Entity 1
attack NN I-Entity O
can MD O O
be VB B-Action 2
mistaken VBN I-Action O
to TO B-Modifier 3
come VB B-Entity 4
from IN I-Entity O
legitimate JJ I-Entity O
businesses NNS I-Entity O
and CC I-Entity O
trusted VBN I-Entity O
organizations NNS I-Entity O
. . O O

In IN O O
some DT O O
cases NNS O O
the DT B-Entity 1
organization NN I-Entity O
from IN I-Entity O
which WDT I-Entity O
the DT I-Entity O
phishing NN I-Entity O
email NN I-Entity O
originates VBZ I-Entity O
would MD O O
appear VB B-Action 2
to TO B-Modifier 3
be VB B-Entity 4
a DT I-Entity O
known JJ I-Entity O
associate NN I-Entity O
to TO I-Entity O
the DT I-Entity O
target NN I-Entity O
. . O O

The DT O O
email NN O O
shown VBN O O
above IN O O
was VBD O O
one CD O O
of IN O O
a DT B-Entity 1
number NN I-Entity O
of IN I-Entity O
messages NNS I-Entity O
sent VBN B-Action 2
to TO B-Modifier 3
targets NNS B-Entity 4
in IN I-Entity O
the DT I-Entity O
oil NN I-Entity O
industry NN I-Entity O
. . O O

Investigating VBG O O
the DT O O
target NN O O
email NN O O
addresses NNS O O
, , O O
we PRP O O
saw VBD O O
several JJ O O
of IN O O
these DT O O
were VBD O O
found VBN O O
in IN O O
this DT O O
public JJ O O
document NN O O
from IN O O
the DT O O
World NNP O O
Petroleum NNP O O
Council NNP O O
, , O O
including VBG O O
some DT O O
addresses NNS O O
that WDT O O
are VBP O O
, , O O
at IN O O
the DT O O
present JJ O O
time NN O O
, , O O
no RB O O
longer RB O O
valid JJ O O
. . O O

And CC O O
then RB O O
, , O O
the DT O O
ground NN O O
shifted VBD O O
again RB O O
. . O O

One CD B-Entity 1
of IN I-Entity O
the DT I-Entity O
spearphishing NN I-Entity O
mails VBZ I-Entity O
we PRP O O
observed VBD O O
coming VBG B-Action 2
through IN B-Modifier 3
the DT B-Entity 4
router NN I-Entity O
network NN I-Entity O
was VBD O O
this DT O O
one CD O O
, , O O
sent VBN B-Action 5
to TO B-Modifier 6
an DT B-Entity 7
address NN I-Entity O
under IN I-Entity O
the DT I-Entity O
gov.py FW I-Entity O
( FW I-Entity O
Government NN I-Entity O
of IN I-Entity O
Paraguay FW I-Entity O
) FW I-Entity O
domain NN I-Entity O
. . O O

There EX O O
was VBD O O
no DT O O
executable JJ O O
attachment NN O O
in IN O O
this DT O O
mail NN O O
, , O O
but CC O O
instead RB O O
a DT O O
link NN O O
shortened VBN O O
by IN O O
the DT O O
URL NN O O
shortener NN O O
service NN O O
bit.ly NN O O
, , O O
with IN O O
the DT O O
underlying VBG O O
link NN O O
pointing VBG O O
to TO O O
an DT O O
IP NNP O O
address NN O O
on IN O O
a DT O O
Dutch JJ O O
hosting VBG O O
service NN O O
. . O O

Clicking VBG O O
that DT O O
link NN O O
from IN O O
a DT O O
Windows NNP O O
PC NNP O O
only RB O O
yielded VBD O O
a DT O O
redirection NN O O
to TO O O
the DT O O
BBC NNP O O
homepages NNS O O
, , O O
and CC O O
using VBG O O
other JJ O O
devices NNS O O
did VBD O O
not RB O O
give VB O O
more JJR O O
data NNS O O
. . O O

The DT O O
bit.ly JJ O O
service NN O O
does VBZ O O
however RB O O
provide VB O O
information NN O O
on IN O O
the DT O O
user NN O O
creating VBG O O
the DT O O
shortened VBN O O
link NN O O
, , O O
and CC O O
other JJ O O
links NNS O O
associated VBN O O
with IN O O
this DT O O
account NN O O
. . O O

In IN O O
this DT O O
case NN O O
, , O O
the DT O O
user NN O O
was VBD O O
named VBN O O
nicolatesla53 NN O O
. . O O

The DT O O
nicolatesla53 NN O O
account NN O O
was VBD O O
created VBN O O
in IN O O
July NNP O O
2014 CD O O
. . O O

From IN O O
Oct NN O O
24th JJ O O
to TO O O
Nov NNP O O
21st CD O O
this DT O O
user NN O O
created VBD O O
nearly RB O O
10000 CD O O
shortened VBD O O
links NN O O
â€“ NN O O
we PRP O O
harvested VBD O O
9990 CD O O
unique JJ O O
ones NNS O O
. . O O

Three NNP O O
IP NNP O O
addresses NNS O O
were VBD O O
used VBN O O
for IN O O
these DT O O
links NNS O O
: : O O
The DT O O
links NNS O O
themselves PRP O O
were VBD O O
on IN O O
this DT O O
format NN O O
: : O O
As RB O O
far RB O O
as IN O O
we PRP O O
were VBD O O
able JJ O O
to TO O O
tell VB O O
, , O O
there EX O O
were VBD O O
three CD O O
main JJ O O
types NNS O O
of IN O O
actioncode NN O O
: : O O
We PRP O O
have VBP O O
no DT O O
sample NN O O
of IN O O
the DT O O
actual JJ O O
MMS NNP O O
phishing NN O O
messages NNS O O
apparently RB O O
being VBG O O
sent VBN O O
, , O O
but CC O O
we PRP O O
can MD O O
see VB O O
the DT O O
page NN O O
served VBD O O
when WRB O O
a DT O O
user NN O O
clicks VBZ O O
a DT O O
spammed JJ O O
link NN O O
. . O O

This DT O O
is VBZ O O
just RB O O
a DT O O
dialogue NN O O
box NN O O
asking VBG O O
for IN O O
the DT O O
password NN O O
presumably RB O O
included VBN O O
in IN O O
the DT O O
initial JJ O O
message NN O O
, , O O
and CC O O
the DT O O
next JJ O O
stage NN O O
likely RB O O
involves VBZ O O
download NN O O
of IN O O
malicious JJ O O
content NN O O
. . O O

We PRP O O
were VBD O O
in IN O O
the DT O O
middle NN O O
of IN O O
harvesting VBG O O
the DT O O
servers NNS O O
for IN O O
data NNS O O
on IN O O
the DT O O
various JJ O O
action NN O O
codes NNS O O
when WRB O O
they PRP O O
all DT O O
were VBD O O
abruptly RB O O
taken VBN O O
offline NN O O
; : O O
so IN O O
our PRP$ O O
data NNS O O
on IN O O
which WDT O O
mobile JJ O O
operators NNS O O
are VBP O O
targeted VBN O O
is VBZ O O
not RB O O
complete JJ O O
. . O O

We PRP O O
managed VBD O O
to TO O O
get VB O O
66 CD O O
of IN O O
a DT O O
total NN O O
of IN O O
190 CD O O
. . O O

The DT O O
ones NNS O O
we PRP O O
know VBP O O
of IN O O
are VBP O O
shown VBN O O
below IN O O
. . O O

A DT O O
full JJ O O
breakdown NN O O
of IN O O
mobile JJ O O
operators NNS O O
and CC O O
related JJ O O
links NNS O O
is VBZ O O
included VBN O O
in IN O O
the DT O O
appendix NN O O
. . O O

The DT O O
composition NN O O
of IN O O
links NNS O O
created VBN O O
for IN O O
the DT O O
various JJ O O
mobile JJ O O
operators NNS O O
is VBZ O O
quite RB O O
interesting JJ O O
, , O O
as IN O O
one PRP O O
can MD O O
speculate VB O O
that IN O O
they PRP O O
represent VBP O O
amount NN O O
of IN O O
actual JJ O O
or CC O O
planned JJ O O
attacks NNS O O
in IN O O
different JJ O O
countries NNS O O
. . O O

With IN O O
the DT O O
top JJ O O
three CD O O
operators NNS O O
being VBG O O
Vodafone NNP O O
, , O O
T- NN O O
Mobile NNP O O
and CC O O
Proximus NNP O O
( NNP O O
Belgacom NNP O O
) NNP O O
it PRP O O
seems VBZ O O
these DT O O
apparent JJ O O
phishing NN O O
attacks NNS O O
are VBP O O
less RBR O O
focused VBN O O
on IN O O
the DT O O
Russian JJ O O
sphere NN O O
than IN O O
the DT O O
previously RB O O
discussed VBN O O
malware NN O O
. . O O

This DT O O
map NN O O
is VBZ O O
not RB O O
complete JJ O O
, , O O
though RB O O
. . O O

It PRP O O
represents VBZ O O
only RB O O
about RB O O
35 CD O O
% NN O O
( FW O O
66/190 FW O O
) NN O O
of IN O O
all DT O O
mobile JJ O O
operators NNS O O
targeted VBN O O
and CC O O
66 CD O O
% NN O O
( CD O O
3152/4781 CD O O
) NN O O
of IN O O
all DT O O
phishing VBG O O
links NNS O O
we PRP O O
managed VBD O O
to TO O O
harvest VB O O
. . O O

In IN O O
addition NN O O
, , O O
some DT O O
operators NNS O O
like IN O O
Vodafone NNP O O
are VBP O O
global JJ O O
actors NNS O O
, , O O
so IN O O
the DT O O
map NN O O
might MD O O
show VB O O
an DT O O
unfair JJ O O
intensity NN O O
in IN O O
their PRP$ O O
HQ NNP O O
locations NNS O O
. . O O

The DT O O
rest NN O O
of IN O O
the DT O O
bit.ly NN O O
links NNS O O
used VBD O O
the DT O O
action NN O O
codes NNS O O
743 CD O O
or CC O O
1024 CD O O
. . O O

And CC O O
now RB O O
things NNS O O
really RB O O
get VBP O O
interesting JJ O O
. . O O

By IN O O
using VBG O O
mobile JJ O O
device NN O O
HTTP NNP O O
User-Agents NNP O O
we PRP O O
were VBD O O
able JJ O O
to TO O O
trigger VB O O
downloads NNS O O
of IN O O
malware NN O O
components NNS O O
from IN O O
some DT O O
of IN O O
these DT O O
links NNS O O
. . O O

Accessing VBG B-Entity 1
the DT I-Entity O
link NN I-Entity O
from IN I-Entity O
an DT I-Entity O
Android NNP I-Entity O
User-Agent NNP I-Entity O
initiated VBD B-Action 2
a DT B-Entity 3
download NN I-Entity O
of IN I-Entity O
an DT I-Entity O
Android JJ I-Entity O
installer NN I-Entity O
package NN I-Entity O
named VBN I-Entity O
WhatsAppUpdate.apk NN I-Entity O
. . O O

The DT O O
package NN O O
we PRP O O
analyzed VBD O O
was VBD O O
1.2MB NN O O
in IN O O
size NN O O
. . O O

The DT O O
apparent JJ O O
main JJ O O
purpose NN O O
of IN O O
this DT B-Entity 1
malware NN I-Entity O
is VBZ O O
to TO O O
record VB B-Action 2
phone NN B-Entity 3
call NN I-Entity O
audio NN I-Entity O
. . O O

Recordings NNS B-Entity 1
are VBP B-Action 2
stored VBN I-Action O
as IN B-Modifier 3
*.mp4 NN B-Entity 4
files NNS I-Entity O
, , O O
and CC O O
uploaded VBD B-Action 5
to TO B-Modifier 6
the DT B-Entity 7
attackers NNS I-Entity O
periodically RB B-Entity 8
. . O O

The DT B-Entity 1
malware NN I-Entity O
is VBZ O O
able JJ O O
to TO O O
collect VB B-Action 2
a DT B-Entity 3
lot NN I-Entity O
of IN I-Entity O
other JJ I-Entity O
information NN I-Entity O
, , O O
not RB O O
all DT O O
of IN O O
which WDT O O
is VBZ O O
actually RB O O
used VBN O O
: : O O
Through IN B-Modifier 4
the DT B-Entity 5
encrypted JJ I-Entity O
C NN I-Entity O
& CC I-Entity O
C NN I-Entity O
protocol NN I-Entity O
, , O O
the DT B-Entity 6
attackers NNS I-Entity O
can MD O O
issue VB B-Action 7
commands NNS B-Entity 8
and CC I-Entity O
binary JJ I-Entity O
updates NNS I-Entity O
to TO B-Modifier 9
the DT B-Entity 10
malware NN I-Entity O
. . O O

It PRP O O
uses VBZ O O
a DT O O
custom NN O O
DAO/Database NN O O
scheme NN O O
which WDT O O
uses VBZ O O
accounts NNS O O
belonging VBG O O
to TO O O
the DT O O
virtual JJ O O
community NN O O
Live NNP O O
Journal NNP O O
( NNP O O
livejournal.com NNP O O
) NNP O O
as IN O O
data NNS O O
stores NNS O O
. . O O

Three CD O O
such JJ O O
accounts NNS O O
were VBD O O
found VBN O O
hardcoded JJ O O
in IN O O
the DT O O
package NN O O
: : O O
The DT O O
accounts NNS O O
all DT O O
state NN O O
that IN O O
they PRP O O
belong VBP O O
to TO O O
Iranian JJ O O
users NNS O O
. . O O

This DT O O
is VBZ O O
very RB O O
likely RB O O
false JJ O O
. . O O

The DT O O
text NN O O
in IN O O
these DT O O
posts NNS O O
starts VBZ O O
first JJ O O
out IN O O
in FW O O
cleartext FW O O
, , O O
but CC O O
quickly RB O O
turns VBZ O O
into IN O O
unreadable JJ O O
gibberish NN O O
. . O O

The DT O O
HTML NNP O O
source NN O O
code NN O O
reveals VBZ O O
that IN O O
the DT O O
encoded VBN O O
portion NN O O
is VBZ O O
encapsulated VBN O O
in IN O O
blog-index JJ O O
tags NNS O O
: : O O
The DT O O
three CD O O
accounts NNS O O
contain VBP O O
different JJ B-Entity 1
configuration NN I-Entity O
blocks NNS I-Entity O
pointing VBG B-Action 2
to TO B-Modifier 3
C NN B-Entity 4
& CC I-Entity O
C NN I-Entity O
servers NNS I-Entity O
apparently RB I-Entity O
located JJ I-Entity O
in IN I-Entity O
Poland NNP I-Entity O
, , I-Entity O
Germany NNP I-Entity O
and CC I-Entity O
Russia NNP I-Entity O
, , I-Entity O
respectively RB I-Entity O
. . O O

Based VBN O O
on IN O O
registration NN O O
data NNS O O
and CC O O
folder NN O O
configuration NN O O
we PRP O O
believe VBP O O
these DT O O
are VBP O O
legitimate JJ O O
but CC O O
compromised VBD O O
Joomla NNP O O
servers NNS O O
. . O O

And CC O O
then RB O O
an DT O O
unexpected JJ O O
oddity NN O O
shows VBZ O O
up RP O O
in IN O O
the DT O O
Java NNP O O
source NN O O
: : O O
We PRP O O
were VBD O O
also RB O O
able JJ O O
to TO O O
download VB O O
a DT O O
similar JJ O O
malware NN O O
sample NN O O
( FW O O
BrowserUpdate.apk FW O O
) FW O O
from IN O O
one CD O O
of IN O O
the DT O O
C NN O O
& CC O O
C NN O O
servers NNS O O
. . O O

This DT O O
sample NN O O
used VBD O O
different JJ O O
online JJ O O
accounts NNS O O
for IN O O
its PRP$ O O
DAO/database NN O O
functionality NN O O
, , O O
but CC O O
is VBZ O O
otherwise RB O O
quite RB O O
similar JJ O O
to TO O O
the DT O O
first JJ O O
. . O O

Using VBG B-Entity 1
an DT I-Entity O
IOS NNP I-Entity O
User-Agent NNP I-Entity O
triggered VBD B-Action 2
the DT B-Entity 3
download NN I-Entity O
of IN I-Entity O
a DT I-Entity O
Debian JJ I-Entity O
installer NN I-Entity O
package NN I-Entity O
, , I-Entity O
WhatsAppUpdate.deb NN I-Entity O
, , O O
also RB O O
1.2Mb NN O O
in IN O O
size NN O O
. . O O

This DT B-Entity 1
application NN I-Entity O
impersonates VBZ B-Action 2
a DT B-Entity 3
Cydia NNP I-Entity O
installer NN I-Entity O
, , O O
and CC O O
can MD O O
only RB O O
be VB O O
installed VBN O O
on IN O O
a DT O O
jailbroken NN O O
phone NN O O
. . O O

Once RB O O
installed VBN O O
, , O O
it PRP B-Entity 1
may MD O O
collect VB B-Action 2
These DT B-Entity 3
data NNS I-Entity O
are VBP B-Action 4
encrypted VBN I-Action O
and CC O O
uploaded VBN B-Action 5
to TO B-Modifier 6
an DT B-Entity 7
FTP NN I-Entity O
account NN I-Entity O
which WDT O O
is VBZ O O
taken VBN O O
from IN O O
an DT O O
encrypted JJ O O
configuration NN O O
file NN O O
named VBN O O
/usr/bin/cores NNS O O
. . O O

In IN O O
this DT O O
particular JJ O O
case NN O O
, , O O
the DT O O
FTP NN O O
account NN O O
is VBZ O O
located JJ O O
on IN O O
a DT O O
legitimate JJ O O
( NN O O
if IN O O
struggling VBG O O
) NN O O
hosting VBG O O
service NN O O
in IN O O
the DT O O
UK NNP O O
. . O O

In IN O O
this DT O O
case NN O O
, , O O
there EX O O
's VBZ O O
another DT O O
clue NN O O
: : O O
The DT O O
WhatsAppUpdate NNP O O
project NN O O
seems VBZ O O
derived VBN O O
from IN O O
an DT O O
earlier JJR O O
template NN O O
named VBN O O
SkypeUpdate NNP O O
. . O O

By IN O O
now RB O O
, , O O
it PRP O O
came VBD O O
as IN O O
no DT O O
surprise NN O O
when WRB O O
we PRP O O
triggered VBD O O
a DT O O
download NN O O
with IN O O
a DT O O
BlackBerry NNP O O
User-Agent NNP O O
. . O O

The DT O O
initial JJ O O
download NN O O
was VBD O O
a DT O O
Java NNP O O
Applications NNS O O
Descriptor NNP O O
, , O O
a DT O O
text NN O O
file NN O O
designed VBN O O
for IN O O
Over-The-Air NNP O O
installation NN O O
of IN O O
Java-based JJ O O
applications NNS O O
. . O O

This DT O O
JAD NNP O O
file NN O O
contained VBD O O
the DT O O
locations NNS O O
of IN O O
the DT O O
two CD O O
Blackberry NNP O O
*.COD NNP O O
binaries NNS O O
which WDT O O
we PRP O O
then RB O O
could MD O O
download VB O O
directly RB O O
. . O O

The DT B-Entity 1
application NN I-Entity O
impersonates VBZ B-Action 2
a DT B-Entity 3
settings NNS I-Entity O
utility NN I-Entity O
. . O O

This DT B-Entity 1
collects VBZ B-Action 2
: : O O
Collected VBN B-Entity 3
data NNS I-Entity O
will MD O O
be VB B-Action 4
uploaded VBN I-Action O
to TO B-Modifier 5
a DT B-Entity 6
DynDNS NN I-Entity O
domain NN I-Entity O
currently RB I-Entity O
hosted VBN I-Entity O
on IN I-Entity O
a DT I-Entity O
US NNP I-Entity O
webhosting NN I-Entity O
service NN I-Entity O
. . O O

Since IN O O
these DT O O
COD NNP O O
files NNS O O
are VBP O O
also RB O O
compiled VBN O O
Java NNP O O
code NN O O
, , O O
they PRP O O
are VBP O O
possible JJ O O
to TO O O
decompile VB O O
to TO O O
original JJ O O
source NN O O
code NN O O
. . O O

In IN O O
a DT O O
similar JJ O O
fashion NN O O
to TO O O
the DT O O
Android NNP O O
version NN O O
, , O O
we PRP O O
find VBP O O
interesting JJ O O
strings NNS O O
there RB O O
. . O O

This DT O O
time NN O O
they PRP O O
are VBP O O
in IN O O
Arabic NNP O O
: : O O
The DT O O
earliest JJS O O
sample NN O O
of IN O O
Inception-related JJ O O
malware NN O O
we PRP O O
have VBP O O
been VBN O O
able JJ O O
to TO O O
obtain VB O O
, , O O
was VBD O O
submitted VBN O O
to TO O O
us PRP O O
in IN O O
June NNP O O
2014 CD O O
. . O O

However RB O O
, , O O
decoy NN O O
document NN O O
metadata NN O O
shows VBZ O O
that IN O O
it PRP O O
was VBD O O
created VBN O O
late JJ O O
May NNP O O
. . O O

The DT O O
related JJ O O
cloud NN O O
account NN O O
was VBD O O
created VBN O O
just RB O O
before IN O O
that DT O O
. . O O

An DT O O
examination NN O O
of IN O O
the DT O O
other JJ O O
documents NNS O O
associated VBN O O
with IN O O
the DT O O
attacks NNS O O
show VBP O O
that IN O O
they PRP O O
have VBP O O
been VBN O O
created VBN O O
at IN O O
a DT O O
steady JJ O O
pace NN O O
all DT O O
through IN O O
summer NN O O
and CC O O
autumn NN O O
2014 CD O O
and CC O O
attacks NNS O O
are VBP O O
still RB O O
ongoing JJ O O
. . O O

Of IN O O
interest NN O O
is VBZ O O
also RB O O
the DT O O
attackers NNS O O
' POS O O
activity NN O O
patterns NNS O O
over IN O O
the DT O O
24h JJ O O
cycle NN O O
. . O O

The DT O O
main JJ O O
upload NN O O
of IN O O
new JJ O O
components NNS O O
to TO O O
shares NNS O O
seems VBZ O O
to TO O O
be VB O O
divided VBN O O
over IN O O
two CD O O
highâ€“activity NN O O
periods NNS O O
: : O O
6:00 CD O O
-10:00 CD O O
UTC NNP O O
and CC O O
17:00 CD O O
- : O O
21:00 CD O O
UTC NNP O O
. . O O

No DT O O
uploads NNS O O
were VBD O O
seen VBN O O
between IN O O
23:00 CD O O
and CC O O
05:00 CD O O
UTC NNP O O
. . O O

It PRP O O
is VBZ O O
however RB O O
doubtful JJ O O
how WRB O O
indicative JJ O O
these DT O O
timeframes NNS O O
are VBP O O
. . O O

To TO O O
illustrate VB O O
, , O O
we PRP O O
looked VBD O O
into IN O O
another DT O O
and CC O O
more RBR O O
obscure JJ O O
timing NN O O
factor NN O O
: : O O
The DT O O
timing NN O O
of IN O O
the DT O O
AES NN O O
InitVector NN O O
random JJ O O
seeds NNS O O
. . O O

A DT O O
random JJ O O
seed NN O O
is VBZ O O
the DT O O
initial JJ O O
value NN O O
passed VBD O O
into IN O O
a DT O O
pseudo-randomizer JJ O O
function NN O O
. . O O

The DT O O
malware NN O O
uses VBZ O O
the DT O O
random JJ O O
output NN O O
to TO O O
create VB O O
what WP O O
is VBZ O O
known VBN O O
as IN O O
an DT O O
InitVector NNP O O
- : O O
a DT O O
starting VBG O O
point NN O O
for IN O O
the DT O O
AES NN O O
encryption/decryption NN O O
function NN O O
. . O O

The DT O O
code NN O O
used VBN O O
in IN O O
some DT O O
of IN O O
the DT O O
DLLs NNS O O
indicate VBP O O
that IN O O
the DT O O
attackers NNS O O
tend VBP O O
to TO O O
use VB O O
the DT O O
C NN O O
time NN O O
( FW O O
) FW O O
function NN O O
to TO O O
generate VB O O
random JJ O O
seeds NNS O O
. . O O

This DT O O
function NN O O
returns VBZ O O
values NNS O O
of IN O O
granularity NN O O
down IN O O
to TO O O
seconds NNS O O
. . O O

Thus RB O O
random JJ O O
seeds NNS O O
, , O O
and CC O O
ultimately RB O O
the DT O O
InitVectors NNP O O
, , O O
are VBP O O
functions NNS O O
of IN O O
these DT O O
quite RB O O
coarse JJ O O
units NNS O O
of IN O O
time NN O O
. . O O

The DT B-Entity 1
encrypted JJ I-Entity O
files NNS I-Entity O
uploaded VBD B-Action 2
to TO B-Modifier 3
the DT B-Entity 4
WebDAV JJ I-Entity O
shares NNS I-Entity O
come VBP O O
with IN O O
their PRP$ O O
InitVectors NNS O O
stored VBN O O
at IN O O
the DT O O
end NN O O
of IN O O
the DT O O
file NN O O
. . O O

Since IN O O
we PRP O O
know VBP O O
the DT O O
time NN O O
window NN O O
to TO O O
be VB O O
within IN O O
a DT O O
few JJ O O
days NNS O O
of IN O O
the DT O O
upload NN O O
time NN O O
we PRP O O
were VBD O O
able JJ O O
to TO O O
brute JJ O O
force NN O O
the DT O O
time NN O O
values NNS O O
that WDT O O
would MD O O
generate VB O O
the DT O O
corresponding JJ O O
InitVectors NNP O O
. . O O

Thus RB O O
, , O O
we PRP O O
were VBD O O
able JJ O O
to TO O O
say VB O O
to TO O O
the DT O O
second JJ O O
when WRB O O
the DT O O
file NN O O
was VBD O O
created VBN O O
â€“ NN O O
and CC O O
most JJS O O
times NNS O O
were VBD O O
identified VBN O O
to TO O O
be VB O O
in IN O O
the DT O O
range NN O O
1500 CD O O
- : O O
2200 CD O O
GMT NNP O O
. . O O

Unfortunately RB O O
, , O O
we PRP O O
had VBD O O
to TO O O
reject VB O O
these DT O O
data NNS O O
. . O O

The DT O O
file NN O O
creation NN O O
times NNS O O
turned VBD O O
out RP O O
to TO O O
be VB O O
hours NNS O O
after IN O O
the DT B-Entity 1
files NNS I-Entity O
themselves PRP I-Entity O
were VBD B-Action 2
uploaded VBN I-Action O
to TO B-Modifier 3
the DT B-Entity 4
WebDAV NN I-Entity O
share NN I-Entity O
. . O O

Either NNP O O
the DT O O
attackers NNS O O
' POS O O
system NN O O
clock NN O O
is VBZ O O
wrong JJ O O
or CC O O
a DT O O
fixed VBN O O
offset VBN O O
is VBZ O O
added VBN O O
to TO O O
the DT O O
random JJ O O
seed NN O O
. . O O

Either NNP O O
way NN O O
, , O O
the DT O O
data NNS O O
ca MD O O
n't RB O O
be VB O O
trusted VBN O O
; : O O
and CC O O
shows VBZ O O
that IN O O
nothing NN O O
can MD O O
be VB O O
taken VBN O O
at IN O O
face NN O O
value NN O O
. . O O

On IN O O
at IN O O
least JJS O O
two CD O O
occasions NNS O O
during IN O O
our PRP$ O O
surveillance NN O O
of IN O O
the DT O O
Inception NNP O O
framework NN O O
, , O O
the DT B-Entity 1
malware NN I-Entity O
downloaded VBD B-Action 2
something NN B-Entity 3
unexpected JJ I-Entity O
and CC I-Entity O
wholly RB I-Entity O
different JJ I-Entity O
from IN I-Entity O
what WP I-Entity O
we PRP I-Entity O
have VBP I-Entity O
discussed VBN I-Entity O
until IN I-Entity O
now RB I-Entity O
. . O O

These DT B-Entity 1
files NNS I-Entity O
were VBD B-Action 2
downloaded VBN I-Action O
as IN B-Modifier 3
encrypted JJ B-Entity 4
*.bin NN I-Entity O
files NNS I-Entity O
from IN B-Modifier 5
the DT B-Entity 6
accounts NNS I-Entity O
carter0648 NN I-Entity O
and CC I-Entity O
frogs6352 NN I-Entity O
. . O O

When WRB O O
decrypted VBN O O
, , O O
these DT O O
turned VBD O O
out RP O O
to TO O O
be VB O O
dropper NN B-Entity 1
packages NNS I-Entity O
containing VBG B-Action 2
one CD B-Entity 3
dropper NN I-Entity O
executable JJ I-Entity O
clearly RB I-Entity O
created VBN I-Entity O
for IN I-Entity O
the DT I-Entity O
Inception NNP I-Entity O
framework NN I-Entity O
, , I-Entity O
and CC I-Entity O
one CD I-Entity O
other JJ I-Entity O
, , I-Entity O
very RB I-Entity O
different JJ I-Entity O
executable JJ I-Entity O
. . O O

This DT O O
executable JJ O O
, , O O
( NNP O O
sccm.exe NNP O O
, , O O
md5 NNP O O
dd8790455109497d49c2fa2442cf16f7 NNP O O
) NNP O O
is VBZ O O
a DT O O
classical JJ O O
Chinese JJ O O
APT NN O O
implant VB O O
. . O O

It PRP B-Entity 1
is VBZ B-Action 2
a DT B-Entity 3
downloader NN I-Entity O
and CC O O
remote JJ B-Entity 4
shell NN I-Entity O
program NN I-Entity O
, , O O
designed VBN O O
to TO O O
connect VB B-Action 5
to TO B-Modifier 6
a DT B-Entity 7
C NN I-Entity O
& CC I-Entity O
C NN I-Entity O
server NN I-Entity O
to TO B-Modifier 8
interact VB B-Entity 9
with IN I-Entity O
the DT I-Entity O
attacker NN I-Entity O
and/or CC O O
download VB B-Action 10
more JJR B-Entity 11
malware NN I-Entity O
. . O O

The DT B-Entity 1
C NN I-Entity O
& CC I-Entity O
C NN I-Entity O
server NN I-Entity O
in IN O O
this DT O O
case NN O O
is VBZ B-Action 2
ict32.msname.org NNP B-Entity 3
. . O O

When WRB O O
connecting VBG B-Action 1
to TO B-Modifier 2
this DT B-Entity 3
server NN I-Entity O
, , O O
sccm.exe NN B-Entity 4
issues NNS O O
the DT O O
following JJ O O
request NN O O
: : O O
This DT B-Entity 5
C NN I-Entity O
& CC I-Entity O
C NN I-Entity O
domain NN I-Entity O
is VBZ B-Action 6
used VBN I-Action O
by IN O O
many JJ B-Entity 7
other JJ I-Entity O
malwares NNS I-Entity O
related VBN I-Entity O
to TO I-Entity O
sccm.exe NN I-Entity O
; : O O
some DT O O
of IN O O
which WDT O O
share VBP O O
obvious JJ O O
connections NNS O O
to TO O O
the DT O O
Quarian JJ O O
malware NN O O
family NN O O
, , O O
a DT O O
known JJ O O
APT NNP O O
intrusion NN O O
tool NN O O
. . O O

This DT O O
development NN O O
was VBD O O
unexpected JJ O O
for IN O O
several JJ O O
reasons NNS O O
. . O O

First NNP O O
of IN O O
all DT O O
, , O O
it PRP O O
apparently RB O O
breaks VBZ O O
the DT O O
strict JJ O O
, , O O
obfuscatory JJ O O
operational JJ O O
security NN O O
built VBN O O
into IN O O
the DT O O
Inception NNP O O
framework NN O O
. . O O

Inception NNP B-Entity 1
has VBZ O O
the DT O O
capacity NN O O
to TO O O
perform VB O O
all DT O O
steps NNS O O
needed VBN O O
for IN O O
scouting VBG B-Action 2
out RP B-Modifier 3
and CC O O
exfiltrating VBG B-Action 4
data NNS B-Entity 5
without IN O O
resorting VBG O O
to TO O O
traditional JJ O O
hosted VBN O O
command NN O O
& CC O O
control NN O O
. . O O

By IN O O
using VBG B-Action 1
a DT O O
well-understood JJ O O
APT NN O O
tool NN O O
and CC O O
a DT B-Entity 2
known JJ I-Entity O
malicious JJ I-Entity O
C NN I-Entity O
& CC I-Entity O
C NN I-Entity O
domain NN I-Entity O
name NN I-Entity O
, , O O
the DT B-Entity 3
attackers NNS I-Entity O
permit VBP O O
much RB O O
clearer JJR O O
attribution NN O O
. . O O

Another DT O O
factor NN O O
which WDT O O
is VBZ O O
out IN O O
of IN O O
character NN O O
is VBZ O O
the DT O O
coding VBG O O
style NN O O
. . O O

All DT O O
Inception-related JJ O O
malware NN O O
is VBZ O O
written VBN O O
using VBG O O
Visual JJ O O
Studio NN O O
2010 CD O O
. . O O

The DT O O
downloaded VBN O O
sccm.exe NN O O
is VBZ O O
written VBN O O
using VBG O O
Visual NNP O O
C++ NNP O O
6 CD O O
; : O O
and CC O O
has VBZ O O
a DT O O
PE NN O O
header NN O O
compile VBP O O
date NN O O
of IN O O
October NNP O O
2010 CD O O
. . O O

This DT O O
date NN O O
can MD O O
be VB O O
forged VBN O O
, , O O
and CC O O
indeed RB O O
, , O O
all DT O O
Inception-related JJ O O
malware NN O O
has VBZ O O
some DT O O
level NN O O
of IN O O
forgery NN O O
in IN O O
the DT O O
compile VBP O O
dates NNS O O
. . O O

However RB O O
, , O O
the DT O O
sccm.exe NN O O
compile VBP O O
date NN O O
matches VBZ O O
the DT O O
Quarian JJ O O
developer NN O O
toolset NN O O
and CC O O
coding VBG O O
style NN O O
to TO O O
a DT O O
better JJR O O
degree NN O O
than IN O O
the DT O O
other JJ O O
files NNS O O
distributed VBN O O
through IN O O
Inception NNP O O
. . O O

Then RB O O
there EX O O
is VBZ O O
the DT B-Entity 1
C NN I-Entity O
& CC I-Entity O
C NN I-Entity O
domain NN I-Entity O
used VBN B-Action 2
. . O O

According VBG O O
to TO O O
DomainTools.com VB O O
the DT O O
msname.org NN O O
domain NN O O
registration NN O O
timed VBD O O
out RP O O
September NNP O O
27th JJ O O
2014 CD O O
. . O O

It PRP O O
was VBD O O
left VBN O O
inactive JJ O O
and CC O O
was VBD O O
not RB O O
renewed VBN O O
until IN O O
Nov NNP O O
12th JJ O O
. . O O

This DT O O
means VBZ O O
that IN O O
the DT O O
attackers NNS O O
distributed VBD O O
malware NN O O
that WDT O O
would MD O O
be VB O O
out IN O O
of IN O O
action NN O O
for IN O O
a DT O O
long JJ O O
time NN O O
( CD O O
last JJ O O
distribution NN O O
of IN O O
sccm.exe NN O O
was VBD O O
September NNP O O
26th JJ O O
) NN O O
. . O O

Because IN O O
of IN O O
all PDT O O
this DT O O
we PRP O O
consider VBP O O
sccm.exe NN O O
as IN O O
an DT O O
unreliable JJ O O
indicator NN O O
. . O O

It PRP O O
is VBZ O O
likely JJ O O
to TO O O
be VB O O
a DT O O
red JJ O O
herring NN O O
purposefully RB O O
placed VBN O O
on IN O O
shares NNS O O
where WRB O O
the DT O O
attackers NNS O O
have VBP O O
seen VBN O O
signs NNS O O
of IN O O
access NN O O
by IN O O
security NN O O
researchers NNS O O
. . O O

At IN O O
one CD O O
instance NN O O
the DT O O
attackers NNS O O
seem VBP O O
to TO O O
have VB O O
slipped VBN O O
up RP O O
. . O O

Instead RB O O
of IN O O
using VBG O O
their PRP$ O O
scheduled VBN O O
task NN O O
, , O O
they PRP O O
apparently RB O O
did VBD O O
something NN O O
manually RB O O
on IN O O
a DT O O
WebDAV NN O O
share NN O O
. . O O

This DT O O
is VBZ O O
visible JJ O O
because IN O O
the DT O O
request NN O O
came VBD O O
from IN O O
an DT O O
apparent JJ O O
attacker NN O O
IP NNP O O
, , O O
but CC O O
used VBD O O
yet RB O O
another DT O O
User-Agent NNP O O
: : O O
'' '' O O
gvfs/1.12.3 NN O O
'' '' O O
. . O O

Gvfs NNP O O
is VBZ O O
the DT O O
virtual JJ O O
filesystem NN O O
for IN O O
Gnome NNP O O
desktop NN O O
. . O O

The DT O O
action NN O O
on IN O O
the DT O O
account NN O O
was VBD O O
abnormal JJ O O
as IN O O
well RB O O
; : O O
an DT O O
apparent JJ O O
file NN O O
upload NN O O
: : O O
When WRB O O
WebDAV NN O O
shares NNS O O
are VBP O O
mapped VBN O O
up RP O O
as IN O O
drives NNS O O
by IN O O
the DT O O
operating NN O O
system NN O O
, , O O
any DT O O
action NN O O
taken VBN O O
by IN O O
the DT O O
attacker NN O O
follows VBZ O O
the DT O O
same JJ O O
pattern NN O O
as IN O O
on IN O O
the DT O O
attacker NN O O
's POS O O
local JJ O O
drive NN O O
. . O O

In IN O O
the DT O O
case NN O O
above IN O O
, , O O
it PRP O O
seems VBZ O O
the DT O O
attacker NN O O
attempted VBD O O
to TO O O
edit VB O O
a DT O O
new JJ O O
document NN O O
, , O O
which WDT O O
by IN O O
default NN O O
is VBZ O O
given VBN O O
the DT O O
name NN O O
'' '' O O
Untitled JJ O O
document NN O O
'' '' O O
in IN O O
Gnome NNP O O
. . O O

This DT O O
might NN O O
indicate VBP O O
that IN O O
the DT O O
attacker NN O O
's POS O O
operating NN O O
system NN O O
language NN O O
is VBZ O O
Spanish NNP O O
. . O O

Of IN O O
course NN O O
, , O O
Spanish NNP O O
is VBZ O O
one CD O O
of IN O O
the DT O O
world NN O O
's POS O O
most JJS O O
widespread JJ O O
languages NNS O O
, , O O
so IN O O
one PRP O O
can MD O O
not RB O O
infer VB O O
much RB O O
from IN O O
this DT O O
. . O O

There EX O O
is VBZ O O
even RB O O
a DT O O
small JJ O O
possibility NN O O
that IN O O
the DT O O
phenomenon NN O O
is VBZ O O
a DT O O
pure JJ O O
artifact NN O O
; : O O
for IN O O
example NN O O
that IN O O
a DT O O
Spanish-speaking JJ O O
researcher NN O O
connected VBN O O
to TO O O
the DT O O
same JJ O O
account NN O O
using VBG O O
the DT O O
same JJ O O
Linux-based JJ O O
setup NN O O
as IN O O
the DT O O
attackers NNS O O
. . O O

This DT O O
attack NN O O
system NN O O
shares VBZ O O
a DT O O
number NN O O
of IN O O
properties NNS O O
that WDT O O
are VBP O O
somewhat RB O O
similar JJ O O
with IN O O
the DT O O
Red NNP O O
October NNP O O
campaigns NNS O O
detailed VBN O O
by IN O O
Kaspersky NNP O O
Labs NNPS O O
in IN O O
2013 CD O O
. . O O

For IN O O
more JJR O O
information NN O O
about IN O O
this DT O O
see VBP O O
: : O O
The DT O O
'' '' O O
Red NNP O O
October NNP O O
'' '' O O
Campaign NNP O O
- : O O
An NNP O O
Advanced NNP O O
Cyber NNP O O
Espionage NN O O
Network NNP O O
Targeting NN O O
Diplomatic NNP O O
and CC O O
Government NNP O O
Agencies NNPS O O
However RB O O
, , O O
there EX O O
are VBP O O
also RB O O
clear JJ O O
differences NNS O O
. . O O

The DT O O
code NN O O
is VBZ O O
fully RB O O
rewritten VBN O O
; : O O
there EX O O
appears VBZ O O
to TO O O
be VB O O
little JJ O O
code NN O O
overlap VB O O
, , O O
at IN O O
least JJS O O
in IN O O
the DT O O
initial JJ O O
stage NN O O
malware NN O O
. . O O

The DT O O
coding VBG O O
style NN O O
is VBZ O O
different JJ O O
, , O O
with IN O O
different JJ O O
solutions NNS O O
to TO O O
programmatic JJ O O
problems NNS O O
, , O O
different JJ O O
use NN O O
of IN O O
exception NN O O
handling NN O O
, , O O
and CC O O
different JJ O O
use NN O O
of IN O O
C++ NNP O O
classes NNS O O
. . O O

It PRP O O
's VBZ O O
hard JJ O O
to TO O O
believe VB O O
that IN O O
the DT O O
same JJ O O
programmers NNS O O
are VBP O O
responsible JJ O O
for IN O O
the DT O O
two CD O O
code NN O O
bases NNS O O
. . O O

The DT O O
Red NNP O O
October NNP O O
malware NN O O
contained VBD O O
linguistic JJ O O
markers NNS O O
that WDT O O
pointed VBD O O
towards IN O O
Russian JJ O O
speaking NN O O
attackers NNS O O
. . O O

No DT O O
such JJ O O
clues NNS O O
have VBP O O
been VBN O O
found VBN O O
in IN O O
the DT O O
Inception- NN O O
related JJ O O
malware NN O O
; : O O
there EX O O
is VBZ O O
a DT O O
marked JJ O O
difference NN O O
in IN O O
the DT O O
attention NN O O
to TO O O
detail NN O O
and CC O O
information NN O O
leakage NN O O
. . O O

It PRP O O
is VBZ O O
certainly RB O O
possible JJ O O
that IN O O
the DT O O
same JJ O O
people NNS O O
have VBP O O
organized VBN O O
both DT O O
Inception NNP O O
and CC O O
Red NNP O O
October NNP O O
, , O O
but CC O O
there EX O O
are VBP O O
no DT O O
clear JJ O O
indications NNS O O
to TO O O
this DT O O
effect NN O O
. . O O

The DT O O
Windows-based JJ O O
malware NN O O
in IN O O
this DT O O
paper NN O O
generally RB O O
contains VBZ O O
very RB O O
few JJ O O
noticeable JJ O O
strings NNS O O
apart RB O O
from IN O O
what WP O O
is VBZ O O
commonly RB O O
found VBN O O
in IN O O
software NN O O
, , O O
and CC O O
clearly RB O O
randomized VBN O O
strings NNS O O
. . O O

What WP O O
exists VBZ O O
â€“ NNP O O
like IN O O
the DT O O
word NN O O
'' '' O O
polymorphed VBD O O
'' '' O O
in IN O O
the DT O O
early JJ O O
DLL NNP O O
versions NNS O O
- : O O
is VBZ O O
standard JJ O O
English NNP O O
with IN O O
few JJ O O
discerning JJ O O
features NNS O O
. . O O

This DT O O
changes VBZ O O
a DT O O
bit NN O O
when WRB O O
we PRP O O
look VBP O O
at IN O O
the DT O O
mobile JJ O O
malware NN O O
. . O O

In IN O O
the DT O O
Android NNP O O
malware NN O O
we PRP O O
find VBP O O
Hindi JJ O O
comments NNS O O
in IN O O
the DT O O
Java NNP O O
source NN O O
code NN O O
. . O O

In IN O O
the DT O O
Iphone NNP O O
malware NN O O
we PRP O O
find VBP O O
project NN O O
paths NNS O O
referencing VBG O O
one CD O O
'' '' O O
JohnClerk NNP O O
'' '' O O
, , O O
and CC O O
a DT O O
few JJ O O
typos NNS O O
like IN O O
'' '' O O
conutry NN O O
'' '' O O
. . O O

In IN O O
one CD O O
of IN O O
the DT O O
Blackberry NNP O O
binaries NNS O O
we PRP O O
find VBP O O
the DT O O
string NN O O
'' '' O O
GodSaveTheQueen NN O O
'' '' O O
, , O O
a DT O O
rather RB O O
blunt JJ O O
hint NN O O
towards IN O O
Britain NNP O O
, , O O
as RB O O
well RB O O
as IN O O
Arabic JJ O O
log NN O O
strings NNS O O
. . O O

These DT O O
and CC O O
other JJ O O
indicators NNS O O
have VBP O O
led VBN O O
us PRP O O
to TO O O
conclude VB O O
that IN O O
the DT O O
Inception NNP O O
attackers NNS O O
are VBP O O
setting VBG O O
a DT O O
new JJ O O
standard NN O O
for IN O O
deliberate JJ O O
disinformation NN O O
and CC O O
red JJ O O
herrings NNS O O
in IN O O
a DT O O
malware NN O O
espionage NN O O
operation NN O O
. . O O

Some DT O O
clues NNS O O
might MD O O
have VB O O
been VBN O O
added VBN O O
by IN O O
accident NN O O
, , O O
but CC O O
none NN O O
of IN O O
these DT O O
indicators NNS O O
can MD O O
be VB O O
trusted VBN O O
in IN O O
any DT O O
way NN O O
. . O O

Thus RB O O
we PRP O O
are VBP O O
not RB O O
going VBG O O
to TO O O
assume VB O O
anything NN O O
about IN O O
who WP O O
might MD O O
be VB O O
behind IN O O
these DT O O
attacks NNS O O
. . O O

The DT O O
whole JJ O O
Inception NN O O
setup NN O O
shows VBZ O O
signs NNS O O
of IN O O
automation NN O O
and CC O O
seasoned JJ O O
programming NN O O
. . O O

The DT O O
amount NN O O
of IN O O
layers NNS O O
used VBN O O
in IN O O
this DT O O
scheme NN O O
to TO O O
protect VB O O
the DT O O
payload NN O O
of IN O O
their PRP$ O O
attack NN O O
seems VBZ O O
excessively RB O O
paranoid JJ O O
. . O O

Not RB O O
only RB O O
is VBZ O O
the DT B-Entity 1
initial JJ I-Entity O
DLL NNP I-Entity O
apparently RB O O
polymorphed VBD B-Action 2
using VBG B-Modifier 3
some DT B-Entity 4
backend JJ I-Entity O
tool NN I-Entity O
â€“ CD O O
the DT O O
compile VBP O O
time NN O O
stamps NNS O O
in IN O O
the DT O O
PE NN O O
header NN O O
are VBP O O
clearly RB O O
forged VBN O O
, , O O
resources NNS O O
are VBP O O
removed VBN O O
so RB O O
as RB O O
not RB O O
to TO O O
give VB O O
away RP O O
any DT O O
location NN O O
information NN O O
, , O O
and CC O O
import NN O O
tables NNS O O
are VBP O O
shuffled VBN O O
around IN O O
, , O O
rendering VBG O O
import NN O O
hashes VBZ O O
( FW O O
aka FW O O
imphashes NNS O O
) VBP O O
useless JJ O O
. . O O

The DT O O
names NNS O O
of IN O O
the DT O O
files NNS O O
both CC O O
when WRB O O
dropped VBN O O
and CC O O
their PRP$ O O
original JJ O O
names NNS O O
along IN O O
with IN O O
the DT O O
callback NN O O
directories NNS O O
, , O O
paths NNS O O
and CC O O
mutexes NNS O O
used VBD O O
all DT O O
seem VBP O O
to TO O O
be VB O O
dynamically RB O O
generated VBN O O
. . O O

The DT B-Entity 1
attackers NNS I-Entity O
utilize VBP B-Action 2
compromised VBN B-Entity 3
embedded JJ I-Entity O
devices NNS I-Entity O
â€“ VBP I-Entity O
typically RB I-Entity O
routers- JJ I-Entity O
on IN I-Entity O
the DT I-Entity O
Internet NN I-Entity O
as RB I-Entity O
well RB I-Entity O
as IN I-Entity O
multiple JJ I-Entity O
dedicated JJ I-Entity O
hosting VBG I-Entity O
providers NNS I-Entity O
and CC I-Entity O
VPN NNP I-Entity O
services NNS I-Entity O
to TO B-Modifier 4
mask NN B-Entity 5
their PRP$ I-Entity O
identity NN I-Entity O
from IN I-Entity O
the DT I-Entity O
cloud NN I-Entity O
storage NN I-Entity O
provider NN I-Entity O
and CC I-Entity O
others NNS I-Entity O
. . O O

The DT B-Entity 1
same JJ I-Entity O
router NN I-Entity O
botnet NN I-Entity O
is VBZ B-Action 2
used VBN I-Action O
as IN B-Modifier 3
a DT B-Entity 4
spreading NN I-Entity O
and CC I-Entity O
management NN I-Entity O
platform NN I-Entity O
for IN I-Entity O
attacks NNS I-Entity O
on IN I-Entity O
mobile JJ I-Entity O
devices NNS I-Entity O
as RB O O
well RB O O
. . O O

This DT O O
suggests VBZ O O
that IN O O
this DT O O
a DT O O
large JJ O O
campaign NN O O
and CC O O
we PRP O O
've VBP O O
only RB O O
seeing VBG O O
the DT O O
beginning NN O O
of IN O O
it PRP O O
. . O O

Initially RB O O
many JJ O O
of IN O O
the DT O O
targets NNS O O
were VBD O O
located JJ O O
in IN O O
Russia NNP O O
or CC O O
related JJ O O
to TO O O
Russian JJ O O
interests NNS O O
, , O O
but CC O O
as IN O O
the DT O O
campaign NN O O
has VBZ O O
evolved VBN O O
we PRP O O
have VBP O O
verified VBN O O
targets NNS O O
in IN O O
countries NNS O O
all DT O O
over IN O O
the DT O O
world NN O O
. . O O

It PRP O O
is VBZ O O
clear JJ O O
that IN O O
this DT O O
infrastructure NN O O
model NN O O
does VBZ O O
not RB O O
need VB O O
to TO O O
be VB O O
applied VBN O O
solely RB O O
against IN O O
a DT O O
few JJ O O
targets NNS O O
, , O O
or CC O O
even RB O O
need VB O O
to TO O O
be VB O O
hosted VBN O O
at IN O O
CloudMe NN O O
. . O O

The DT O O
framework NN O O
is VBZ O O
generic JJ O O
, , O O
and CC O O
will MD O O
work VB O O
as IN O O
an DT O O
attack NN O O
platform NN O O
for IN O O
a DT O O
multitude NN O O
of IN O O
purposes NNS O O
with IN O O
very RB O O
little JJ O O
modification NN O O
. . O O

The DT O O
attribution NN O O
indicators NNS O O
point NN O O
in IN O O
different JJ O O
directions NNS O O
and CC O O
ca MD O O
n't RB O O
be VB O O
given VBN O O
much JJ O O
weight NN O O
. . O O

These DT O O
attacks NNS O O
can MD O O
in IN O O
theory NN O O
be VB O O
the DT O O
creation NN O O
of IN O O
nation NN O O
states NNS O O
or CC O O
resourceful JJ O O
private JJ O O
entities NNS O O
- : O O
we PRP O O
consider VBP O O
it PRP O O
very RB O O
unlikely JJ O O
that IN O O
they PRP O O
are VBP O O
performed VBN O O
by IN O O
one CD O O
or CC O O
just RB O O
a DT O O
few JJ O O
individuals NNS O O
. . O O

haarmannsi.cz FW O O
sanygroup.co.uk FW O O
ecolines.es FW O O
blackberry-support.herokuapp.com FW O O
( FW O O
DynDNS FW O O
) FW O O
The DT O O
following JJ O O
entities NNS O O
have VBP O O
helped VBN O O
in IN O O
big JJ O O
and CC O O
small JJ O O
ways NNS O O
. . O O

Big JJ O O
thanks NNS O O
to TO O O
all DT O O
. . O O

We PRP O O
also RB O O
owe VBP O O
a DT O O
big JJ O O
debt NN O O
of IN O O
gratitude NN O O
to TO O O
Ryan NNP O O
W. NNP O O
Smith NNP O O
of IN O O
Blue NNP O O
Coat NNP O O
who WP O O
helped VBD O O
us PRP O O
tremendously RB O O
with IN O O
the DT O O
analysis NN O O
of IN O O
the DT O O
mobile JJ O O
malware NN O O
. . O O

