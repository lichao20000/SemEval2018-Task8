It PRP O O
's VBZ O O
friday NNP O O
afternoon NN O O
, , O O
I PRP O O
had VBD O O
a DT O O
bit NN O O
of IN O O
free JJ O O
time NN O O
and CC O O
stumbled VBD O O
across IN O O
this DT O O
tweet NN O O
by IN O O
PhysicalDrive0 NN O O
( FW O O
thx FW O O
! . O O
) CD O O
two CD O O
hours NNS O O
ago RB O O
and CC O O
thought VBN O O
to TO O O
give VB O O
it PRP O O
a DT O O
try NN O O
to TO O O
finally RB O O
add VB O O
a DT O O
new JJ O O
article NN O O
to TO O O
this DT O O
Blog FW O O
( FW O O
first JJ O O
of IN O O
2014 CD O O
) NN O O
: : O O
So RB O O
, , O O
I PRP O O
went VBD O O
to TO O O
Google NNP O O
to TO O O
search VB O O
for IN O O
the DT O O
domain NN O O
of IN O O
the DT O O
Embassy NNP O O
of IN O O
Greece NNP O O
Beijing NNP O O
and CC O O
added VBD O O
the DT O O
( NNP O O
allegedly RB O O
) CD O O
malicious JJ O O
java NN O O
file NN O O
package NN O O
that WDT O O
was VBD O O
found VBN O O
by IN O O
PhysicalDrive0 NN O O
: : O O
Next NNP O O
, , O O
I PRP O O
loaded VBD O O
the DT O O
1.jar JJ O O
file NN O O
into IN O O
Java NNP O O
Decompiler NNP O O
to TO O O
get VB O O
the DT O O
source NN O O
code NN O O
. . O O

It PRP O O
showed VBD O O
, , O O
that IN O O
the DT O O
functionality NN O O
is VBZ O O
obfuscated VBN O O
in IN O O
some DT O O
way NN O O
, , O O
e.g NN O O
. . O O

the DT O O
function NN O O
csfn FW O O
( FW O O
String NNP O O
paramString FW O O
) FW O O
decrypts VBZ O O
all DT O O
strings NNS O O
by IN O O
'' '' O O
removing VBG O O
'' '' O O
the DT O O
numbers NNS O O
of IN O O
the DT O O
string NN O O
parameter NN O O
: : O O
There EX O O
are VBP O O
some DT O O
other JJ O O
obfuscation NN O O
techniques NNS O O
, , O O
but CC O O
they PRP O O
are VBP O O
not RB O O
important JJ O O
here RB O O
. . O O

Instead RB O O
, , O O
the DT O O
following JJ O O
deobfuscated JJ O O
code NN O O
line NN O O
in IN O O
the DT O O
function NN O O
init FW O O
( FW O O
) FW O O
gives VBZ O O
us PRP O O
an DT O O
idea NN O O
where WRB O O
the DT O O
actual JJ O O
payload NN O O
is VBZ O O
located JJ O O
: : O O
We PRP O O
can MD O O
also RB O O
see VB O O
, , O O
that IN O O
the DT O O
java NN O O
package NN O O
contains VBZ O O
a DT O O
file NN O O
named VBN O O
pack NN O O
, , O O
so IN O O
we PRP O O
open VBP O O
7-Zip NN O O
and CC O O
unpack VB O O
the DT O O
file NN O O
. . O O

A DT O O
quick JJ O O
view NN O O
with IN O O
a DT O O
PE NN O O
viewer NN O O
showed VBD O O
, , O O
that IN O O
it PRP O O
is VBZ O O
a DT O O
x86 NN O O
PE NN O O
executable JJ O O
not RB O O
even RB O O
encrypted JJ O O
( FW O O
SHA256 FW O O
: : O O
b832e4b5a4829c8df6de7b42c5cb32ef25b5ab59072b4c2a7838404cd0dd5e5f FW O O
) FW O O
: : O O
So RB O O
, , O O
I PRP O O
opened VBD O O
IDA NNP O O
Pro FW O O
to TO O O
take VB O O
a DT O O
quick JJ O O
look NN O O
at IN O O
the DT O O
functionality NN O O
. . O O

Together RB O O
with IN O O
the DT O O
strings NNS O O
of IN O O
the DT O O
executable JJ O O
, , O O
we PRP O O
get VBP O O
a DT O O
brief JJ O O
idea NN O O
of IN O O
what WP O O
the DT O O
purpose NN O O
of IN O O
this DT O O
malware NN O O
is VBZ O O
. . O O

The DT O O
important JJ O O
strings NNS O O
are VBP O O
as IN O O
follows VBZ O O
: : O O
Together RB O O
with IN O O
the DT O O
output NN O O
of IN O O
IDA FW O O
Pro FW O O
, , O O
we PRP O O
can MD O O
see VB O O
that IN O O
this DT B-Entity 1
malware NN I-Entity O
uses VBZ O O
the DT O O
command NN O O
line NN O O
tool NN O O
cmd.exe NN O O
for IN O O
adding VBG B-Action 2
several JJ B-Entity 3
registry NN I-Entity O
keys NNS I-Entity O
to TO B-Modifier 4
Internet NNP B-Entity 5
Explorer NNP I-Entity O
. . O O

It PRP B-Entity 1
also RB O O
tries VBZ O O
to TO O O
retrieve VB B-Action 2
possible JJ B-Entity 3
AntiVirus NNP I-Entity O
information NN I-Entity O
by IN B-Modifier 4
using VBG B-Entity 5
the DT I-Entity O
COM NNP I-Entity O
interface NN I-Entity O
( NN O O
dc12a687-737f-11cf-884d-00aa004b2e24 NN O O
- : O O
> JJR O O
IWbemLocator NN O O
- : O O
> JJR O O
SELECT NNS O O
* SYM O O
FROM FW O O
AntiVirusProduct FW O O
) FW O O
. . O O

Furthermore RB O O
, , O O
it PRP B-Entity 1
makes VBZ O O
use NN O O
of IN O O
the DT O O
COM NN O O
to TO O O
launch VB B-Action 2
an DT B-Entity 3
instance NN I-Entity O
of IN I-Entity O
Internet NNP I-Entity O
Explorer NNP I-Entity O
( FW O O
d30c1661-cdaf-11d0-8a3e-00c04fc9e26e FW O O
- : O O
> JJR O O
IWebBrowser2 NN O O
) NN O O
, , O O
supposedly RB O O
to TO O O
contact VB B-Action 4
its PRP$ B-Entity 5
C NN I-Entity O
& CC I-Entity O
C NN I-Entity O
server NN I-Entity O
. . O O

To TO O O
verify VB O O
this DT O O
, , O O
we PRP O O
open VBP O O
up RP O O
Wireshark NNP O O
and CC O O
run VB O O
the DT O O
executable JJ O O
. . O O

As IN O O
a DT O O
result NN O O
, , O O
we PRP O O
get VBP O O
the DT O O
following VBG O O
network NN O O
information NN O O
: : O O
Also RB O O
, , O O
we PRP O O
see VBP O O
that IN O O
it PRP B-Entity 1
downloads NNS B-Action 2
some DT B-Entity 3
kind NN I-Entity O
of IN I-Entity O
data NNS I-Entity O
( FW O O
Base64 FW O O
encoded VBN O O
) NN O O
. . O O

But CC O O
first RB O O
, , O O
we PRP O O
combine VBP O O
the DT O O
C NN O O
& CC O O
C NN O O
server NN O O
and CC O O
the DT O O
HTTP NN O O
request NN O O
and CC O O
open VB O O
the DT O O
URL NN O O
in IN O O
our PRP$ O O
favorite JJ O O
Browser NN O O
: : O O
As IN O O
you PRP O O
can MD O O
see VB O O
, , O O
there EX O O
is VBZ O O
a DT O O
string NN O O
named VBN O O
microsoft NN O O
followed VBN O O
by IN O O
Base64 NN O O
encoded VBN O O
data NNS O O
. . O O

Side NN O O
note NN O O
: : O O
Is VBZ O O
there EX O O
also RB O O
a DT O O
Linux NNP O O
equivalent NN O O
? . O O
Next RB O O
, , O O
we PRP O O
copy VBP O O
the DT O O
Base64 NN O O
encoded VBD O O
data NNS O O
and CC O O
go VB O O
to TO O O
the DT O O
following VBG O O
website NN O O
to TO O O
let VB O O
us PRP O O
decode VB O O
it PRP O O
into IN O O
a DT O O
file NN O O
( NN O O
because IN O O
I PRP O O
had VBD O O
the DT O O
feeling NN O O
it PRP O O
's VBZ O O
just RB O O
another DT O O
unencrypted JJ O O
executable JJ O O
) NN O O
: : O O
As IN O O
a DT O O
result NN O O
, , O O
we PRP O O
get VBP O O
another DT O O
executable JJ O O
( NN O O
SHA256 NN O O
: : O O
a4863f44f48d1c4c050dd7baad767a86b348dd4d33924acf4e0a3cd40c6ae29f NN O O
) NN O O
that WDT O O
was VBD O O
only RB O O
Base64 NN O O
encoded VBN O O
and CC O O
not RB O O
encrypted VBN O O
in IN O O
any DT O O
way NN O O
: : O O
So IN O O
again RB O O
, , O O
we PRP O O
fire VBP O O
up RP O O
our PRP$ O O
PE NN O O
viewer NN O O
and CC O O
take VB O O
a DT O O
look NN O O
at IN O O
the DT O O
important JJ O O
strings NNS O O
: : O O
Again NNP O O
, , O O
we PRP O O
load VBP O O
the DT O O
executable JJ O O
into IN O O
IDA FW O O
Pro FW O O
and CC O O
quickly RB O O
fly VB O O
over IN O O
the DT O O
assembly NN O O
code NN O O
to TO O O
get VB O O
an DT O O
idea NN O O
of IN O O
the DT O O
functionality NN O O
. . O O

Once RB O O
again RB O O
, , O O
it PRP B-Entity 1
creates VBZ B-Action 2
several JJ B-Entity 3
registry NN I-Entity O
entries NNS I-Entity O
with IN B-Modifier 4
the DT B-Entity 5
help NN I-Entity O
of IN I-Entity O
the DT I-Entity O
command NN I-Entity O
line NN I-Entity O
tool NN I-Entity O
and CC O O
creates VBZ B-Action 6
an DT B-Entity 7
instance NN I-Entity O
of IN I-Entity O
the DT I-Entity O
Internet NNP I-Entity O
Explorer NNP I-Entity O
( NNP O O
CoCreateInstance NNP O O
( FW O O
) FW O O
- : O O
> JJR O O
d30c1661-cdaf-11d0-8a3e- NN O O
00c04fc9e26e FW O O
) FW O O
for IN O O
contacting VBG B-Action 8
the DT B-Entity 9
C NN I-Entity O
& CC I-Entity O
C NN I-Entity O
server NN I-Entity O
. . O O

This DT O O
time NN O O
, , O O
the DT O O
network NN O O
information NN O O
is VBZ O O
as IN O O
follows VBZ O O
: : O O
From IN O O
the DT O O
code NN O O
we PRP O O
can MD O O
see VB O O
, , O O
that IN O O
the DT B-Entity 1
sample NN I-Entity O
has VBZ O O
also RB O O
the DT O O
ability NN O O
to TO O O
encode VB B-Action 2
/ / O O
decode VB O O
data NNS B-Entity 3
from IN B-Modifier 4
/ / O O
to IN O O
Base64 FW B-Entity 5
. . O O

The DT O O
dynamic JJ O O
analysis NN O O
showed VBD O O
the DT B-Entity 1
malware NN I-Entity O
sample NN I-Entity O
contacted VBD B-Action 2
the DT B-Entity 3
C NN I-Entity O
& CC I-Entity O
C NN I-Entity O
server NN I-Entity O
, , O O
but CC O O
was VBD O O
n't RB O O
sending VBG O O
any DT O O
URL NN O O
parameters NNS O O
( FW O O
id1 FW O O
, , O O
id2 FW O O
) FW O O
. . O O

Also RB O O
the DT O O
server NN O O
did VBD O O
n't RB O O
respond VB O O
... : O O

The DT O O
files NNS O O
can MD O O
be VB O O
downloaded VBN O O
here RB O O
: : O O
That DT O O
's VBZ O O
it PRP O O
, , O O
have VBP O O
a DT O O
nice JJ O O
weekend NN O O
... : O O

