After IN O O
taking VBG O O
a DT O O
look NN O O
at IN O O
recent JJ O O
Korplug NNP O O
( NNP O O
PlugX NNP O O
) NNP O O
detections NNS O O
, , O O
we PRP O O
identified VBD O O
two CD B-Entity 1
larger JJR I-Entity O
scale NN I-Entity O
campaigns NNS I-Entity O
employing VBG B-Action 2
this DT B-Entity 3
well-known JJ I-Entity O
Remote JJ I-Entity O
Access NN I-Entity O
Trojan NNP I-Entity O
. . O O

This DT O O
blog NN O O
gives VBZ O O
an DT O O
overview NN O O
of IN O O
the DT O O
first JJ O O
one CD O O
, , O O
related VBN O O
to TO O O
Afghanistan NNP O O
& CC O O
Tajikistan NNP O O
. . O O

The DT O O
other JJ O O
campaign NN O O
, , O O
where WRB O O
the DT O O
targets NNS O O
were VBD O O
a DT O O
number NN O O
of IN O O
high-profile JJ O O
organizations NNS O O
in IN O O
Russia NNP O O
, , O O
will MD O O
be VB O O
the DT O O
subject NN O O
of IN O O
Anton NNP O O
Cherepanov NNP O O
's POS O O
presentation NN O O
at IN O O
the DT O O
ZeroNights NNP O O
security NN O O
conference NN O O
in IN O O
Moscow NNP O O
this DT O O
week NN O O
. . O O

Sometimes RB O O
malware RB O O
used VBN O O
in IN O O
various JJ O O
attacks NNS O O
is VBZ O O
unique JJ O O
enough RB O O
to TO O O
identify VB O O
related JJ O O
incidents NNS O O
, , O O
which WDT O O
makes VBZ O O
tracking VBG O O
individual JJ O O
botnets NNS O O
simpler JJR O O
. . O O

An DT O O
example NN O O
is VBZ O O
the DT O O
BlackEnergy NNP O O
Lite NNP O O
variant JJ O O
( NN O O
also RB O O
known VBN O O
as IN O O
BlackEnergy NNP O O
3 CD O O
) NN O O
used VBN O O
by IN O O
a DT O O
group NN O O
of IN O O
attackers NNS O O
( NN O O
that WDT O O
was VBD O O
then RB O O
given VBN O O
the DT O O
name NN O O
Quedagh NNP O O
, , O O
or CC O O
Sandworm FW O O
) FW O O
against IN O O
targets NNS O O
in IN O O
Ukraine NNP O O
and CC O O
other JJ O O
countries NNS O O
. . O O

BlackEnergy NNP O O
Lite NNP O O
is VBZ O O
clearly RB O O
distinguishable JJ O O
from IN O O
the DT O O
numerous JJ O O
binaries NNS O O
of IN O O
the DT O O
more RBR O O
common JJ O O
BlackEnergy NNP O O
2 CD O O
also RB O O
circulating VBG O O
in-the-wild JJ O O
. . O O

In IN O O
other JJ O O
cases NNS O O
, , O O
attackers NNS O O
use VBP O O
more RBR O O
common JJ O O
tools NNS O O
for IN O O
accomplishing VBG O O
their PRP$ O O
criminal JJ O O
goals NNS O O
. . O O

For IN O O
example NN O O
, , O O
the DT B-Entity 1
Korplug NNP I-Entity O
RAT NNP I-Entity O
( NNP I-Entity O
a.k.a JJ I-Entity O
.PlugX NN I-Entity O
) NN I-Entity O
is VBZ O O
a DT O O
well-known JJ O O
toolkit NN O O
associated VBN O O
with IN O O
Chinese JJ O O
APT NN O O
groups NNS O O
and CC O O
used VBN B-Action 2
in IN B-Modifier 3
a DT B-Entity 4
large JJ I-Entity O
number NN I-Entity O
of IN I-Entity O
targeted VBN I-Entity O
attacks NNS I-Entity O
since IN B-Modifier 5
2012 CD B-Entity 6
. . O O

For IN O O
the DT O O
past JJ O O
several JJ O O
weeks NNS O O
we PRP O O
have VBP O O
taken VBN O O
a DT O O
closer JJR O O
look NN O O
at IN O O
a DT O O
great JJ O O
number NN O O
of IN O O
detections NNS O O
of IN O O
this DT O O
malware NN O O
in IN O O
many JJ O O
unrelated JJ O O
incidents NNS O O
. . O O

Among IN O O
these DT O O
, , O O
we PRP O O
were VBD O O
able JJ O O
to TO O O
discover VB O O
several JJ O O
successful JJ O O
infections NNS O O
where WRB O O
the DT B-Entity 1
employed VBN I-Entity O
Korplug NN I-Entity O
samples NNS I-Entity O
were VBD B-Action 2
connecting VBG I-Action O
to TO B-Modifier 3
the DT B-Entity 4
same JJ I-Entity O
C NN I-Entity O
& CC I-Entity O
C NN I-Entity O
domain NN I-Entity O
. . O O

Other JJ B-Entity 1
Korplug NN I-Entity O
samples NNS I-Entity O
were VBD B-Action 2
connecting VBG I-Action O
to TO B-Modifier 3
a DT B-Entity 4
different JJ I-Entity O
domain NN I-Entity O
name NN I-Entity O
resolving VBG I-Entity O
to TO I-Entity O
the DT I-Entity O
same JJ I-Entity O
IPs NNS I-Entity O
as IN I-Entity O
notebookhk.net NN I-Entity O
: : O O
Taking VBG O O
these DT O O
C NNP O O
& CC O O
Cs NNP O O
as IN O O
a DT O O
starting VBG O O
point NN O O
, , O O
we PRP O O
were VBD O O
able JJ O O
to TO O O
locate VB O O
a DT O O
number NN O O
of IN O O
victims NNS O O
infected VBN O O
through IN O O
various JJ O O
exploit-laden JJ O O
spear-phishing NN O O
documents NNS O O
and CC O O
cunningly-named JJ O O
archives NNS O O
. . O O

A DT O O
table NN O O
with IN O O
a DT O O
selection NN O O
of IN O O
RTF NN O O
documents NNS O O
and CC O O
RAR NN O O
self-extracting JJ O O
archives NNS O O
with IN O O
a DT O O
.SCR NN O O

extension NN O O
is VBZ O O
shown VBN O O
below IN O O
: : O O
Some DT B-Entity 1
of IN I-Entity O
the DT I-Entity O
above-mentioned JJ I-Entity O
files NNS I-Entity O
also RB O O
contained VBD B-Action 2
decoy NN B-Entity 3
documents NNS I-Entity O
: : O O
In IN O O
all DT O O
of IN O O
the DT O O
cases NNS O O
, , O O
three CD B-Entity 4
binary JJ I-Entity O
files NNS I-Entity O
were VBD B-Action 5
dropped VBN I-Action O
( NN O O
apart RB O O
from IN O O
decoy NN O O
documents NNS O O
) NN O O
that WDT O O
led VBD O O
to TO O O
the DT B-Entity 6
Korplug NNP I-Entity O
trojan NN I-Entity O
being VBG B-Action 7
loading VBG I-Action O
into IN B-Modifier 8
memory NN B-Entity 9
. . O O

The DT B-Entity 1
Korplug JJ I-Entity O
RAT NN I-Entity O
is VBZ O O
known VBN O O
to TO O O
use VB B-Action 2
this DT B-Entity 3
side-loading JJ I-Entity O
trick NN I-Entity O
by IN O O
abusing VBG O O
legitimate JJ O O
digitally RB O O
signed VBN O O
executables NNS O O
and CC O O
is VBZ O O
a DT O O
way NN O O
to TO O O
stay VB B-Action 4
under IN B-Modifier 5
the DT B-Entity 6
radar NN I-Entity O
, , O O
since IN O O
a DT O O
trusted VBN O O
application NN O O
with IN O O
a DT O O
valid JJ O O
signature NN O O
among IN O O
startup NN O O
items NNS O O
is VBZ O O
less RBR O O
likely JJ O O
to TO O O
raise VB O O
suspicion NN O O
. . O O

The DT B-Entity 1
maliciously RB I-Entity O
crafted VBN I-Entity O
documents NNS I-Entity O
are VBP O O
RTF NN O O
files NNS O O
that WDT O O
successfully RB O O
exploit VBP B-Action 2
the DT B-Entity 3
CVE-2012-0158 NN I-Entity O
vulnerability NN I-Entity O
in IN I-Entity O
Microsoft NNP I-Entity O
Word NNP I-Entity O
. . O O

The DT O O
image NN O O
below IN O O
shows NNS O O
the DT O O
beginning NN O O
of IN O O
the DT O O
CVE-2012-0158 NN O O
shellcode NN O O
in IN O O
ASCII NNP O O
encoding VBG O O
within IN O O
the DT O O
document NN O O
( VBD O O
the DT O O
opcodes NNS O O
60 CD O O
, , O O
55 CD O O
, , O O
8bec NN O O
disassemble VB O O
to TO O O
pusha NN O O
; : O O
push NN O O
ebp NN O O
; : O O
mov FW O O
ebp FW O O
, , O O
esp FW O O
) FW O O
. . O O

Interestingly RB O O
, , O O
though RB O O
, , O O
the DT O O
documents NNS O O
also RB O O
contain VBP O O
the DT O O
newer JJR O O
CVE-2014-1761 NN O O
exploit VBP O O
that DT O O
was VBD O O
extensively RB O O
used VBN O O
in IN O O
targeted VBN O O
attacks NNS O O
carried VBD O O
out RP O O
by IN O O
a DT O O
number NN O O
other JJ O O
malware NN O O
families NNS O O
this DT O O
year NN O O
( NN O O
including VBG O O
BlackEnergy NNP O O
, , O O
Sednit NNP O O
, , O O
MiniDuke NNP O O
, , O O
and CC O O
others NNS O O
) VBP O O
. . O O

However RB O O
, , O O
this DT O O
exploit VBP O O
is VBZ O O
not RB O O
implemented VBN O O
correctly RB O O
due JJ O O
to TO O O
a DT O O
wrong JJ O O
file NN O O
offset VBN O O
in IN O O
the DT O O
1st JJ O O
stage NN O O
shellcode NN O O
. . O O

Below IN O O
we PRP O O
see VBP O O
the DT O O
disassembly NN O O
of IN O O
the DT O O
1st JJ O O
stage NN O O
shellcode NN O O
where WRB O O
it PRP O O
checks VBZ O O
the DT O O
presence NN O O
of IN O O
the DT O O
tag NN O O
'' '' O O
p NN O O
! . O O
11 CD O O
'' '' O O
marking VBG O O
the DT O O
beginning NN O O
of IN O O
the DT O O
2nd JJ O O
stage NN O O
shellcode NN O O
and CC O O
loads NNS O O
it PRP O O
into IN O O
memory NN O O
. . O O

Even RB O O
though IN O O
the DT O O
tag NN O O
and CC O O
2nd JJ O O
stage NN O O
shellcode NN O O
is VBZ O O
present JJ O O
in IN O O
the DT O O
RTF NNP O O
, , O O
it PRP O O
's VBZ O O
at IN O O
a DT O O
different JJ O O
offset VBN O O
, , O O
and CC O O
thus RB O O
never RB O O
is VBZ O O
loaded VBN O O
. . O O

Sophos NNP O O
' POS O O
Gabor NNP O O
Szappanos NNP O O
gives VBZ O O
a DT O O
possible JJ O O
explanation NN O O
how WRB O O
these DT O O
malformed JJ O O
samples NNS O O
may MD O O
have VB O O
come VBN O O
into IN O O
existence NN O O
. . O O

ESET NNP O O
LiveGrid NNP O O
telemetry NN O O
indicates VBZ O O
that IN O O
the DT O O
attacks NNS O O
against IN O O
these DT O O
targets NNS O O
have VBP O O
been VBN O O
going VBG O O
on IN O O
since IN O O
at IN O O
least JJS O O
June NNP O O
2014 CD O O
and CC O O
continue VB O O
through IN O O
today NN O O
. . O O

We PRP O O
were VBD O O
able JJ O O
to TO O O
pinpoint VB O O
the DT O O
targets NNS O O
to TO O O
residents NNS O O
of IN O O
the DT O O
following JJ O O
countries NNS O O
: : O O
From IN O O
the DT O O
topics NNS O O
of IN O O
the DT O O
files NNS O O
used VBN O O
to TO O O
spread VB O O
the DT O O
malware NN O O
, , O O
as RB O O
well RB O O
as IN O O
from IN O O
the DT O O
affected VBN O O
targets NNS O O
, , O O
it PRP O O
appears VBZ O O
that IN O O
the DT O O
attackers NNS O O
are VBP O O
interested JJ O O
in IN O O
gathering VBG O O
intelligence NN O O
related JJ O O
to TO O O
Afghan NNP O O
, , O O
Tajik NNP O O
and CC O O
Russian NNP O O
military JJ O O
and CC O O
diplomatic JJ O O
subjects NNS O O
. . O O

Interestingly RB O O
, , O O
most JJS O O
of IN O O
the DT O O
affected VBN O O
victims NNS O O
have VBP O O
another DT O O
thing NN O O
in IN O O
common JJ O O
– NN O O
a DT O O
number NN O O
of IN O O
other JJ O O
RATs NNS O O
, , O O
file NN O O
stealing NN O O
trojans NNS O O
or CC O O
keyloggers NNS O O
were VBD O O
detected VBN O O
on IN O O
their PRP$ O O
systems NNS O O
on IN O O
top NN O O
of IN O O
the DT O O
Korplug JJ O O
RAT NN O O
detection NN O O
. . O O

One CD B-Entity 1
of IN I-Entity O
these DT I-Entity O
'alternative JJ I-Entity O
RATs NNS I-Entity O
' POS I-Entity O
was VBD B-Action 2
connecting VBG I-Action O
to TO B-Modifier 3
a DT B-Entity 4
domain NN I-Entity O
also RB I-Entity O
used VBN I-Entity O
by IN I-Entity O
the DT I-Entity O
Korplug NN I-Entity O
samples NNS I-Entity O
. . O O

Since IN O O
the DT O O
functionality NN O O
of IN O O
these DT O O
tools NNS O O
was VBD O O
partly RB O O
overlapping VBG O O
with IN O O
that DT O O
of IN O O
Korplug NNP O O
, , O O
it PRP O O
left VBD O O
us PRP O O
wondering VBG O O
whether IN O O
the DT O O
attackers NNS O O
were VBD O O
just RB O O
experimenting VBG O O
with IN O O
different JJ O O
RATs NNS O O
or CC O O
were VBD O O
they PRP O O
supplementing VBG O O
some DT O O
functionality NN O O
that IN O O
they PRP O O
were VBD O O
unable JJ O O
to TO O O
accomplish VB O O
. . O O

Additional JJ O O
information NN O O
about IN O O
two CD O O
malware NN O O
families NNS O O
that WDT O O
were VBD O O
most RBS O O
often RB O O
found VBN O O
accompanying VBG O O
Korplug NN O O
infections NNS O O
is VBZ O O
given VBN O O
below IN O O
. . O O

A DT O O
curious JJ O O
Remote JJ O O
Access NN O O
Trojan NNP O O
, , O O
as IN O O
research NN O O
points NNS O O
to TO O O
a DT O O
Chinese JJ O O
connection NN O O
but CC O O
the DT O O
commands NNS O O
it PRP O O
listens VBZ O O
to TO O O
are VB O O
in IN O O
Spanish JJ O O
( NN O O
translation NN O O
in IN O O
English JJ O O
) NN O O
: : O O
The DT B-Entity 1
malware NN I-Entity O
can MD O O
manage VB B-Action 2
processes NNS B-Entity 3
and CC I-Entity O
services NNS I-Entity O
on IN I-Entity O
the DT I-Entity O
infected JJ I-Entity O
machine NN I-Entity O
, , O O
transfer NN B-Action 4
files NNS B-Entity 5
to TO B-Modifier 6
and CC O O
from IN B-Modifier 7
the DT B-Entity 8
C NN I-Entity O
& CC I-Entity O
C NN I-Entity O
server NN I-Entity O
, , O O
run NN B-Action 9
shell NN B-Entity 10
commands NNS I-Entity O
, , O O
and CC O O
so RB O O
on IN O O
. . O O

It PRP B-Entity 1
is VBZ O O
written VBN O O
in IN O O
Delphi NNP O O
and CC O O
connects VBZ B-Action 2
to TO B-Modifier 3
www.dicemention.com NNP B-Entity 4
. . O O

Some DT O O
samples NNS O O
contain VBP O O
a DT O O
digital JJ O O
signature NN O O
by IN O O
'' '' O O
Nanning FW O O
weiwu FW O O
Technology NN O O
co. NN O O
, , O O
ltd NN O O
'' '' O O
. . O O

This DT B-Entity 1
malware NN I-Entity O
, , O O
written VBN O O
in IN O O
C NN O O
, , O O
and CC O O
contains VBZ O O
several JJ O O
functions NNS O O
for IN O O
harvesting VBG B-Action 2
files NNS B-Entity 3
off IN B-Modifier 4
the DT B-Entity 5
victim NN I-Entity O
's POS I-Entity O
hard JJ I-Entity O
drive NN I-Entity O
according VBG B-Modifier 6
to TO I-Modifier O
criteria NNS B-Entity 7
set VBN I-Entity O
in IN I-Entity O
the DT I-Entity O
configuration NN I-Entity O
file NN I-Entity O
. . O O

Apart RB O O
from IN O O
doing VBG B-Action 1
a DT B-Entity 2
recursive JJ I-Entity O
sweep NN I-Entity O
of IN I-Entity O
all DT I-Entity O
logical JJ I-Entity O
fixed JJ I-Entity O
and CC I-Entity O
remote JJ I-Entity O
drives NNS I-Entity O
, , O O
it PRP B-Entity 3
also RB O O
continually RB O O
monitors VBZ B-Action 4
any DT O O
attached JJ B-Entity 5
removable JJ I-Entity O
media NNS I-Entity O
or CC O O
network NN B-Entity 6
shares NNS I-Entity O
by IN B-Modifier 7
listening VBG B-Entity 8
to TO I-Entity O
DBTDEVICEARRIVAL NN I-Entity O
events NNS I-Entity O
. . O O

In IN O O
addition NN O O
to TO O O
collecting VBG B-Action 1
files NNS B-Entity 2
, , O O
the DT B-Entity 3
malware NN I-Entity O
attempts VBZ O O
to TO O O
gather VB B-Action 4
saved VBN B-Entity 5
passwords NNS I-Entity O
, , O O
history NN B-Entity 6
of IN I-Entity O
visited VBN I-Entity O
URLs NNS I-Entity O
, , O O
account NN B-Entity 7
information NN I-Entity O
and CC O O
proxy NN B-Entity 8
information NN I-Entity O
from IN B-Modifier 9
the DT B-Entity 10
following JJ I-Entity O
applications NNS I-Entity O
: : O O
The DT O O
C NN O O
& CC O O
C NN O O
domains NNS O O
used VBN O O
by IN O O
this DT O O
malware NN O O
are VBP O O
: : O O
Some DT B-Entity 11
samples NNS I-Entity O
of IN I-Entity O
this DT I-Entity O
file NN I-Entity O
stealer NN I-Entity O
detected VBN B-Action 12
in IN B-Modifier 13
these DT B-Entity 14
campaigns NNS I-Entity O
also RB O O
contain VBP O O
the DT O O
signature NN O O
by IN O O
'' '' O O
Nanning FW O O
weiwu FW O O
Technology NN O O
co. NN O O
, , O O
ltd NN O O
'' '' O O
– NN O O
another DT O O
indicator NN O O
that IN O O
the DT O O
infections NNS O O
are VBP O O
related VBN O O
. . O O

