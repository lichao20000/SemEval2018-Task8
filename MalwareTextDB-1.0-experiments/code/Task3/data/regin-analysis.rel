In IN O O
the DT O O
world NN O O
of IN O O
malware NN O O
threats NNS O O
, , O O
only RB O O
a DT O O
few JJ O O
rare JJ O O
examples NNS O O
can MD O O
truly RB O O
be VB O O
considered VBN O O
groundbreaking JJ O O
and CC O O
almost RB O O
peerless JJ O O
. . O O

What WP O O
we PRP O O
have VBP O O
seen VBN O O
in IN O O
Regin NNP O O
is VBZ O O
just RB O O
such JJ O O
a DT O O
class NN O O
of IN O O
malware NN O O
. . O O

Regin NNP B-Entity 1
is VBZ O O
an DT O O
extremely RB O O
complex JJ O O
piece NN O O
of IN O O
software NN O O
that WDT O O
can MD O O
be VB O O
customized VBN O O
with IN O O
a DT O O
wide JJ O O
range NN O O
of IN O O
different JJ O O
capabilities NNS O O
which WDT O O
can MD O O
be VB O O
deployed VBN O O
depending VBG O O
on IN O O
the DT O O
target NN O O
. . O O

It PRP B-Entity 1
is VBZ O O
built VBN O O
on IN O O
a DT O O
framework NN O O
that WDT O O
is VBZ O O
designed VBN O O
to TO O O
sustain VB B-Action 2
long-term JJ B-Entity 3
intelligence-gathering JJ I-Entity O
operations NNS I-Entity O
by IN O O
remaining VBG B-Action 4
under IN B-Modifier 5
the DT B-Entity 6
radar NN I-Entity O
. . O O

It PRP B-Entity 1
goes VBZ O O
to TO O O
extraordinary JJ O O
lengths NNS O O
to TO O O
conceal VB B-Action 2
itself PRP B-Entity 3
and CC I-Entity O
its PRP$ I-Entity O
activities NNS I-Entity O
on IN I-Entity O
compromised VBN I-Entity O
computers NNS I-Entity O
. . O O

Its PRP$ O O
stealth NN O O
combines VBZ O O
many JJ O O
of IN O O
the DT O O
most RBS O O
advanced JJ O O
techniques NNS O O
that IN O O
we PRP O O
have VBP O O
ever RB O O
seen VBN O O
in IN O O
use NN O O
. . O O

The DT B-Entity 1
main JJ I-Entity O
purpose NN I-Entity O
of IN I-Entity O
Regin NN I-Entity O
is VBZ B-Action 2
intelligence NN B-Entity 3
gathering NN I-Entity O
and CC O O
it PRP B-Entity 4
has VBZ O O
been VBN O O
implicated VBN B-Action 5
in IN B-Modifier 6
data NN B-Entity 7
collection NN I-Entity O
operations NNS I-Entity O
against IN I-Entity O
government NN I-Entity O
organizations NNS I-Entity O
, , I-Entity O
infrastructure NN I-Entity O
operators NNS I-Entity O
, , I-Entity O
businesses NNS I-Entity O
, , I-Entity O
academics NNS I-Entity O
, , I-Entity O
and CC I-Entity O
private JJ I-Entity O
individuals NNS I-Entity O
. . O O

The DT O O
level NN O O
of IN O O
sophistication NN O O
and CC O O
complexity NN O O
of IN O O
Regin NNP O O
suggests VBZ O O
that IN O O
the DT O O
development NN O O
of IN O O
this DT O O
threat NN O O
could MD O O
have VB O O
taken VBN O O
well-resourced JJ O O
teams NNS O O
of IN O O
developers NNS O O
many JJ O O
months NNS O O
or CC O O
years NNS O O
to TO O O
develop VB O O
and CC O O
maintain VB O O
. . O O

Regin NNP O O
is VBZ O O
a DT O O
multi-staged JJ O O
, , O O
modular JJ O O
threat NN O O
, , O O
meaning VBG O O
that IN O O
it PRP O O
has VBZ O O
a DT O O
number NN O O
of IN O O
components NNS O O
, , O O
each DT O O
depending VBG O O
on IN O O
others NNS O O
, , O O
to TO O O
perform VB O O
attack NN O O
operations NNS O O
. . O O

This DT O O
modular JJ O O
approach NN O O
gives VBZ O O
flexibility NN O O
to TO O O
the DT O O
threat NN O O
operators NNS O O
as IN O O
they PRP O O
can MD O O
load VB O O
custom NN O O
features NNS O O
tailored VBN O O
to TO O O
individual JJ O O
targets NNS O O
when WRB O O
required VBN O O
. . O O

Some DT O O
custom NN O O
payloads NNS O O
are VBP O O
very RB O O
advanced JJ O O
and CC O O
exhibit VBP O O
a DT O O
high JJ O O
degree NN O O
of IN O O
expertise NN O O
in IN O O
specialist NN O O
sectors NNS O O
. . O O

The DT B-Entity 1
modular JJ I-Entity O
design NN I-Entity O
also RB O O
makes VBZ B-Action 2
analysis NN B-Entity 3
of IN I-Entity O
the DT I-Entity O
threat NN I-Entity O
difficult JJ I-Entity O
, , O O
as IN O O
all DT O O
components NNS O O
must MD O O
be VB O O
available JJ O O
in IN O O
order NN O O
to TO O O
fully RB O O
understand VB O O
it PRP O O
. . O O

This DT O O
modular JJ O O
approach NN O O
has VBZ O O
been VBN O O
seen VBN O O
in IN O O
other JJ O O
sophisticated JJ O O
malware NN O O
families NNS O O
such JJ O O
as IN O O
Flamer NNP O O
and CC O O
Weevil NNP O O
( NNP O O
The NNP O O
Mask NNP O O
) NNP O O
, , O O
while IN O O
the DT O O
multi-stage JJ O O
loading NN O O
architecture NN O O
is VBZ O O
similar JJ O O
to TO O O
that DT O O
seen VBN O O
in IN O O
the DT O O
Duqu/Stuxnet NN O O
family NN O O
of IN O O
threats NNS O O
. . O O

Regin NNP O O
is VBZ O O
different JJ O O
to TO O O
what WP O O
are VBP O O
commonly RB O O
referred VBN O O
to TO O O
as IN O O
'' '' O O
traditional JJ O O
'' '' O O
advanced JJ O O
persistent JJ O O
threats NNS O O
( FW O O
APTs FW O O
) NN O O
, , O O
both CC O O
in IN O O
its PRP$ O O
techniques NNS O O
and CC O O
ultimate JJ O O
purpose NN O O
. . O O

APTs NNS B-Entity 1
typically RB O O
seek VBP B-Action 2
specific JJ B-Entity 3
information NN I-Entity O
, , I-Entity O
usually RB I-Entity O
intellectual JJ I-Entity O
property NN I-Entity O
. . O O

Regin NNP O O
's POS O O
purpose NN O O
is VBZ O O
different JJ O O
. . O O

It PRP B-Entity 1
is VBZ B-Action 2
used VBN I-Action O
for IN B-Modifier 3
the DT B-Entity 4
collection NN I-Entity O
of IN I-Entity O
data NNS I-Entity O
and CC O O
continuous JJ O O
monitoring NN B-Action 5
of IN B-Modifier 6
targeted VBN B-Entity 7
organizations NNS I-Entity O
or CC I-Entity O
individuals NNS I-Entity O
. . O O

This DT O O
report NN O O
provides VBZ O O
a DT O O
technical JJ O O
analysis NN O O
of IN O O
Regin NN O O
based VBN O O
on IN O O
a DT O O
number NN O O
of IN O O
identified VBN O O
samples NNS O O
and CC O O
components NNS O O
. . O O

This DT O O
analysis NN O O
illustrates VBZ O O
Regin NNP O O
's POS O O
architecture NN O O
and CC O O
the DT O O
many JJ O O
payloads NNS O O
at IN O O
its PRP$ O O
disposal NN O O
. . O O

Regin NNP O O
is VBZ O O
a DT O O
multi-purpose JJ O O
data NN O O
collection NN O O
tool NN O O
which WDT O O
dates VBZ O O
back RB O O
several JJ O O
years NNS O O
. . O O

Symantec NNP O O
first RB O O
began VBD O O
looking VBG O O
into IN O O
this DT O O
threat NN O O
in IN O O
the DT O O
fall NN O O
of IN O O
2013 CD O O
. . O O

Multiple JJ O O
versions NNS O O
of IN O O
Regin NNP O O
were VBD O O
found VBN O O
in IN O O
the DT O O
wild JJ O O
, , O O
targeting VBG O O
several JJ O O
corporations NNS O O
, , O O
institutions NNS O O
, , O O
academics NNS O O
, , O O
and CC O O
individuals NNS O O
. . O O

Regin NNP B-Entity 1
has VBZ O O
a DT O O
wide JJ O O
range NN O O
of IN O O
standard JJ O O
capabilities NNS O O
, , O O
particularly RB O O
around IN O O
monitoring VBG B-Action 2
targets NNS B-Entity 3
and CC O O
stealing NN B-Action 4
data NNS B-Entity 5
. . O O

It PRP O O
also RB O O
has VBZ O O
the DT O O
ability NN O O
to TO O O
load VB O O
custom NN O O
features NNS O O
tailored VBN O O
to TO O O
individual JJ O O
targets NNS O O
. . O O

Some DT O O
of IN O O
Regin NNP O O
's POS O O
custom NN O O
payloads NNS O O
point VBP O O
to TO O O
a DT O O
high JJ O O
level NN O O
of IN O O
specialist NN O O
knowledge NN O O
in IN O O
particular JJ O O
sectors NNS O O
, , O O
such JJ O O
as IN O O
telecoms NNS O O
infrastructure NN O O
software NN O O
, , O O
on IN O O
the DT O O
part NN O O
of IN O O
the DT O O
developers NNS O O
. . O O

Regin NNP B-Entity 1
is VBZ O O
capable JJ O O
of IN O O
installing VBG B-Action 2
a DT B-Entity 3
large JJ I-Entity O
number NN I-Entity O
of IN I-Entity O
additional JJ I-Entity O
payloads NNS I-Entity O
, , O O
some DT O O
highly RB O O
customized VBN O O
for IN O O
the DT O O
targeted VBN O O
computer NN O O
. . O O

The DT B-Entity 1
threat NN I-Entity O
's POS I-Entity O
standard JJ I-Entity O
capabilities NNS I-Entity O
include VBP B-Action 2
several JJ B-Entity 3
remote JJ I-Entity O
access NN I-Entity O
Trojan NNP I-Entity O
( FW I-Entity O
RAT FW I-Entity O
) FW I-Entity O
features NNS I-Entity O
, , O O
such JJ O O
as IN O O
capturing VBG B-Action 4
screenshots NNS B-Entity 5
and CC O O
taking VBG B-Action 6
control NN B-Entity 7
of IN I-Entity O
the DT I-Entity O
mouse NN I-Entity O
's POS I-Entity O
point-and-click JJ I-Entity O
functions NNS I-Entity O
. . O O

Regin NNP B-Entity 1
is VBZ O O
also RB O O
configured VBN O O
to TO O O
steal VB B-Action 2
passwords NNS B-Entity 3
, , O O
monitor NN B-Action 4
network NN B-Entity 5
traffic NN I-Entity O
, , O O
and CC O O
gather VB B-Action 6
information NN B-Entity 7
on IN I-Entity O
processes NNS I-Entity O
and CC I-Entity O
memory NN I-Entity O
utilization NN I-Entity O
. . O O

It PRP B-Entity 1
can MD O O
also RB O O
scan VB B-Action 2
for IN B-Modifier 3
deleted JJ B-Entity 4
files NNS I-Entity O
on IN I-Entity O
an DT I-Entity O
infected JJ I-Entity O
computer NN I-Entity O
and CC O O
retrieve VB B-Action 5
them PRP B-Entity 6
. . O O

More RBR O O
advanced JJ O O
payload NN O O
modules NNS O O
designed VBN O O
with IN O O
specific JJ O O
goals NNS O O
in IN O O
mind NN O O
were VBD O O
also RB O O
found VBN O O
in IN O O
our PRP$ O O
investigations NNS O O
. . O O

For IN O O
example NN O O
, , O O
one CD B-Entity 1
module NN I-Entity O
was VBD O O
designed VBN O O
to TO O O
monitor VB B-Action 2
network NN B-Entity 3
traffic NN I-Entity O
to TO I-Entity O
Microsoft NNP I-Entity O
Internet NNP I-Entity O
Information NNP I-Entity O
Services NNPS I-Entity O
( FW I-Entity O
IIS FW I-Entity O
) FW I-Entity O
web NN I-Entity O
servers NNS I-Entity O
, , O O
another DT B-Entity 4
was VBD O O
designed VBN O O
to TO O O
collect VB B-Action 5
administration NN B-Entity 6
traffic NN I-Entity O
for IN I-Entity O
mobile JJ I-Entity O
telephony NN I-Entity O
base NN I-Entity O
station NN I-Entity O
controllers NNS I-Entity O
, , O O
while IN O O
another DT B-Entity 7
was VBD O O
created VBN O O
specifically RB O O
for IN O O
parsing VBG B-Action 8
mail NN B-Entity 9
from IN I-Entity O
Exchange NNP I-Entity O
databases NNS I-Entity O
. . O O

Regin NNP B-Entity 1
goes VBZ O O
to TO O O
some DT O O
lengths NNS O O
to TO O O
hide VB B-Action 2
the DT B-Entity 3
data NNS I-Entity O
it PRP B-Entity 4
is VBZ B-Action 5
stealing VBG I-Action O
. . O O

Valuable NNP B-Entity 1
target NN I-Entity O
data NNS I-Entity O
is VBZ B-Action 2
often RB I-Action O
not RB I-Action O
written VBN I-Action O
to TO B-Modifier 3
disk NN B-Entity 4
. . O O

In IN O O
some DT O O
cases NNS O O
, , O O
Symantec NNP O O
was VBD O O
only RB O O
able JJ O O
to TO O O
retrieve VB O O
the DT O O
threat NN O O
samples NNS O O
but CC O O
not RB O O
the DT O O
files NNS O O
containing VBG O O
stolen VBN O O
data NNS O O
. . O O

Symantec NNP O O
is VBZ O O
aware JJ O O
of IN O O
two CD O O
distinct JJ O O
versions NNS O O
of IN O O
Regin NNP O O
. . O O

Version NN O O
1.0 CD O O
appears VBZ O O
to TO O O
have VB O O
been VBN O O
used VBN O O
from IN O O
at IN O O
least JJS O O
2008 CD O O
to TO O O
2011 CD O O
. . O O

Version NN O O
2.0 CD O O
has VBZ O O
been VBN O O
used VBN O O
from IN O O
2013 CD O O
onwards NNS O O
, , O O
though IN O O
it PRP O O
may MD O O
have VB O O
possibly RB O O
been VBN O O
used VBN O O
earlier RBR O O
. . O O

Version NN O O
1.0 CD O O
appears VBZ O O
to TO O O
have VB O O
been VBN O O
abruptly RB O O
withdrawn VBN O O
from IN O O
circulation NN O O
in IN O O
2011 CD O O
. . O O

Version NN O O
1.0 CD O O
samples NNS O O
found VBN O O
after IN O O
this DT O O
date NN O O
seem VBP O O
to TO O O
have VB O O
been VBN O O
improperly RB O O
removed VBN O O
or CC O O
were VBD O O
no RB O O
longer RB O O
accessible JJ O O
to TO O O
the DT O O
attackers NNS O O
for IN O O
removal NN O O
. . O O

This DT O O
report NN O O
is VBZ O O
based VBN O O
primarily RB O O
on IN O O
our PRP$ O O
analysis NN O O
of IN O O
Regin NN O O
version NN O O
1.0 CD O O
. . O O

We PRP O O
also RB O O
touch VBP O O
on IN O O
version NN O O
2.0 CD O O
, , O O
for IN O O
which WDT O O
we PRP O O
only RB O O
recovered VBD O O
64-bit JJ O O
files NNS O O
. . O O

Symantec NNP O O
has VBZ O O
assigned VBN O O
these DT O O
version NN O O
identifiers NNS O O
as IN O O
they PRP O O
are VBP O O
the DT O O
only JJ O O
two CD O O
versions NNS O O
that WDT O O
have VBP O O
been VBN O O
acquired VBN O O
. . O O

Regin NNP O O
likely RB O O
has VBZ O O
more JJR O O
than IN O O
two CD O O
versions NNS O O
. . O O

There EX O O
may MD O O
be VB O O
versions NNS O O
prior RB O O
to TO O O
1.0 CD O O
and CC O O
versions NNS O O
between IN O O
1.0 CD O O
and CC O O
2.0 CD O O
. . O O

The DT O O
Regin NNP O O
operators NNS O O
do VBP O O
not RB O O
appear VB O O
to TO O O
focus VB O O
on IN O O
any DT O O
specific JJ O O
industry NN O O
sector NN O O
. . O O

Regin NN O O
infections NNS O O
have VBP O O
been VBN O O
observed VBN O O
in IN O O
a DT O O
variety NN O O
of IN O O
organizations NNS O O
, , O O
including VBG O O
private JJ O O
companies NNS O O
, , O O
government NN O O
entities NNS O O
, , O O
and CC O O
research NN O O
institutes NN O O
. . O O

Infections NNS O O
are VBP O O
also RB O O
geographically RB O O
diverse JJ O O
, , O O
having VBG O O
been VBN O O
identified VBN O O
mainly RB O O
in IN O O
10 CD O O
different JJ O O
regions NNS O O
. . O O

The DT O O
infection NN O O
vector NN O O
varies VBZ O O
among IN O O
targets NNS O O
. . O O

A DT O O
reproducible JJ O O
infection NN O O
vector NN O O
is VBZ O O
unconfirmed JJ O O
at IN O O
time NN O O
of IN O O
writing VBG O O
. . O O

Targets NNS O O
may MD O O
be VB O O
tricked VBN O O
into IN O O
visiting VBG O O
spoofed JJ O O
versions NNS O O
of IN O O
well- JJ O O
known JJ O O
websites NNS O O
and CC O O
the DT B-Entity 1
threat NN I-Entity O
may MD O O
be VB B-Action 2
installed VBN I-Action O
through IN B-Modifier 3
a DT B-Entity 4
web NN I-Entity O
browser NN I-Entity O
or CC O O
by IN B-Modifier 5
exploiting VBG B-Entity 6
an DT I-Entity O
application NN I-Entity O
. . O O

On IN O O
one CD O O
computer NN O O
, , O O
log NN O O
files NNS O O
show VBP O O
that IN O O
Regin NNP B-Entity 1
originated VBD B-Action 2
from IN B-Modifier 3
Yahoo NNP B-Entity 4
! . I-Entity O
Instant JJ I-Entity O
Messenger NN I-Entity O
through IN B-Modifier 5
an DT B-Entity 6
unconfirmed JJ I-Entity O
exploit VBP I-Entity O
. . O O

Regin NNP O O
has VBZ O O
a DT O O
six-stage JJ O O
architecture NN O O
. . O O

The DT B-Entity 1
initial JJ I-Entity O
stages NNS I-Entity O
involve VBP B-Action 2
the DT B-Entity 3
installation NN I-Entity O
and CC I-Entity O
configuration NN I-Entity O
of IN I-Entity O
the DT I-Entity O
threat NN I-Entity O
's POS I-Entity O
internal JJ I-Entity O
services NNS I-Entity O
. . O O

The DT O O
later JJ O O
stages NNS O O
bring VBP O O
Regin NNP O O
's POS O O
main JJ O O
payloads NNS O O
into IN O O
play NN O O
. . O O

This DT O O
section NN O O
presents VBZ O O
a DT O O
brief JJ O O
overview NN O O
of IN O O
the DT O O
format NN O O
and CC O O
purpose NN O O
of IN O O
each DT O O
stage NN O O
. . O O

The DT O O
most RBS O O
interesting JJ O O
stages NNS O O
are VBP O O
the DT O O
executables NNS O O
and CC O O
data NNS O O
files NNS O O
stored VBN O O
in IN O O
Stages NNS O O
4 CD O O
and CC O O
5 CD O O
. . O O

The DT O O
initial JJ O O
Stage NN O O
1 CD O O
driver NN O O
is VBZ O O
the DT O O
only RB O O
plainly RB O O
visible JJ O O
code NN O O
on IN O O
the DT O O
computer NN O O
. . O O

All DT B-Entity 1
other JJ I-Entity O
stages NNS I-Entity O
are VBP B-Action 2
stored VBN I-Action O
as IN B-Modifier 3
encrypted JJ B-Entity 4
data NNS I-Entity O
blobs NNS I-Entity O
, , O O
as IN O O
a DT O O
file NN O O
or CC O O
within IN O O
a DT O O
non-traditional JJ O O
file NN O O
storage NN O O
area NN O O
such JJ O O
as IN O O
the DT O O
registry NN O O
, , O O
extended JJ O O
attributes NNS O O
, , O O
or CC O O
raw JJ O O
sectors NNS O O
at IN O O
the DT O O
end NN O O
of IN O O
disk NN O O
. . O O

Symantec NNP O O
Security NNP O O
Response NNP O O
has VBZ O O
not RB O O
obtained VBN O O
the DT O O
Regin NNP O O
dropper NN O O
at IN O O
the DT O O
time NN O O
of IN O O
writing VBG O O
. . O O

Symantec NNP O O
believes VBZ O O
that IN O O
once RB O O
the DT B-Entity 1
dropper NN I-Entity O
is VBZ O O
executed VBN O O
on IN O O
the DT O O
target NN O O
's POS O O
computer NN O O
, , O O
it PRP B-Entity 2
will MD O O
install VB B-Action 3
and CC O O
execute VB B-Action 4
Stage NNP B-Entity 5
1 CD I-Entity O
. . O O

It PRP O O
's VBZ O O
likely JJ O O
that IN O O
Stage NNP B-Entity 1
0 CD I-Entity O
is VBZ O O
responsible JJ O O
for IN O O
setting VBG B-Action 2
up RP I-Action O
various JJ B-Entity 3
extended JJ I-Entity O
attributes NNS I-Entity O
and/or CC I-Entity O
registry NN I-Entity O
keys NNS I-Entity O
and CC I-Entity O
values NNS I-Entity O
that WDT I-Entity O
hold VBP I-Entity O
encoded VBN I-Entity O
versions NNS I-Entity O
of IN I-Entity O
stages NNS I-Entity O
2 CD I-Entity O
, , I-Entity O
3 CD I-Entity O
, , I-Entity O
and CC I-Entity O
potentially RB I-Entity O
stages NNS I-Entity O
4 CD I-Entity O
and CC I-Entity O
onwards NNS I-Entity O
. . O O

The DT O O
dropper NN O O
could MD O O
be VB O O
transient JJ O O
rather RB O O
than IN O O
acting VBG O O
as IN O O
an DT O O
executable JJ O O
file NN O O
and CC O O
may MD O O
possibly RB O O
be VB O O
part NN O O
of IN O O
the DT O O
infection NN O O
vector NN O O
exploit VBP O O
code NN O O
. . O O

Stage NN B-Entity 1
1 CD I-Entity O
is VBZ B-Action 2
the DT B-Entity 3
initial JJ I-Entity O
load NN I-Entity O
point NN I-Entity O
for IN I-Entity O
the DT I-Entity O
threat NN I-Entity O
. . O O

There EX O O
are VBP O O
two CD O O
known JJ O O
Stage NN O O
1 CD O O
file NN O O
names NNS O O
: : O O
These DT O O
are VBP O O
kernel NN B-Entity 1
drivers NNS I-Entity O
that WDT O O
load VBP B-Action 2
and CC I-Action O
execute VBP I-Action O
Stage NNP B-Entity 3
2 CD I-Entity O
. . O O

These DT O O
kernel NN B-Entity 1
drivers NNS I-Entity O
may MD O O
be VB O O
registered VBN O O
as IN O O
a DT O O
system NN O O
service NN O O
or CC O O
may MD O O
have VB O O
an DT O O
associated VBN O O
registry NN O O
key NN O O
to TO O O
load VB B-Action 2
the DT B-Entity 3
driver NN I-Entity O
while IN O O
the DT O O
computer NN O O
is VBZ O O
starting VBG O O
up RP O O
. . O O

Stage NNP B-Entity 1
1 CD I-Entity O
simply RB O O
reads VBZ B-Action 2
and CC I-Action O
executes VBZ I-Action O
Stage NNP B-Entity 3
2 CD I-Entity O
from IN B-Modifier 4
a DT B-Entity 5
set NN I-Entity O
of IN I-Entity O
NTFS NN I-Entity O
extended JJ I-Entity O
attributes NNS I-Entity O
. . O O

If IN O O
no DT O O
extended JJ O O
attributes NNS O O
are VBP O O
found VBN O O
, , O O
Stage NNP B-Entity 1
2 CD I-Entity O
is VBZ B-Action 2
executed VBN I-Action O
from IN B-Modifier 3
a DT B-Entity 4
set NN I-Entity O
of IN I-Entity O
registry NN I-Entity O
keys NNS I-Entity O
. . O O

Stage NN B-Entity 1
2 CD I-Entity O
is VBZ O O
a DT O O
kernel NN B-Entity 2
driver NN I-Entity O
that IN O O
simply JJ O O
extracts NNS B-Action 3
, , I-Action O
installs VBZ I-Action O
and CC I-Action O
runs VBZ I-Action O
Stage NNP B-Entity 4
3 CD I-Entity O
. . O O

Stage NN B-Entity 1
2 CD I-Entity O
is VBZ O O
not RB O O
stored VBN O O
in IN O O
the DT O O
traditional JJ O O
file NN O O
system NN O O
, , O O
but CC O O
is VBZ B-Action 2
encrypted VBN I-Action O
within IN B-Modifier 3
an DT B-Entity 4
extended JJ I-Entity O
attribute NN I-Entity O
or CC I-Entity O
a DT I-Entity O
registry NN I-Entity O
key JJ I-Entity O
blob NN I-Entity O
. . O O

Stage NN B-Entity 1
2 CD I-Entity O
can MD O O
be VB B-Action 2
found VBN I-Action O
encrypted JJ I-Action O
in IN O O
: : O O
This DT B-Entity 3
stage NN I-Entity O
can MD O O
also RB O O
hide VB B-Action 4
running VBG B-Entity 5
instances NNS I-Entity O
of IN I-Entity O
Stage NNP I-Entity O
1 CD I-Entity O
. . O O

Once RB O O
this DT O O
happens VBZ O O
, , O O
there EX O O
are VBP O O
no DT O O
remaining VBG O O
plainly RB O O
visible JJ O O
code NN O O
artifacts NNS O O
. . O O

Similar JJ O O
to TO O O
previous JJ O O
stages NNS O O
, , O O
Stage NNP B-Entity 1
2 CD I-Entity O
finds NNS B-Action 2
and CC I-Action O
loads NNS I-Action O
an DT B-Entity 3
encrypted JJ I-Entity O
version NN I-Entity O
of IN I-Entity O
Stage NNP I-Entity O
3 CD I-Entity O
from IN B-Modifier 4
either DT B-Entity 5
NTFS NNP I-Entity O
extended VBD I-Entity O
attributes NNS I-Entity O
or CC I-Entity O
a DT I-Entity O
registry NN I-Entity O
key JJ I-Entity O
blob NN I-Entity O
. . O O

Stage NN B-Entity 1
2 CD I-Entity O
can MD O O
also RB O O
monitor VB B-Action 2
the DT B-Entity 3
state NN I-Entity O
of IN I-Entity O
the DT I-Entity O
threat NN I-Entity O
. . O O

This DT B-Entity 1
stage NN I-Entity O
drops VBZ B-Action 2
the DT B-Entity 3
file NN I-Entity O
msrdc64.dat NN I-Entity O
, , O O
which WDT O O
appears VBZ O O
to TO O O
always RB O O
be VB O O
512 CD O O
bytes NNS O O
in IN O O
size NN O O
. . O O

The DT O O
first JJ O O
two CD O O
bytes NNS O O
are VBP O O
used VBN O O
and CC O O
the DT O O
remaining VBG O O
bytes NNS O O
are VBP O O
set VBN O O
to TO O O
zero VB O O
. . O O

The DT O O
second JJ O O
byte NN O O
indicates VBZ O O
the DT O O
exclusive JJ O O
maximum NN O O
number NN O O
of IN O O
instances NNS O O
allowed VBN O O
to TO O O
run VB O O
, , O O
which WDT O O
is VBZ O O
set VBN O O
to TO O O
two CD O O
. . O O

This DT O O
means VBZ O O
no RB O O
more JJR O O
than IN O O
one CD O O
instance NN O O
should MD O O
run VB O O
at IN O O
any DT O O
time NN O O
. . O O

The DT O O
first JJ O O
byte NN O O
indicates VBZ O O
how WRB O O
many JJ O O
instances NNS O O
were VBD O O
run VBN O O
or CC O O
attempted VBN O O
to TO O O
run VB O O
. . O O

Therefore RB O O
, , O O
the DT O O
potential JJ O O
combinations NNS O O
for IN O O
the DT O O
first JJ O O
two CD O O
bytes NNS O O
are VBP O O
: : O O
Stage NN O O
3 CD O O
is VBZ O O
a DT O O
kernel NN O O
mode NN O O
DLL NN O O
and CC O O
is VBZ O O
not RB O O
stored VBN O O
in IN O O
the DT O O
traditional JJ O O
file NN O O
system NN O O
. . O O

Instead RB O O
, , O O
this DT B-Entity 1
file NN I-Entity O
is VBZ B-Action 2
encrypted VBN I-Action O
within IN B-Modifier 3
an DT B-Entity 4
extended JJ I-Entity O
attribute NN I-Entity O
or CC I-Entity O
registry NN I-Entity O
key JJ I-Entity O
blob NN I-Entity O
. . O O

Stage NNP O O
3 CD O O
can MD O O
be VB O O
found VBN O O
in IN O O
the DT O O
following JJ O O
locations NNS O O
: : O O
The DT O O
file NN O O
is VBZ O O
six CD O O
to TO O O
seven CD O O
times NNS O O
the DT O O
size NN O O
of IN O O
the DT O O
driver NN O O
in IN O O
Stage NNP O O
2 CD O O
. . O O

In IN O O
addition NN O O
to TO O O
loading VBG B-Action 1
and CC I-Action O
executing VBG I-Action O
Stage NNP B-Entity 2
4 CD I-Entity O
, , O O
Stage NNP B-Entity 3
3 CD I-Entity O
offers VBZ O O
a DT O O
framework NN O O
for IN O O
the DT O O
higher JJR O O
level NN O O
stages NNS O O
. . O O

Stages NNS O O
3 CD O O
and CC O O
above RB O O
are VBP O O
based VBN O O
on IN O O
a DT O O
modular JJ O O
framework NN O O
of IN O O
code NN O O
modules NNS O O
. . O O

These DT O O
modules NNS O O
offer VBP O O
functions NNS O O
through IN O O
a DT O O
private JJ O O
, , O O
custom NN O O
interface NN O O
. . O O

Each DT O O
file NN O O
in IN O O
stages NNS O O
3 CD O O
and CC O O
above RB O O
can MD O O
'' '' O O
export VB O O
'' '' O O
functionality NN O O
to TO O O
other JJ O O
parts NNS O O
of IN O O
Regin NNP O O
. . O O

In IN O O
the DT O O
case NN O O
of IN O O
Stage NNP O O
3 CD O O
, , O O
the DT O O
following JJ O O
primitives NNS O O
are VBP O O
offered VBN O O
: : O O
These DT O O
primitives NNS O O
are VBP O O
provided VBN O O
through IN O O
a DT O O
custom NN O O
export NN O O
methodology NN O O
. . O O

The DT O O
Stage NNP O O
3 CD O O
DLL NNP O O
exports NNS O O
a DT O O
wide JJ O O
range NN O O
of IN O O
functionality NN O O
through IN O O
a DT O O
custom NN O O
export NN O O
methodology NN O O
. . O O

The DT O O
interface NN O O
used VBN O O
to TO O O
export VB O O
functionality NN O O
does VBZ O O
not RB O O
make VB O O
use NN O O
of IN O O
the DT O O
traditional JJ O O
Windows NNP O O
DLL NNP O O
export NN O O
mechanism NN O O
by IN O O
name NN O O
or CC O O
ordinal JJ O O
. . O O

Exported NNP O O
Regin NNP O O
methods NNS O O
are VBP O O
referenced VBN O O
by IN O O
a DT O O
tuple NN O O
consisting VBG O O
of IN O O
a DT O O
major JJ O O
and CC O O
minor JJ O O
number NN O O
. . O O

Stage NNP O O
3 CD O O
exports NNS O O
hundreds NNS O O
of IN O O
methods NNS O O
, , O O
organized VBN O O
into IN O O
12 CD O O
different JJ O O
major JJ O O
groups NNS O O
. . O O

The DT O O
numbers NNS O O
used VBN O O
vary VBP O O
across IN O O
versions NNS O O
. . O O

We PRP O O
acquired VBD O O
artifacts NNS O O
using VBG O O
two CD O O
different JJ O O
numbering NN O O
schemes NNS O O
. . O O

Table NNP O O
2 CD O O
is VBZ O O
an DT O O
example NN O O
listing NN O O
. . O O

With IN O O
Regin NNP O O
's POS O O
modular JJ O O
nature NN O O
, , O O
Stage NNP O O
4 CD O O
kernel NN O O
modules NNS O O
and CC O O
Stage NNP O O
5 CD O O
user NN O O
modules NNS O O
( FW O O
payloads FW O O
) NN O O
can MD O O
provide VB O O
functionality NN O O
and CC O O
export NN O O
routines NNS O O
using VBG O O
the DT O O
same JJ O O
major JJ O O
and CC O O
minor JJ O O
numbering NN O O
scheme NN O O
. . O O

The DT B-Entity 1
files NNS I-Entity O
for IN I-Entity O
Stage NNP I-Entity O
4 CD I-Entity O
, , O O
which WDT O O
are VBP B-Action 2
loaded VBN I-Action O
by IN O O
Stage NNP B-Entity 3
3 CD I-Entity O
, , O O
consist VBP O O
of IN O O
a DT O O
user-mode JJ O O
orchestrator NN O O
and CC O O
multiple JJ O O
kernel NN O O
payload NN O O
modules NNS O O
. . O O

They PRP O O
are VBP O O
stored VBN O O
in IN O O
two CD O O
EVFS NN O O
containers NNS O O
as IN O O
files NNS O O
: : O O
• CD O O
% NN O O
System NN O O
% NN O O
\config\SystemAudit.Evt NN O O
: : O O
Contains VBZ O O
Stage NNP O O
4 CD O O
kernel NN O O
drivers NNS O O
, , O O
which WDT O O
constitute VBP O O
the DT O O
kernel NN O O
mode NN O O
part NN O O
of IN O O
Regin NNP O O
's POS O O
payload NN O O
. . O O

• CD O O
% NN O O
System NN O O
% NN O O
\config\SecurityAudit.Evt NN O O
: : O O
Contains VBZ O O
a DT O O
user NN O O
mode NN O O
version NN O O
of IN O O
Stage NNP O O
3 CD O O
. . O O

The DT O O
files NNS O O
are VBP O O
injected VBN O O
into IN O O
services.exe NN O O
. . O O

When WRB O O
the DT B-Entity 1
attackers NNS I-Entity O
who WP I-Entity O
operated VBD I-Entity O
Regin NNP I-Entity O
cleaned VBD B-Action 2
up RB I-Action O
compromised VBN B-Entity 3
computers NNS I-Entity O
once IN O O
they PRP O O
were VBD O O
finished VBN O O
with IN O O
them PRP O O
, , O O
they PRP O O
often RB O O
failed VBD O O
to TO O O
remove VB O O
Stage NNP O O
4 CD O O
and CC O O
5 CD O O
artifacts NNS O O
from IN O O
the DT O O
system NN O O
. . O O

Stage NNP O O
4 CD O O
also RB O O
uses VBZ O O
the DT O O
same JJ O O
export NN O O
methodology NN O O
described VBN O O
in IN O O
Stage NNP O O
3 CD O O
. . O O

Stage NNP O O
5 CD O O
consists VBZ O O
of IN O O
the DT O O
main JJ O O
Regin NNP O O
payload NN O O
functionality NN O O
. . O O

The DT B-Entity 1
files NNS I-Entity O
for IN I-Entity O
Stage NNP I-Entity O
5 CD I-Entity O
are VBP B-Action 2
injected VBN I-Action O
into IN B-Modifier 3
services.exe NN B-Entity 4
by IN O O
Stage NNP B-Entity 5
4 CD I-Entity O
. . O O

Stage NNP O O
5 CD O O
files NNS O O
are VBP O O
EVFS NN O O
containers NNS O O
containing VBG O O
other JJ O O
files NNS O O
: : O O
Regin NNP O O
's POS O O
payload NN O O
involves VBZ O O
the DT O O
DLLs NNS O O
contained VBN O O
in IN O O
the DT O O
SystemLog.evt NN O O
EVFS NN O O
container NN O O
. . O O

The DT O O
payload NN O O
functionality NN O O
differs VBZ O O
depending VBG O O
on IN O O
the DT O O
targeted VBN O O
computer NN O O
. . O O

Custom NNP O O
payload NN O O
files NNS O O
will MD O O
likely RB O O
be VB O O
delivered VBN O O
for IN O O
each DT O O
specific JJ O O
environment NN O O
. . O O

Example NN O O
payload NN O O
functionality NN O O
seen VBN O O
to TO O O
date NN O O
includes VBZ O O
: : O O
Regin NN B-Entity 1
stores NNS B-Action 2
data NNS B-Entity 3
files NNS I-Entity O
and CC I-Entity O
payloads NNS I-Entity O
on IN B-Modifier 4
disk NN B-Entity 5
in IN B-Modifier 6
encrypted JJ B-Entity 7
virtual JJ I-Entity O
file NN I-Entity O
system NN I-Entity O
files NNS I-Entity O
. . O O

Such JJ O O
files NNS O O
are VBP O O
accessed VBN O O
by IN O O
the DT O O
major JJ O O
routines NNS O O
3Dh NN O O
. . O O

Files NNS B-Entity 1
stored VBN I-Entity O
inside IN I-Entity O
EVFS NN I-Entity O
containers NNS I-Entity O
are VBP B-Action 2
encrypted VBN I-Action O
with IN B-Modifier 3
a DT B-Entity 4
variant NN I-Entity O
of IN I-Entity O
RC5 NN I-Entity O
, , O O
using VBG B-Modifier 5
64-bit JJ B-Entity 6
blocks NNS I-Entity O
and CC I-Entity O
20 CD I-Entity O
rounds NNS I-Entity O
. . O O

The DT B-Entity 1
encryption NN I-Entity O
mode NN I-Entity O
is VBZ B-Action 2
reverse JJ B-Entity 3
cipher NN I-Entity O
feedback NN I-Entity O
( FW I-Entity O
CFB FW I-Entity O
) FW I-Entity O
. . O O

Known VBN O O
extensions NNS O O
for IN O O
EVFS NN O O
containers NNS O O
are VBP O O
*.evt NN O O
and CC O O
*.imd NN O O
. . O O

The DT O O
structure NN O O
of IN O O
a DT O O
container NN O O
is VBZ O O
similar JJ O O
to TO O O
the DT O O
FAT NNP O O
file NN O O
system NN O O
. . O O

One CD O O
major JJ O O
difference NN O O
is VBZ O O
that IN O O
files NNS O O
do VBP O O
not RB O O
have VB O O
a DT O O
name NN O O
; : O O
instead RB O O
, , O O
they PRP O O
're VBP O O
identified VBN O O
using VBG O O
a DT O O
binary JJ O O
tag NN O O
. . O O

The DT O O
tag NN O O
itself PRP O O
is VBZ O O
the DT O O
concatenation NN O O
of IN O O
a DT O O
major JJ O O
number NN O O
and CC O O
a DT O O
minor JJ O O
number NN O O
. . O O

The DT O O
major JJ O O
number NN O O
typically RB O O
indicates VBZ O O
the DT O O
major JJ O O
function NN O O
group NN O O
that WDT O O
will MD O O
handle VB O O
the DT O O
file NN O O
. . O O

A DT O O
container NN O O
starts VBZ O O
with IN O O
the DT O O
header NN O O
in IN O O
Table NNP O O
3 CD O O
( NN O O
little-endian JJ O O
ordering VBG O O
) NN O O
. . O O

The DT O O
header NN O O
is VBZ O O
followed VBN O O
by IN O O
the DT O O
file NN O O
entry NN O O
table NN O O
( NNP O O
Table NNP O O
4 CD O O
) NN O O
. . O O

Each DT O O
file NN O O
entry NN O O
is VBZ O O
13h+taglen CD O O
bytes NNS O O
long RB O O
. . O O

The DT O O
sectors NNS O O
follow VBP O O
( NNP O O
Table NNP O O
5 CD O O
) NN O O
. . O O

A DT O O
sector NN O O
of IN O O
sectsize FW O O
bytes FW O O
starts VBZ O O
with IN O O
a DT O O
DWORD NN O O
pointing VBG O O
to TO O O
the DT O O
next JJ O O
sector NN O O
( NN O O
if IN O O
the DT O O
file NN O O
does VBZ O O
not RB O O
fit VB O O
within IN O O
single JJ O O
sector NN O O
) NN O O
, , O O
followed VBN O O
by IN O O
sectsize-4 NN O O
bytes NNS O O
of IN O O
payload NN O O
data NNS O O
. . O O

As IN O O
explained VBN O O
above RB O O
, , O O
the DT B-Entity 1
files NNS I-Entity O
are VBP B-Action 2
encrypted VBN I-Action O
. . O O

Other JJ O O
layers NNS O O
of IN O O
encryption NN O O
and CC O O
compression NN O O
may MD O O
also RB O O
be VB O O
in IN O O
place NN O O
, , O O
although IN O O
those DT O O
would MD O O
be VB O O
handled VBN O O
by IN O O
higher JJR O O
level NN O O
components NNS O O
. . O O

Regin NNP B-Entity 1
's POS I-Entity O
C NNP I-Entity O
& CC I-Entity O
C NNP I-Entity O
operations NNS I-Entity O
are VBP B-Action 2
extensive JJ B-Entity 3
. . O O

These DT O O
backchannel JJ B-Entity 1
operations NNS I-Entity O
are VBP B-Action 2
bidirectional JJ B-Entity 3
, , O O
which WDT O O
means VBZ O O
either CC O O
the DT B-Entity 4
attackers NNS I-Entity O
can MD O O
initiate VB B-Action 5
communications NNS B-Entity 6
with IN B-Modifier 7
compromised VBN B-Entity 8
computers NNS I-Entity O
on IN B-Modifier 9
the DT B-Entity 10
border NN I-Entity O
network NN I-Entity O
or CC O O
the DT B-Entity 11
compromised VBN I-Entity O
computers NNS I-Entity O
can MD O O
initiate VB B-Action 12
communications NNS B-Entity 13
with IN B-Modifier 14
the DT B-Entity 15
attacker NN I-Entity O
. . O O

Furthermore RB O O
, , O O
compromised VBN B-Entity 1
computers NNS I-Entity O
can MD O O
serve VB B-Action 2
as IN B-Modifier 3
a DT B-Entity 4
proxy NN I-Entity O
for IN I-Entity O
other JJ I-Entity O
infections NNS I-Entity O
and CC O O
command NN B-Entity 5
and CC I-Entity O
control NN I-Entity O
can MD O O
also RB O O
happen VB B-Action 6
in IN B-Modifier 7
a DT B-Entity 8
peer-to-peer JJ I-Entity O
fashion NN I-Entity O
. . O O

All DT B-Entity 1
communications NNS I-Entity O
are VBP B-Action 2
strongly RB I-Action O
encrypted VBN I-Action O
and CC O O
can MD O O
happen VB B-Action 3
in IN B-Modifier 4
a DT B-Entity 5
two-stage JJ I-Entity O
fashion NN I-Entity O
where WRB O O
the DT B-Entity 6
attacker NN I-Entity O
may MD O O
contact VB B-Action 7
a DT B-Entity 8
compromised VBN I-Entity O
computer NN I-Entity O
using VBG B-Modifier 9
one CD B-Entity 10
channel NN I-Entity O
to TO O O
instruct VB B-Action 11
it PRP B-Entity 12
to TO O O
begin VB B-Action 13
communications NNS B-Entity 14
on IN B-Modifier 15
a DT B-Entity 16
different JJ I-Entity O
channel NN I-Entity O
. . O O

Four CD O O
transport NN O O
protocols NNS O O
are VBP O O
available JJ O O
for IN O O
C NNP O O
& CC O O
C NNP O O
: : O O
• NNP O O
ICMP NNP O O
: : O O
Payload NN B-Entity 1
information NN I-Entity O
can MD O O
be VB B-Action 2
encoded VBN I-Action O
and CC I-Action O
embedded VBN I-Action O
in IN B-Modifier 3
lieu NN I-Modifier O
of IN I-Modifier O
legitimate JJ B-Entity 4
ICMP/ping NN I-Entity O
data NNS I-Entity O
. . O O

The DT O O
string NN O O
'shit NN O O
' '' O O
is VBZ O O
scattered VBN O O
in IN O O
the DT O O
packet NN O O
for IN O O
data NNS O O
validation NN O O
. . O O

In IN O O
addition NN O O
, , O O
CRC NN O O
checks NNS O O
use VBP O O
the DT O O
seed NN O O
'31337 NN O O
' '' O O
. . O O

• NNP O O
HTTP NNP O O
: : O O
Payload NN B-Entity 1
information NN I-Entity O
can MD O O
be VB B-Action 2
encoded VBN I-Action O
and CC I-Action O
embedded VBN I-Action O
within IN B-Modifier 3
cookie NN B-Entity 4
data NNS I-Entity O
under IN O O
the DT O O
names NNS O O
SESSID NNP O O
, , O O
SMSWAP NNP O O
, , O O
TW NNP O O
, , O O
WINKER NNP O O
, , O O
TIMESET NNP O O
, , O O
LASTVISIT NNP O O
, , O O
AST.NETSessionId NNP O O
, , O O
PHPSESSID NNP O O
, , O O
or CC O O
phpAdsd NN O O
. . O O

This DT O O
information NN O O
can MD O O
be VB O O
combined VBN O O
with IN O O
another DT O O
cookie NN O O
for IN O O
validation NN O O
under IN O O
the DT O O
names NNS O O
USERIDTK NNP O O
, , O O
UID NNP O O
, , O O
GRID NNP O O
, , O O
UID=PREF=ID NNP O O
, , O O
TM NNP O O
, , O O
utma NNP O O
, , O O
LM NNP O O
, , O O
TMARK NNP O O
, , O O
VERSION NNP O O
, , O O
or CC O O
CURRENT NNP O O
. . O O

The DT B-Entity 1
C NN I-Entity O
& CC I-Entity O
C NN I-Entity O
operations NNS I-Entity O
are VBP B-Action 2
undertaken VBN I-Action O
by IN O O
various JJ B-Entity 3
modules NNS I-Entity O
, , O O
including VBG O O
major JJ O O
groups NNS O O
C373h NN O O
, , O O
19h NN O O
, , O O
9 CD O O
, , O O
as RB O O
well RB O O
as IN O O
Stage NNP O O
5 CD O O
payloads NNS O O
, , O O
such JJ O O
as IN O O
C375h NN O O
and CC O O
1Bh NN O O
. . O O

Regin FW B-Entity 1
logs FW B-Action 2
data NNS B-Entity 3
to TO B-Modifier 4
the DT B-Entity 5
ApplicationLog.dat NN I-Entity O
file NN I-Entity O
. . O O

This DT O O
file NN O O
is VBZ O O
not RB O O
an DT O O
encrypted JJ O O
container NN O O
, , O O
but CC O O
it PRP B-Entity 1
is VBZ B-Action 2
encrypted VBN I-Action O
and CC I-Action O
compressed VBN I-Action O
. . O O

Regin NN B-Entity 1
can MD O O
be VB B-Action 2
distributed VBN I-Action O
with IN B-Modifier 3
various JJ B-Entity 4
payload NN I-Entity O
modules NNS I-Entity O
or CC O O
receive VB B-Action 5
payload NN B-Entity 6
modules NNS I-Entity O
after IN B-Modifier 7
infection NN B-Entity 8
. . O O

The DT O O
extensible JJ O O
nature NN O O
of IN O O
Regin NNP O O
and CC O O
its PRP$ O O
custom NN O O
payloads NNS O O
indicate VBP O O
that IN O O
many JJ O O
additional JJ O O
payloads NNS O O
are VBP O O
likely JJ O O
to TO O O
exist VB O O
in IN O O
order NN O O
to TO O O
enhance VB O O
Regin NNP O O
's POS O O
capabilities NNS O O
. . O O

Furthermore RB O O
, , O O
we PRP O O
have VBP O O
found VBN O O
data NNS O O
files NNS O O
accompanying VBG O O
payload NN O O
modules NNS O O
that WDT O O
have VBP O O
not RB O O
been VBN O O
recovered VBN O O
. . O O

The DT O O
following VBG O O
table NN O O
describes VBZ O O
the DT O O
Stage NNP O O
4 CD O O
kernel NN O O
payload NN O O
modules NNS O O
and CC O O
Stage NNP O O
5 CD O O
user NN O O
mode NN O O
payload NN O O
modules NNS O O
, , O O
which WDT O O
we PRP O O
have VBP O O
seen VBN O O
several JJ O O
variants NNS O O
of IN O O
Regin NN O O
use NN O O
. . O O

The DT B-Entity 1
IIS NN I-Entity O
web NN I-Entity O
server NN I-Entity O
log NN I-Entity O
stealing NN B-Action 2
module NN B-Entity 3
, , O O
27E9h NN B-Entity 4
, , O O
is VBZ O O
an DT O O
example NN O O
of IN O O
a DT B-Entity 5
payload NN I-Entity O
module NN I-Entity O
that WDT O O
was VBD B-Action 6
installed VBN I-Action O
after IN B-Modifier 7
the DT B-Entity 8
initial JJ I-Entity O
infection NN I-Entity O
and CC O O
was VBD O O
specifically RB O O
deployed VBN O O
for IN O O
a DT O O
particular JJ O O
target NN O O
. . O O

Only RB O O
a DT O O
small JJ O O
amount NN O O
of IN O O
the DT O O
64-bit JJ O O
Regin NNP O O
files NNS O O
have VBP O O
been VBN O O
recovered VBN O O
. . O O

These DT O O
samples NNS O O
may MD O O
represent VB O O
version NN O O
2.0 CD O O
or CC O O
their PRP$ O O
differences NNS O O
may MD O O
possibly RB O O
be VB O O
solely RB O O
specific JJ O O
to TO O O
64-bit JJ O O
versions NNS O O
of IN O O
Regin NNP O O
. . O O

We PRP O O
also RB O O
recovered VBD O O
files NNS O O
from IN O O
infected JJ O O
computers NNS O O
that WDT O O
may MD O O
or CC O O
may MD O O
not RB O O
be VB O O
associated VBN O O
with IN O O
64-bit JJ O O
Regin NN O O
, , O O
including VBG O O
several JJ O O
variants NNS O O
of IN O O
svcsstat.exe NN B-Entity 1
, , O O
a DT B-Entity 2
file NN I-Entity O
that WDT O O
aims VBZ O O
to TO O O
retrieve VB B-Action 3
binary JJ B-Entity 4
data NNS I-Entity O
over IN B-Modifier 5
pipes NNS B-Entity 6
or CC O O
sockets NNS B-Entity 7
and CC O O
execute VB B-Action 8
the DT B-Entity 9
data NNS I-Entity O
. . O O

The DT O O
recovered JJ O O
files NNS O O
do VBP O O
not RB O O
appear VB O O
to TO O O
fundamentally RB O O
vary VB O O
from IN O O
their PRP$ O O
32-bit JJ O O
counterparts NNS O O
, , O O
apart RB O O
from IN O O
a DT O O
few JJ O O
noteworthy JJ O O
differences NNS O O
. . O O

The DT O O
32-bit JJ O O
and CC O O
64-bit JJ O O
versions NNS O O
of IN O O
Regin NNP O O
use VBP O O
different JJ O O
file NN O O
names NNS O O
. . O O

These DT O O
differences NNS O O
are VBP O O
shown VBN O O
in IN O O
the DT O O
first JJ O O
section NN O O
of IN O O
this DT O O
paper NN O O
as RB O O
well RB O O
as IN O O
in IN O O
the DT O O
appendix NN O O
. . O O

Most RBS O O
importantly RB O O
, , O O
in IN O O
the DT O O
64-bit JJ O O
version NN O O
of IN O O
Regin NNP O O
, , O O
the DT O O
names NNS O O
of IN O O
containers NNS O O
are VBP O O
changed VBN O O
: : O O
The DT O O
64-bit JJ O O
version NN O O
of IN O O
Regin NNP O O
's POS O O
Stage NNP O O
1 CD O O
( CD O O
wshnetc.dll NN O O
) NN O O
is VBZ O O
no DT O O
longer RBR O O
a DT O O
kernel NN O O
mode NN O O
driver NN O O
, , O O
as IN O O
drivers NNS O O
under IN O O
64-bit JJ O O
Windows NNP O O
must MD O O
be VB O O
signed VBN O O
. . O O

Instead RB O O
, , O O
Stage NNP B-Entity 1
1 CD I-Entity O
is VBZ O O
a DT O O
user NN O O
mode NN O O
DLL NNP O O
loaded VBD B-Action 2
as IN B-Modifier 3
a DT B-Entity 4
Winsock NNP I-Entity O
helper NN I-Entity O
when WRB B-Modifier 5
the DT B-Entity 6
computer NN I-Entity O
is VBZ I-Entity O
starting VBG I-Entity O
up RP I-Entity O
. . O O

Rather NNP O O
than IN O O
loading VBG O O
Stage NNP O O
2 CD O O
from IN O O
an DT O O
NTFS NN O O
extended JJ O O
attribute NN O O
, , O O
Stage NN B-Entity 1
1 CD I-Entity O
looks VBZ B-Action 2
for IN B-Modifier 3
the DT B-Entity 4
last JJ I-Entity O
partition NN I-Entity O
( NN I-Entity O
in IN I-Entity O
terms NNS I-Entity O
of IN I-Entity O
physical JJ I-Entity O
location NN I-Entity O
) NN I-Entity O
on IN I-Entity O
disk NN I-Entity O
and CC O O
searches NNS B-Action 5
for IN B-Modifier 6
the DT B-Entity 7
payload NN I-Entity O
in IN B-Modifier 8
the DT B-Entity 9
raw JJ I-Entity O
sectors NNS I-Entity O
in IN I-Entity O
this DT I-Entity O
area NN I-Entity O
of IN I-Entity O
the DT I-Entity O
disk NN I-Entity O
. . O O

The DT O O
64-bit JJ O O
Regin NNP O O
's POS O O
Stage NNP O O
3 CD O O
has VBZ O O
not RB O O
been VBN O O
recovered VBN O O
. . O O

We PRP O O
believe VBP O O
that IN O O
it PRP O O
may MD O O
not RB O O
exist VB O O
, , O O
as IN O O
the DT O O
32-bit JJ O O
version NN O O
is VBZ O O
a DT O O
driver NN O O
. . O O

Stage NNP O O
4 CD O O
is VBZ O O
an DT O O
orchestrator NN O O
just RB O O
like IN O O
its PRP$ O O
32-bit JJ O O
counterpart NN O O
and CC O O
it PRP O O
uses VBZ O O
the DT O O
same JJ O O
major JJ O O
and CC O O
minor JJ O O
values NNS O O
to TO O O
export VB O O
functionality NN O O
. . O O

No NNP O O
Stage NNP O O
5 CD O O
payload NN O O
modules NNS O O
have VBP O O
been VBN O O
recovered VBN O O
. . O O

Regin NNP B-Entity 1
is VBZ O O
a DT O O
highly-complex JJ O O
threat NN O O
which WDT O O
has VBZ O O
been VBN B-Action 2
used VBN I-Action O
for IN B-Modifier 3
large-scale JJ B-Entity 4
data NNS I-Entity O
collection NN I-Entity O
or CC I-Entity O
intelligence NN I-Entity O
gathering NN I-Entity O
campaigns NNS I-Entity O
. . O O

The DT O O
development NN O O
and CC O O
operation NN O O
of IN O O
this DT O O
threat NN O O
would MD O O
have VB O O
required VBN O O
a DT O O
significant JJ O O
investment NN O O
of IN O O
time NN O O
and CC O O
resources NNS O O
. . O O

Threats NNS O O
of IN O O
this DT O O
nature NN O O
are VBP O O
rare JJ O O
and CC O O
are VBP O O
only RB O O
comparable JJ O O
to TO O O
the DT O O
Stuxnet/Duqu NN O O
family NN O O
of IN O O
malware NN O O
. . O O

The DT O O
discovery NN O O
of IN O O
Regin NNP O O
serves VBZ O O
to TO O O
highlight VB O O
how WRB O O
significant JJ O O
investments NNS O O
continue VBP O O
to TO O O
be VB O O
made VBN O O
into IN O O
the DT O O
development NN O O
of IN O O
tools NNS O O
for IN O O
use NN O O
in IN O O
intelligence NN O O
gathering NN O O
. . O O

Many JJ O O
components NNS O O
of IN O O
Regin NNP O O
have VBP O O
still RB O O
gone VBN O O
undiscovered JJ O O
and CC O O
additional JJ O O
functionality NN O O
and CC O O
versions NNS O O
may MD O O
exist VB O O
. . O O

Symantec NNP O O
and CC O O
Norton NNP O O
products NNS O O
detect VBP O O
this DT O O
threat NN O O
as IN O O
Backdoor.Regin NN O O
. . O O

Regin NNP O O
's POS O O
data NNS O O
files NNS O O
are VBP O O
classified VBN O O
as IN O O
Stage NNP O O
5 CD O O
components NNS O O
and CC O O
are VBP O O
contained VBN O O
in IN O O
an DT O O
EVFS NN O O
container NN O O
. . O O

As IN O O
the DT O O
data NNS O O
files NNS O O
are VBP O O
stored VBN O O
in IN O O
a DT O O
container NN O O
, , O O
they PRP O O
do VBP O O
not RB O O
have VB O O
names NNS O O
. . O O

Just RB O O
like IN O O
Stage NNP O O
5 CD O O
modules NNS O O
, , O O
they PRP O O
are VBP O O
referenced VBN O O
by IN O O
their PRP$ O O
filetag NN O O
, , O O
which WDT O O
is VBZ O O
the DT O O
aggregation NN O O
of IN O O
the DT O O
major JJ O O
and CC O O
minor JJ O O
identifiers NNS O O
. . O O

The DT O O
major JJ O O
identifier NN O O
indicates VBZ O O
which WDT O O
major JJ O O
routine JJ O O
group NN O O
likely RB O O
handles VBZ O O
or CC O O
creates VBZ O O
the DT O O
file NN O O
. . O O

Not RB O O
all DT O O
data NNS O O
files NNS O O
have VBP O O
been VBN O O
recovered VBN O O
, , O O
so IN O O
the DT O O
information NN O O
remains VBZ O O
incomplete JJ O O
. . O O

Data NNP O O
files NNS O O
associated VBN O O
with IN O O
Stage NNP O O
4 CD O O
kernel NN O O
modules NNS O O
have VBP O O
not RB O O
been VBN O O
recovered VBN O O
Table NNP O O
8 CD O O
lists NNS O O
recovered VBD O O
data NNS O O
files NNS O O
used VBN O O
by IN O O
Stage NNP O O
5 CD O O
modules NNS O O
. . O O

The DT O O
associated VBN O O
modules NNS O O
that WDT O O
supposedly RB O O
manipulate VBP O O
those DT O O
data NNS O O
files NNS O O
were VBD O O
not RB O O
recovered VBN O O
. . O O

The DT O O
following JJ O O
details NNS O O
can MD O O
be VB O O
used VBN O O
to TO O O
help VB O O
determine VB O O
whether IN O O
you PRP O O
have VBP O O
been VBN O O
impacted VBN O O
by IN O O
this DT O O
threat NN O O
. . O O

