Complex NN O O
malware NN O O
known VBN O O
as IN O O
Regin NN O O
is VBZ O O
the DT O O
suspected JJ O O
technology NN O O
behind IN O O
sophisticated JJ O O
cyberattacks NNS O O
conducted VBN O O
by IN O O
U.S. NNP O O
and CC O O
British JJ O O
intelligence NN O O
agencies NNS O O
on IN O O
the DT O O
European NNP O O
Union NNP O O
and CC O O
a DT O O
Belgian JJ O O
telecommunications NN O O
company NN O O
, , O O
according VBG O O
to TO O O
security NN O O
industry NN O O
sources NNS O O
and CC O O
technical JJ O O
analysis NN O O
conducted VBN O O
by IN O O
The DT O O
Intercept NNP O O
. . O O

Regin NNP B-Entity 1
was VBD O O
found VBN O O
on IN O O
infected JJ O O
internal JJ O O
computer NN O O
systems NNS O O
and CC O O
email NN O O
servers NNS O O
at IN O O
Belgacom NNP O O
, , O O
a DT O O
partly RB O O
state-owned JJ O O
Belgian JJ O O
phone NN O O
and CC O O
internet NN O O
provider NN O O
, , O O
following VBG O O
reports NNS O O
last JJ O O
year NN O O
that IN O O
the DT O O
company NN O O
was VBD O O
targeted VBN O O
in IN O O
a DT O O
top-secret JJ O O
surveillance NN O O
operation NN O O
carried VBD O O
out RP O O
by IN O O
British JJ O O
spy NN O O
agency NN O O
Government NNP O O
Communications NNP O O
Headquarters NN O O
, , O O
industry NN O O
sources NNS O O
told VBD O O
The NNP O O
Intercept NNP O O
. . O O

The DT B-Entity 1
malware NN I-Entity O
, , O O
which WDT O O
steals VBZ B-Action 2
data NNS B-Entity 3
from IN B-Modifier 4
infected JJ B-Entity 5
systems NNS I-Entity O
and CC O O
disguises NNS B-Action 6
itself PRP B-Entity 7
as IN B-Modifier 8
legitimate JJ B-Entity 9
Microsoft NNP I-Entity O
software NN I-Entity O
, , O O
has VBZ O O
also RB O O
been VBN O O
identified VBN O O
on IN O O
the DT O O
same JJ O O
European NNP O O
Union NNP O O
computer NN O O
systems NNS O O
that WDT O O
were VBD O O
targeted VBN O O
for IN O O
surveillance NN O O
by IN O O
the DT O O
National NNP O O
Security NNP O O
Agency NNP O O
. . O O

The DT O O
hacking NN O O
operations NNS O O
against IN O O
Belgacom NNP O O
and CC O O
the DT O O
European NNP O O
Union NNP O O
were VBD O O
first RB O O
revealed VBN O O
last JJ O O
year NN O O
through IN O O
documents NNS O O
leaked VBN O O
by IN O O
NSA NNP O O
whistleblower NN O O
Edward NNP O O
Snowden NNP O O
. . O O

The DT O O
specific JJ O O
malware NN O O
used VBN O O
in IN O O
the DT O O
attacks NN O O
has VBZ O O
never RB O O
been VBN O O
disclosed VBN O O
, , O O
however RB O O
. . O O

The DT O O
Regin FW O O
malware FW O O
, , O O
whose WP$ O O
existence NN O O
was VBD O O
first RB O O
reported VBN O O
by IN O O
the DT O O
security NN O O
firm NN O O
Symantec NNP O O
on IN O O
Sunday NNP O O
, , O O
is VBZ O O
among IN O O
the DT O O
most RBS O O
sophisticated JJ O O
ever RB O O
discovered VBN O O
by IN O O
researchers NNS O O
. . O O

Symantec NNP O O
compared VBD O O
Regin NNP O O
to TO O O
Stuxnet NNP O O
, , O O
a DT O O
state-sponsored JJ O O
malware NN O O
program NN O O
developed VBN O O
by IN O O
the DT O O
U.S. NNP O O
and CC O O
Israel NNP O O
to TO O O
sabotage VB O O
computers NNS O O
at IN O O
an DT O O
Iranian JJ O O
nuclear JJ O O
facility NN O O
. . O O

Sources NNS O O
familiar JJ O O
with IN O O
internal JJ O O
investigations NNS O O
at IN O O
Belgacom NNP O O
and CC O O
the DT O O
European NNP O O
Union NNP O O
have VBP O O
confirmed VBN O O
to TO O O
The DT O O
Intercept NNP O O
that IN O O
the DT O O
Regin NNP O O
malware NN O O
was VBD O O
found VBN O O
on IN O O
their PRP$ O O
systems NNS O O
after IN O O
they PRP O O
were VBD O O
compromised VBN O O
, , O O
linking VBG O O
the DT O O
spy NN O O
tool NN O O
to TO O O
the DT O O
secret JJ O O
GCHQ NNP O O
and CC O O
NSA NNP O O
operations NNS O O
. . O O

Ronald NNP O O
Prins NNP O O
, , O O
a DT O O
security NN O O
expert NN O O
whose WP$ O O
company NN O O
Fox NNP O O
IT NNP O O
was VBD O O
hired VBN O O
to TO O O
remove VB O O
the DT O O
malware NN O O
from IN O O
Belgacom NNP O O
's POS O O
networks NNS O O
, , O O
told VBD O O
The DT O O
Intercept NNP O O
that IN O O
it PRP O O
was VBD O O
'' '' O O
the DT O O
most RBS O O
sophisticated JJ O O
malware NN O O
'' '' O O
he PRP O O
had VBD O O
ever RB O O
studied VBN O O
. . O O

'' '' O O
Having VBG O O
analyzed VBN O O
this DT O O
malware NN O O
and CC O O
looked VBD O O
at IN O O
the DT O O
[ NN O O
previously RB O O
published VBN O O
] NNP O O
Snowden NNP O O
documents NNS O O
, , O O
'' '' O O
Prins NNP O O
said VBD O O
, , O O
'' '' O O
I PRP O O
'm VBP O O
convinced JJ O O
Regin NNP O O
is VBZ O O
used VBN O O
by IN O O
British JJ O O
and CC O O
American JJ O O
intelligence NN O O
services NNS O O
. . O O

'' '' O O
A DT O O
spokesman NN O O
for IN O O
Belgacom NNP O O
declined VBD O O
to TO O O
comment VB O O
specifically RB O O
about IN O O
the DT O O
Regin NNP O O
revelations NNS O O
, , O O
but CC O O
said VBD O O
that IN O O
the DT O O
company NN O O
had VBD O O
shared VBN O O
'' '' O O
every DT O O
element NN O O
about IN O O
the DT O O
attack NN O O
'' '' O O
with IN O O
a DT O O
federal JJ O O
prosecutor NN O O
in IN O O
Belgium NNP O O
who WP O O
is VBZ O O
conducting VBG O O
a DT O O
criminal JJ O O
investigation NN O O
into IN O O
the DT O O
intrusion NN O O
. . O O

'' '' O O
It PRP O O
's VBZ O O
impossible JJ O O
for IN O O
us PRP O O
to TO O O
comment VB O O
on IN O O
this DT O O
, , O O
'' '' O O
said VBD O O
Jan NNP O O
Margot NNP O O
, , O O
a DT O O
spokesman NN O O
for IN O O
Belgacom NNP O O
. . O O

'' '' O O
It PRP O O
's VBZ O O
always RB O O
been VBN O O
clear JJ O O
to TO O O
us PRP O O
the DT O O
malware NN O O
was VBD O O
highly RB O O
sophisticated JJ O O
, , O O
but CC O O
ever RB O O
since IN O O
the DT O O
clean-up JJ O O
this DT O O
whole JJ O O
story NN O O
belongs VBZ O O
to TO O O
the DT O O
past NN O O
for IN O O
us PRP O O
. . O O

'' '' O O
In IN O O
a DT O O
hacking NN O O
mission NN O O
codenamed VBD O O
Operation NNP O O
Socialist NNP O O
, , O O
GCHQ NNP B-Entity 1
gained VBD B-Action 2
access NN B-Entity 3
to TO I-Entity O
Belgacom NNP I-Entity O
's POS I-Entity O
internal JJ I-Entity O
systems NNS I-Entity O
in IN O O
2010 CD O O
by IN O O
targeting VBG O O
engineers NNS O O
at IN O O
the DT O O
company NN O O
. . O O

The DT O O
agency NN O O
secretly RB O O
installed VBD O O
so-called JJ O O
malware NN O O
'' '' O O
implants NNS O O
'' '' O O
on IN O O
the DT O O
employees NNS O O
' POS O O
computers NNS O O
by IN O O
sending VBG O O
their PRP$ O O
internet NN O O
connection NN O O
to TO O O
a DT O O
fake JJ O O
LinkedIn NN O O
page NN O O
. . O O

The DT O O
malicious JJ O O
LinkedIn NN O O
page NN O O
launched VBD O O
a DT B-Entity 1
malware NN I-Entity O
attack NN I-Entity O
, , O O
infecting VBG B-Action 2
the DT B-Entity 3
employees NNS I-Entity O
' POS I-Entity O
computers NNS I-Entity O
and CC O O
giving VBG B-Action 4
the DT O O
spies NNS O O
total VBP B-Entity 5
control NN I-Entity O
of IN I-Entity O
their PRP$ I-Entity O
systems NNS I-Entity O
, , O O
allowing VBG O O
GCHQ NNP B-Entity 6
to TO O O
get VB O O
deep JJ O O
inside IN O O
Belgacom NNP O O
's POS O O
networks NNS O O
to TO O O
steal VB B-Action 7
data NNS B-Entity 8
. . O O

The DT B-Entity 1
implants NNS I-Entity O
allowed VBD O O
GCHQ NNP O O
to TO O O
conduct VB B-Action 2
surveillance NN B-Entity 3
of IN I-Entity O
internal JJ I-Entity O
Belgacom NNP I-Entity O
company NN I-Entity O
communications NNS I-Entity O
and CC O O
gave VBD O O
British JJ O O
spies NNS O O
the DT O O
ability NN O O
to TO O O
gather VB B-Action 4
data NNS B-Entity 5
from IN O O
the DT O O
company NN O O
's POS O O
network NN O O
and CC O O
customers NNS O O
, , O O
which WDT O O
include VBP O O
the DT O O
European NNP O O
Commission NNP O O
, , O O
the DT O O
European NNP O O
Parliament NNP O O
, , O O
and CC O O
the DT O O
European NNP O O
Council NNP O O
. . O O

The DT O O
software NN O O
implants NNS O O
used VBN O O
in IN O O
this DT O O
case NN O O
were VBD O O
part NN O O
of IN O O
the DT O O
suite NN O O
of IN O O
malware NN O O
now RB O O
known VBN O O
as IN O O
Regin NNP O O
. . O O

One CD O O
of IN O O
the DT O O
keys NNS O O
to TO O O
Regin NNP O O
is VBZ O O
its PRP$ O O
stealth NN O O
: : O O
To TO O O
avoid VB B-Action 1
detection NN B-Entity 2
and CC O O
frustrate VB B-Action 3
analysis NN B-Entity 4
, , O O
malware NN B-Entity 5
used VBN O O
in IN O O
such JJ O O
operations NNS O O
frequently RB O O
adhere VBP O O
to TO O O
a DT O O
modular JJ O O
design NN O O
. . O O

This DT O O
involves VBZ O O
the DT O O
deployment NN O O
of IN O O
the DT O O
malware NN O O
in IN O O
stages NNS O O
, , O O
making VBG O O
it PRP O O
more RBR O O
difficult JJ O O
to TO O O
analyze VB O O
and CC O O
mitigating VBG O O
certain JJ O O
risks NNS O O
of IN O O
being VBG O O
caught VBN O O
. . O O

Based VBN O O
on IN O O
an DT O O
analysis NN O O
of IN O O
the DT O O
malware NN O O
samples NNS O O
, , O O
Regin NNP O O
appears VBZ O O
to TO O O
have VB O O
been VBN O O
developed VBN O O
over IN O O
the DT O O
course NN O O
of IN O O
more JJR O O
than IN O O
a DT O O
decade NN O O
; : O O
The NNP O O
Intercept NNP O O
has VBZ O O
identified VBN O O
traces NNS O O
of IN O O
its PRP$ O O
components NNS O O
dating VBG O O
back RB O O
as RB O O
far RB O O
as IN O O
2003 CD O O
. . O O

Regin NNP O O
was VBD O O
mentioned VBN O O
at IN O O
a DT O O
recent JJ O O
Hack.lu NN O O
conference NN O O
in IN O O
Luxembourg NNP O O
, , O O
and CC O O
Symantec NNP O O
's POS O O
report NN O O
on IN O O
Sunday NNP O O
said VBD O O
the DT O O
firm NN O O
had VBD O O
identified VBN O O
Regin NNP O O
on IN O O
infected JJ O O
systems NNS O O
operated VBN O O
by IN O O
private JJ O O
companies NNS O O
, , O O
government NN O O
entities NNS O O
, , O O
and CC O O
research NN O O
institutes NN O O
in IN O O
countries NNS O O
such JJ O O
as IN O O
Russia NNP O O
, , O O
Saudi NNP O O
Arabia NNP O O
, , O O
Mexico NNP O O
, , O O
Ireland NNP O O
, , O O
Belgium NNP O O
, , O O
and CC O O
Iran NNP O O
. . O O

The DT O O
use NN O O
of IN O O
hacking NN O O
techniques NNS O O
and CC O O
malware NN O O
in IN O O
state-sponsored JJ O O
espionage NN O O
has VBZ O O
been VBN O O
publicly RB O O
documented VBN O O
over IN O O
the DT O O
last JJ O O
few JJ O O
years NNS O O
: : O O
China NNP O O
has VBZ O O
been VBN O O
linked VBN O O
to TO O O
extensive JJ O O
cyber NN O O
espionage NN O O
, , O O
and CC O O
recently RB O O
the DT O O
Russian JJ O O
government NN O O
was VBD O O
also RB O O
alleged VBN O O
to TO O O
have VB O O
been VBN O O
behind IN O O
a DT O O
cyber NN O O
attack NN O O
on IN O O
the DT O O
White NNP O O
House NNP O O
. . O O

Regin NNP O O
further RB O O
demonstrates VBZ O O
that IN O O
Western JJ O O
intelligence NN O O
agencies NNS O O
are VBP O O
also RB O O
involved VBN O O
in IN O O
covert JJ O O
cyberespionage NN O O
. . O O

GCHQ NNP O O
declined VBD O O
to TO O O
comment VB O O
for IN O O
this DT O O
story NN O O
. . O O

The DT O O
agency NN O O
issued VBD O O
its PRP$ O O
standard JJ O O
response NN O O
to TO O O
inquiries NNS O O
, , O O
saying VBG O O
that IN O O
'' '' O O
it PRP O O
is VBZ O O
longstanding JJ O O
policy NN O O
that IN O O
we PRP O O
do VBP O O
not RB O O
comment VB O O
on IN O O
intelligence NN O O
matters NNS O O
'' '' O O
and CC O O
'' '' O O
all DT O O
of IN O O
GCHQ NNP O O
's POS O O
work NN O O
is VBZ O O
carried VBN O O
out RP O O
in IN O O
accordance NN O O
with IN O O
a DT O O
strict JJ O O
legal JJ O O
and CC O O
policy NN O O
framework NN O O
, , O O
which WDT O O
ensures VBZ O O
that IN O O
our PRP$ O O
activities NNS O O
are VBP O O
authorised VBN O O
, , O O
necessary JJ O O
and CC O O
proportionate JJ O O
. . O O

'' '' O O
The DT O O
NSA NNP O O
said VBD O O
in IN O O
a DT O O
statement NN O O
, , O O
'' '' O O
We PRP O O
are VBP O O
not RB O O
going VBG O O
to TO O O
comment VB O O
on IN O O
The DT O O
Intercept NNP O O
's POS O O
speculation NN O O
. . O O

'' '' O O
The DT O O
Intercept NNP O O
has VBZ O O
obtained VBN O O
samples NNS O O
of IN O O
the DT O O
malware NN O O
from IN O O
sources NNS O O
in IN O O
the DT O O
security NN O O
community NN O O
and CC O O
is VBZ O O
making VBG O O
it PRP O O
available JJ O O
for IN O O
public JJ O O
download NN O O
in IN O O
an DT O O
effort NN O O
to TO O O
encourage VB O O
further JJ O O
research NN O O
and CC O O
analysis NN O O
. . O O

( CD O O
To TO O O
download VB O O
the DT O O
malware NN O O
, , O O
click VBP O O
here RB O O
. . O O

The DT O O
file NN O O
is VBZ O O
encrypted VBN O O
; : O O
to TO O O
access VB O O
it PRP O O
on IN O O
your PRP$ O O
machine NN O O
use VB O O
the DT O O
password NN O O
'' '' O O
infected JJ O O
. . O O

'' '' O O
) NN O O
What WP O O
follows VBZ O O
is VBZ O O
a DT O O
brief JJ O O
technical JJ O O
analysis NN O O
of IN O O
Regin NN O O
conducted VBN O O
by IN O O
The DT O O
Intercept NNP O O
's POS O O
computer NN O O
security NN O O
staff NN O O
. . O O

Regin NNP O O
is VBZ O O
an DT O O
extremely RB O O
complex JJ O O
, , O O
multi-faceted JJ O O
piece NN O O
of IN O O
work NN O O
and CC O O
this DT O O
is VBZ O O
by IN O O
no DT O O
means VBZ O O
a DT O O
definitive JJ O O
analysis NN O O
. . O O

In IN O O
the DT O O
coming VBG O O
weeks NNS O O
, , O O
The DT O O
Intercept NNP O O
will MD O O
publish VB O O
more JJR O O
details NNS O O
about IN O O
Regin NNP O O
and CC O O
the DT O O
infiltration NN O O
of IN O O
Belgacom NNP O O
as IN O O
part NN O O
of IN O O
an DT O O
investigation NN O O
in IN O O
partnership NN O O
with IN O O
Belgian JJ O O
and CC O O
Dutch JJ O O
newspapers NNS O O
De NNP O O
Standaard NNP O O
and CC O O
NRC NNP O O
Handelsblad NNP O O
. . O O

In IN O O
Nordic JJ O O
mythology NN O O
, , O O
the DT O O
name NN O O
Regin NNP O O
is VBZ O O
associated VBN O O
with IN O O
a DT O O
violent JJ O O
dwarf NN O O
who WP O O
is VBZ O O
corrupted VBN O O
by IN O O
greed NN O O
. . O O

It PRP O O
is VBZ O O
unclear JJ O O
how WRB O O
the DT O O
Regin NNP O O
malware NN O O
first RB O O
got VBD O O
its PRP$ O O
name NN O O
, , O O
but CC O O
the DT O O
name NN O O
appeared VBD O O
for IN O O
the DT O O
first JJ O O
time NN O O
on IN O O
the DT O O
VirusTotal JJ O O
website NN O O
on IN O O
March NNP O O
9th JJ O O
2011 CD O O
. . O O

Der NNP O O
Spiegel NNP O O
reported VBD O O
that IN O O
, , O O
according VBG O O
to TO O O
Snowden NNP O O
documents NNS O O
, , O O
the DT O O
computer NN O O
networks NNS O O
of IN O O
the DT O O
European NNP O O
Union NNP O O
were VBD O O
infiltrated VBN O O
by IN O O
the DT O O
NSA NNP O O
in IN O O
the DT O O
months NNS O O
before IN O O
the DT O O
first JJ O O
discovery NN O O
of IN O O
Regin NNP O O
. . O O

Industry NNP O O
sources NNS O O
familiar JJ O O
with IN O O
the DT O O
European NNP O O
Parliament NNP O O
intrusion NN O O
told VBD O O
The DT O O
Intercept NNP O O
that IN O O
such JJ O O
attacks NNS O O
were VBD O O
conducted VBN O O
through IN O O
the DT O O
use NN O O
of IN O O
Regin NNP O O
and CC O O
provided VBN O O
samples NNS O O
of IN O O
its PRP$ O O
code NN O O
. . O O

This DT O O
discovery NN O O
, , O O
the DT O O
sources NNS O O
said VBD O O
, , O O
may MD O O
have VB O O
been VBN O O
what WP O O
brought VBD O O
Regin NNP O O
to TO O O
the DT O O
wider JJR O O
attention NN O O
of IN O O
security NN O O
vendors NNS O O
. . O O

Also RB O O
on IN O O
March NNP O O
9th JJ O O
2011 CD O O
, , O O
Microsoft NNP O O
added VBD O O
related JJ O O
entries NNS O O
to TO O O
its PRP$ O O
Malware NNP O O
Encyclopedia NNP O O
: : O O
Two CD O O
more JJR O O
variants NNS O O
of IN O O
Regin NNP O O
have VBP O O
been VBN O O
added VBN O O
to TO O O
the DT O O
Encyclopedia NN O O
, , O O
Regin.B NN O O
and CC O O
Regin.C NN O O
. . O O

Microsoft NNP O O
appears VBZ O O
to TO O O
detect VB O O
the DT O O
64-bit JJ O O
variants NNS O O
of IN O O
Regin NNP O O
as IN O O
Prax.A NNP O O
and CC O O
Prax.B NNP O O
. . O O

None NNP O O
of IN O O
the DT O O
Regin/Prax NN O O
entries NNS O O
are VBP O O
provided VBN O O
with IN O O
any DT O O
sort NN O O
of IN O O
summary NN O O
or CC O O
technical JJ O O
information NN O O
. . O O

The DT O O
following VBG O O
Regin NNP O O
components NNS O O
have VBP O O
been VBN O O
identified VBN O O
: : O O
The DT B-Entity 1
first JJ I-Entity O
stage NN I-Entity O
are VBP O O
drivers NNS O O
which WDT O O
act VBP B-Action 2
as IN I-Action O
loaders NNS B-Entity 3
for IN I-Entity O
a DT I-Entity O
second JJ I-Entity O
stage NN I-Entity O
. . O O

They PRP O O
have VBP O O
an DT O O
encrypted JJ O O
block NN O O
which WDT O O
points VBZ O O
to TO O O
the DT O O
location NN O O
of IN O O
the DT O O
2nd JJ O O
stage NN O O
payload NN O O
. . O O

On IN O O
NTFS NNP O O
, , O O
that WDT O O
is VBZ O O
an DT O O
Extended NNP O O
Attribute NNP O O
Stream NNP O O
; : O O
on IN O O
FAT NNP O O
, , O O
they PRP O O
use VBP O O
the DT O O
registry NN O O
to TO O O
store VB O O
the DT O O
body NN O O
. . O O

When WRB O O
started VBN O O
, , O O
this DT B-Entity 1
stage NN I-Entity O
simply RB O O
loads NNS B-Action 2
and CC I-Action O
executes VBZ I-Action O
Stage NNP B-Entity 3
2 CD I-Entity O
. . O O

The DT B-Entity 1
Regin NNP I-Entity O
loaders NNS I-Entity O
that WDT O O
are VBP B-Action 2
disguised VBN I-Action O
as IN I-Action O
Microsoft NNP B-Entity 3
drivers NNS I-Entity O
with IN O O
names NNS O O
such JJ O O
as IN O O
: : O O
Mimicking VBG B-Action 4
Microsoft NNP B-Entity 5
drivers NNS I-Entity O
allows VBZ O O
the DT B-Entity 6
loaders NNS I-Entity O
to TO O O
better RBR O O
disguise VB B-Action 7
their PRP$ B-Entity 8
presence NN I-Entity O
on IN I-Entity O
the DT I-Entity O
system NN I-Entity O
and CC O O
appear VBP B-Action 9
less RBR B-Entity 10
suspicious JJ I-Entity O
to TO B-Modifier 11
host NN B-Entity 12
intrusion NN I-Entity O
detection NN I-Entity O
systems NNS I-Entity O
. . O O

When WRB O O
launched VBN O O
, , O O
it PRP B-Entity 1
cleans VBZ B-Action 2
traces NNS B-Entity 3
of IN I-Entity O
the DT I-Entity O
initial JJ I-Entity O
loader NN I-Entity O
, , O O
loads NNS B-Action 4
the DT B-Entity 5
next JJ I-Entity O
part NN I-Entity O
of IN I-Entity O
the DT I-Entity O
toolkit NN I-Entity O
and CC O O
monitors VBZ B-Action 6
its PRP$ B-Entity 7
execution NN I-Entity O
. . O O

On IN B-Modifier 1
failure NN B-Entity 2
, , O O
Stage NN B-Entity 3
2 CD I-Entity O
is VBZ O O
able JJ O O
to TO O O
disinfect VB B-Action 4
the DT B-Entity 5
compromised VBN I-Entity O
device NN I-Entity O
. . O O

The DT B-Entity 1
malware NN I-Entity O
zeroes VBZ B-Action 2
out RP I-Action O
its PRP$ B-Entity 3
PE NNP I-Entity O
( NNP I-Entity O
Portable NNP I-Entity O
Executable NNP I-Entity O
, , I-Entity O
the DT I-Entity O
Windows NNP I-Entity O
executable JJ I-Entity O
format NN I-Entity O
) CD I-Entity O
headers NNS I-Entity O
in IN I-Entity O
memory NN I-Entity O
, , O O
replacing VBG B-Action 4
'' '' B-Entity 5
MZ JJ I-Entity O
'' '' I-Entity O
with IN B-Modifier 6
its PRP$ B-Entity 7
own JJ I-Entity O
magic JJ I-Entity O
marker NN I-Entity O
0xfedcbafe NN I-Entity O
. . O O

This DT O O
component NN O O
consists VBZ O O
of IN O O
a DT O O
service NN O O
orchestrator NN O O
working VBG O O
in IN O O
Windows NNP O O
' POS O O
kernel NN O O
. . O O

It PRP B-Entity 1
initializes VBZ B-Action 2
the DT B-Entity 3
core NN I-Entity O
components NNS I-Entity O
of IN I-Entity O
the DT I-Entity O
architecture NN I-Entity O
and CC O O
loads NNS B-Action 4
the DT B-Entity 5
next JJ I-Entity O
parts NNS I-Entity O
of IN I-Entity O
the DT I-Entity O
malware NN I-Entity O
. . O O

This DT O O
stage NN O O
is VBZ O O
composed VBN O O
of IN O O
a DT O O
service NN O O
orchestrator NN O O
located JJ O O
in IN O O
user NN O O
land NN O O
, , O O
provided VBN O O
with IN O O
many JJ O O
modules NNS O O
which WDT O O
are VBP O O
loaded VBN O O
dynamically RB O O
as IN O O
needed VBN O O
. . O O

These DT B-Entity 1
modules NNS I-Entity O
can MD O O
include VB B-Action 2
data NNS B-Entity 3
collectors NNS I-Entity O
, , O O
a DT B-Entity 4
self-defense NN I-Entity O
engine NN I-Entity O
which WDT O O
detects VBZ B-Action 5
if IN O O
attempts NNS B-Entity 6
to TO I-Entity O
detect VB I-Entity O
the DT I-Entity O
toolkit NN I-Entity O
occur VBP O O
, , O O
functionality NN O O
for IN O O
encrypted JJ B-Action 7
communications NNS B-Entity 8
, , O O
network NN B-Entity 9
capture NN I-Entity O
programs NNS I-Entity O
, , O O
and CC O O
remote JJ B-Entity 10
controllers NNS I-Entity O
of IN I-Entity O
different JJ I-Entity O
kinds NNS I-Entity O
. . O O

The DT O O
Intercept NNP O O
's POS O O
investigation NN O O
revealed VBD O O
a DT B-Entity 1
sample NN I-Entity O
uploaded VBN O O
on IN O O
VirusTotal NNP O O
on IN O O
March NNP O O
14th JJ O O
2012 CD O O
that WDT O O
presents VBZ O O
the DT O O
unique JJ O O
0xfedcbafe NN O O
header NN O O
, , O O
which WDT O O
is VBZ O O
a DT O O
sign NN O O
that IN O O
it PRP O O
might MD O O
have VB O O
been VBN O O
loaded VBN B-Action 2
by IN O O
a DT B-Entity 3
Regin NNP I-Entity O
driver NN I-Entity O
and CC O O
it PRP B-Entity 4
appears VBZ O O
to TO O O
provide VB B-Action 5
stealth NN B-Entity 6
functionality NN I-Entity O
for IN B-Modifier 7
the DT B-Entity 8
tool NN I-Entity O
kit NN I-Entity O
. . O O

In IN O O
order NN O O
to TO O O
access VB B-Action 1
information NN B-Entity 2
stored VBN I-Entity O
in IN I-Entity O
the DT I-Entity O
computer NN I-Entity O
's POS I-Entity O
memory NN I-Entity O
, , O O
programs NNS B-Entity 3
use VBP O O
objects NNS O O
that WDT O O
reference VBP O O
specific JJ O O
locations NNS O O
in IN O O
memory NN O O
called VBN O O
pointers NNS O O
. . O O

This DT O O
binary JJ O O
file NN O O
contains VBZ O O
some DT O O
of IN O O
such JJ O O
pointers NNS O O
initialized VBD O O
, , O O
which WDT O O
corroborates VBZ O O
the DT O O
hypothesis NN O O
that IN O O
the DT B-Entity 1
file NN I-Entity O
was VBD B-Action 2
dumped VBN I-Action O
from IN B-Modifier 3
memory NN B-Entity 4
during IN O O
a DT O O
forensic JJ O O
analysis NN O O
of IN O O
a DT O O
compromised VBN O O
system NN O O
. . O O

The DT O O
sample NN O O
has VBZ O O
the DT O O
following VBG O O
SHA256 NN O O
hash NN O O
: : O O
This DT O O
sample NN O O
gives VBZ O O
a DT O O
sense NN O O
of IN O O
the DT O O
sophistication NN O O
of IN O O
the DT O O
actors NNS O O
and CC O O
the DT O O
length NN O O
of IN O O
the DT O O
precautions NNS O O
they PRP O O
have VBP O O
been VBN O O
taking VBG O O
in IN O O
order NN O O
to TO O O
operate VB O O
as RB O O
stealthily RB O O
as IN O O
possible JJ O O
. . O O

When WRB O O
a DT O O
Windows NNP O O
kernel NN O O
driver NN O O
needs VBZ O O
to TO O O
allocate VB O O
memory NN O O
to TO O O
store VB O O
some DT O O
type NN O O
of IN O O
data NNS O O
, , O O
it PRP O O
creates VBZ O O
so RB O O
called VBN O O
kernel NN O O
pools NNS O O
. . O O

Such JJ O O
memory NN O O
allocations NNS O O
have VBP O O
specific JJ O O
headers NNS O O
and CC O O
tags NNS O O
that WDT O O
are VBP O O
used VBN O O
to TO O O
identify VB O O
the DT O O
type NN O O
of IN O O
objects NNS O O
contained VBN O O
within IN O O
the DT O O
block NN O O
. . O O

For IN O O
example NN O O
such JJ O O
tags NNS O O
could MD O O
be VB O O
Proc NNP O O
, , O O
Thrd NNP O O
or CC O O
File NNP O O
, , O O
which WDT O O
respectively RB O O
indicate VBP O O
that IN O O
the DT O O
given VBN O O
block NN O O
would MD O O
contain VB O O
a DT O O
process NN O O
, , O O
thread NN O O
or CC O O
file NN O O
object NN O O
structure NN O O
. . O O

When WRB O O
performing VBG O O
forensic JJ O O
analysis NN O O
of IN O O
a DT O O
computer NN O O
's POS O O
memory NN O O
, , O O
it PRP O O
is VBZ O O
common JJ O O
to TO O O
use VB O O
a DT O O
technique NN O O
called VBN O O
pool NN O O
scanning NN O O
to TO O O
parse VB O O
the DT O O
kernel NN O O
memory NN O O
, , O O
enumerate VB O O
such JJ O O
kernel NN O O
pools NNS O O
, , O O
identify VBP O O
the DT O O
type NN O O
of IN O O
content NN O O
and CC O O
extract VB O O
it PRP O O
. . O O

Just RB O O
like IN O O
Regin FW O O
loader FW O O
drivers NNS O O
, , O O
this DT O O
driver NN O O
repeatedly RB O O
uses VBZ O O
the DT O O
generic JJ O O
'' '' O O
Ddk NN O O
'' '' O O
tag NN O O
with IN O O
ExAllocatePoolWithTag NNP O O
( NNP O O
) NNP O O
when WRB O O
allocating VBG O O
all DT O O
kernel NN O O
pools NNS O O
: : O O
The DT O O
generic JJ O O
tag NN O O
which WDT O O
is VBZ O O
used VBN O O
throughout IN O O
the DT O O
operating NN O O
system NN O O
when WRB O O
a DT O O
proper JJ O O
tag NN O O
is VBZ O O
not RB O O
specified VBN O O
. . O O

This DT O O
makes VBZ O O
it PRP O O
more RBR O O
difficult JJ O O
for IN O O
forensic JJ O O
analysts NNS O O
to TO O O
find VB O O
any DT O O
useful JJ O O
information NN O O
when WRB O O
doing VBG O O
pool NN O O
scanning NN O O
, , O O
since IN O O
all DT O O
its PRP$ O O
memory NN O O
allocations NNS O O
will MD O O
mix VB O O
with IN O O
many JJ O O
generic JJ O O
others NNS O O
. . O O

In IN O O
addition NN O O
, , O O
when WRB O O
freeing VBG O O
memory NN O O
using VBG O O
ExFreePool NNP O O
( NNP O O
) NNP O O
, , O O
the DT B-Entity 1
driver NN I-Entity O
zeroes VBZ B-Action 2
the DT B-Entity 3
content NN I-Entity O
, , O O
probably RB O O
to TO O O
avoid VB B-Action 4
leaving VBG B-Entity 5
traces NNS I-Entity O
in IN I-Entity O
pool NN I-Entity O
memory NN I-Entity O
. . O O

The DT B-Entity 1
driver NN I-Entity O
also RB O O
contains VBZ O O
routines NNS O O
to TO O O
check VB B-Action 2
for IN I-Action O
specific JJ B-Entity 3
builds NNS I-Entity O
of IN I-Entity O
the DT I-Entity O
Windows NNP I-Entity O
kernel NN I-Entity O
in IN I-Entity O
use NN I-Entity O
, , O O
including VBG O O
very RB O O
old JJ O O
versions NNS O O
such JJ O O
as IN O O
for IN O O
Windows NNP O O
NT4 NN O O
Terminal JJ O O
Server NN O O
and CC O O
Windows NNP O O
2000 CD O O
, , O O
and CC O O
then RB O O
adapts VBZ B-Action 4
its PRP$ B-Entity 5
behavior NN I-Entity O
accordingly RB O O
. . O O

Windows NNP O O
kernel NN O O
drivers NNS O O
operate VBP O O
on IN O O
different JJ O O
levels NNS O O
of IN O O
priority NN O O
, , O O
from IN O O
the DT O O
lowest JJS O O
PASSIVELEVEL NN O O
to TO O O
the DT O O
highest JJS O O
HIGHLEVEL NN O O
. . O O

This DT O O
level NN O O
is VBZ O O
used VBN O O
by IN O O
the DT O O
processor NN O O
to TO O O
know VB O O
what WP O O
service NN O O
give VBP O O
execution NN O O
priority NN O O
to TO O O
and CC O O
to TO O O
make VB O O
sure JJ O O
that IN O O
the DT O O
system NN O O
does VBZ O O
n't RB O O
try VB O O
to TO O O
allocate VB O O
used JJ O O
resources NNS O O
which WDT O O
could MD O O
result VB O O
in IN O O
a DT O O
crash NN O O
. . O O

This DT B-Entity 1
Regin NN I-Entity O
driver NN I-Entity O
recurrently RB O O
checks VBZ B-Action 2
that IN O O
the DT B-Entity 3
current JJ I-Entity O
IRQL NNP I-Entity O
( NNP I-Entity O
Interrupt NNP I-Entity O
Request NNP I-Entity O
Level NNP I-Entity O
) NNP I-Entity O
is VBZ O O
set VBN O O
to TO O O
PASSIVELEVEL NN O O
using VBG O O
the DT O O
KeGetCurrentIrql NN O O
( FW O O
) FW O O
function NN O O
in IN O O
many JJ O O
parts NNS O O
of IN O O
the DT O O
code NN O O
, , O O
probably RB O O
in IN O O
order NN O O
to TO O O
operate VB O O
as RB O O
silently RB O O
as IN O O
possible JJ O O
and CC O O
to TO O O
prevent VB O O
possible JJ O O
IRQL NN O O
confusion NN O O
. . O O

This DT O O
technique NN O O
is VBZ O O
another DT O O
example NN O O
of IN O O
the DT O O
level NN O O
of IN O O
precaution NN O O
the DT O O
developers NNS O O
took VBD O O
while IN O O
designing VBG O O
this DT O O
malware NN O O
framework NN O O
. . O O

Upon IN O O
execution NN O O
of IN O O
the DT O O
unload VBP O O
routine JJ O O
( NN O O
located JJ O O
at IN O O
0xFDEFA04A FW O O
) FW O O
, , O O
the DT B-Entity 1
driver NN I-Entity O
performs VBZ O O
a DT O O
long JJ O O
sequence NN O O
of IN O O
steps NNS O O
to TO O O
remove VB B-Action 2
remaining VBG B-Entity 3
traces NNS I-Entity O
and CC I-Entity O
artifacts NNS I-Entity O
. . O O

In IN O O
an DT O O
interview NN O O
given VBN O O
to TO O O
the DT O O
Belgian JJ O O
magazine NN O O
MondiaalNiews NNP O O
, , O O
Fabrice NNP O O
Clément NNP O O
, , O O
head NN O O
of IN O O
security NN O O
of IN O O
Belgacom NNP O O
, , O O
said VBD O O
that IN O O
the DT O O
company NN O O
first RB O O
identified VBD O O
the DT O O
attack NN O O
on IN O O
June NNP O O
21 CD O O
, , O O
2013 CD O O
. . O O

In IN O O
the DT O O
same JJ O O
interview NN O O
Clément NNP O O
says VBZ O O
that IN O O
the DT O O
computers NNS O O
targeted VBN O O
by IN O O
the DT O O
attackers NNS O O
included VBD O O
staff NN O O
workstations NNS O O
as RB O O
well RB O O
as IN O O
email NN O O
servers NNS O O
. . O O

These DT O O
statements NNS O O
confirm VBP O O
the DT O O
timing NN O O
and CC O O
techniques NNS O O
used VBN O O
in IN O O
the DT O O
attack NN O O
. . O O

From IN O O
previously RB O O
identified VBN O O
Regin NN O O
samples NNS O O
, , O O
The DT O O
Intercept NNP O O
developed VBD O O
unique JJ O O
signatures NNS O O
which WDT O O
could MD O O
identify VB O O
this DT O O
toolkit NN O O
. . O O

A DT O O
zip NN O O
archive NN O O
with IN O O
a DT O O
sample NN O O
identified VBN O O
as IN O O
Regin/Prax NN O O
was VBD O O
found VBN O O
in IN O O
VirusTotal NNP O O
, , O O
a DT O O
free JJ O O
, , O O
online JJ O O
website NN O O
which WDT O O
allows VBZ O O
people NNS O O
to TO O O
submit VB O O
files NNS O O
to TO O O
be VB O O
scanned VBN O O
by IN O O
several JJ O O
anti-virus JJ O O
products NNS O O
. . O O

The DT O O
zip NN O O
archive NN O O
was VBD O O
submitted VBN O O
on IN O O
2013-06-21 CD O O
07:58:37 CD O O
UTC NNP O O
from IN O O
Belgium NNP O O
, , O O
the DT O O
date NN O O
identified VBN O O
by IN O O
Clément NNP O O
. . O O

Sources NNS O O
familiar JJ O O
with IN O O
the DT O O
Belgacom NNP O O
intrusion NN O O
told VBD O O
The DT O O
Intercept NNP O O
that IN O O
this DT O O
sample NN O O
was VBD O O
uploaded VBN O O
by IN O O
a DT O O
systems NNS O O
administrator NN O O
at IN O O
the DT O O
company NN O O
, , O O
who WP O O
discovered VBD O O
the DT O O
malware NN O O
and CC O O
uploaded VBD O O
it PRP O O
in IN O O
an DT O O
attempt NN O O
to TO O O
research VB O O
what WP O O
type NN O O
of IN O O
malware NN O O
it PRP O O
was VBD O O
. . O O

The DT O O
archive NN O O
contains VBZ O O
: : O O
Along IN O O
with IN O O
other JJ O O
files NNS O O
The DT O O
Intercept NNP O O
found VBD O O
the DT O O
output NN O O
of IN O O
a DT O O
forensic JJ O O
tool NN O O
, , O O
GetThis NNP O O
, , O O
which WDT O O
is VBZ O O
being VBG O O
run VBN O O
on IN O O
target NN O O
systems NNS O O
looking VBG O O
for IN O O
malware NN O O
. . O O

From IN O O
the DT O O
content NN O O
of IN O O
the DT O O
GetThis.log NN O O
file NN O O
, , O O
we PRP O O
can MD O O
see VB O O
that IN O O
a DT O O
sample NN O O
called VBN O O
'' '' O O
svcsstat.exe NN O O
'' '' O O
and CC O O
located JJ O O
in IN O O
C NN O O
: : O O
\Windows\System32\ NN O O
was VBD O O
collected VBN O O
and CC O O
a DT O O
copy NN O O
of IN O O
it PRP O O
was VBD O O
stored VBN O O
. . O O

The DT O O
malware NN O O
in IN O O
question NN O O
is VBZ O O
'' '' O O
0001000000000C1Csvcsstat.exesample NN O O
'' '' O O
. . O O

This DT O O
is VBZ O O
a DT O O
64bit JJ O O
variant NN O O
of IN O O
the DT O O
first JJ O O
stage NN O O
Regin NN O O
loader NN O O
aforementioned JJ O O
. . O O

The DT O O
archive NN O O
also RB O O
contains VBZ O O
the DT O O
output NN O O
of IN O O
ProcMon NNP O O
, , O O
'' '' O O
Process VB O O
Monitor NNP O O
'' '' O O
, , O O
a DT O O
system NN O O
monitoring NN O O
tool NN O O
distributed VBN O O
by IN O O
Microsoft NNP O O
and CC O O
commonly RB O O
used VBN O O
in IN O O
forensics NNS O O
and CC O O
intrusion NN O O
analysis NN O O
. . O O

This DT O O
file NN O O
identifies VBZ O O
the DT O O
infected JJ O O
system NN O O
and CC O O
provides VBZ O O
a DT O O
variety NN O O
of IN O O
interesting JJ O O
information NN O O
about IN O O
the DT O O
network NN O O
. . O O

For IN O O
instance NN O O
: : O O
The DT O O
following VBG O O
environment NN O O
variable NN O O
shows VBZ O O
that IN O O
the DT O O
system NN O O
was VBD O O
provided VBN O O
with IN O O
a DT O O
Microsoft NNP O O
SQL NNP O O
server NN O O
and CC O O
a DT O O
Microsoft NNP O O
Exchange NNP O O
server NN O O
, , O O
indicating VBG O O
that IN O O
it PRP O O
might MD O O
one CD O O
of IN O O
the DT O O
compromised VBN O O
corporate JJ O O
mail NN O O
server NN O O
Fabrice NNP O O
Clément NNP O O
mentioned VBD O O
to TO O O
Mondiaal NNP O O
News NNP O O
: : O O
Below NNP O O
is VBZ O O
a DT O O
list NN O O
of IN O O
hashes NNS O O
for IN O O
the DT O O
files NNS O O
The DT O O
Intercept NNP O O
is VBZ O O
making VBG O O
available JJ O O
for IN O O
download NN O O
. . O O

Given VBN O O
that IN O O
that IN O O
it PRP O O
has VBZ O O
been VBN O O
over IN O O
a DT O O
year NN O O
since IN O O
the DT O O
Belgacom NNP O O
operation NN O O
was VBD O O
publicly RB O O
outed VBN O O
, , O O
The DT O O
Intercept NNP O O
considers VBZ O O
it PRP O O
likely JJ O O
that IN O O
the DT O O
GCHQ/NSA NN O O
has VBZ O O
replaced VBN O O
their PRP$ O O
toolkit NN O O
and CC O O
no DT O O
current JJ O O
operations NNS O O
will MD O O
be VB O O
affected VBN O O
by IN O O
the DT O O
publication NN O O
of IN O O
these DT O O
samples NNS O O
. . O O

