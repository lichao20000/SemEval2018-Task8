The DT O O
Darkhotel NNP O O
APT NNP O O
is VBZ O O
a DT O O
threat NN O O
actor NN O O
possessing VBG O O
a DT O O
seemingly RB O O
inconsistent JJ O O
and CC O O
con- JJ O O
tradictory JJ O O
set NN O O
of IN O O
characteristics NNS O O
, , O O
some DT O O
advanced JJ O O
and CC O O
some DT O O
fairly RB O O
rudimentary JJ O O
. . O O

In- NN O O
hospitably RB O O
operating VBG O O
for IN O O
almost RB O O
a DT O O
decade NN O O
, , O O
the DT O O
threat NN O O
actor NN O O
is VBZ O O
currently RB O O
active JJ O O
. . O O

The DT O O
actor NN O O
's POS O O
offensive JJ O O
activity NN O O
can MD O O
be VB O O
tied VBN O O
to TO O O
specific JJ O O
hotel NN O O
and CC O O
business NN O O
center NN O O
Wiâ€‘Fi NN O O
and CC O O
physical JJ O O
connections NNS O O
, , O O
some DT O O
of IN O O
it PRP O O
is VBZ O O
also RB O O
tied VBN O O
to TO O O
p2p/file NN O O
sharing NN O O
networks NNS O O
, , O O
and CC O O
they PRP B-Entity 1
have VBP O O
been VBN O O
known VBN O O
to TO O O
spear-phish JJ B-Action 2
targets NNS B-Entity 3
as RB O O
well RB O O
. . O O

Darkhotel NNP O O
tools NNS O O
are VBP O O
detected VBN O O
as IN O O
'' '' O O
Tapaoux NNP O O
'' '' O O
, , O O
'' '' O O
Pioneer NNP O O
'' '' O O
, , O O
'' '' O O
Karba NNP O O
'' '' O O
, , O O
and CC O O
'' '' O O
Nemim NNP O O
'' '' O O
, , O O
among IN O O
other JJ O O
names NNS O O
. . O O

The DT O O
following VBG O O
list NN O O
presents VBZ O O
a DT O O
set NN O O
of IN O O
characteristics NNS O O
for IN O O
the DT O O
crew NN O O
: : O O
When WRB O O
unsuspecting JJ O O
guests NNS O O
, , O O
including VBG O O
situationally RB O O
aware JJ O O
corporate JJ O O
executives NNS O O
and CC O O
high-tech JJ O O
entrepreneurs NNS O O
, , O O
travel VB O O
to TO O O
a DT O O
variety NN O O
of IN O O
hotels NNS O O
and CC O O
connect VB O O
to TO O O
the DT O O
internet NN O O
, , O O
they PRP B-Entity 1
are VBP B-Action 2
infected VBN I-Action O
with IN B-Modifier 3
a DT B-Entity 4
rare JJ I-Entity O
APT NNP I-Entity O
Trojan NNP I-Entity O
posing VBG B-Action 5
as IN B-Modifier 6
any DT B-Entity 7
one CD I-Entity O
of IN I-Entity O
several JJ I-Entity O
major JJ I-Entity O
software NN I-Entity O
releases NNS I-Entity O
. . O O

These DT O O
might MD O O
be VB O O
GoogleToolbar NNP O O
, , O O
Adobe NNP O O
Flash NNP O O
, , O O
Windows NNP O O
Messenger NNP O O
, , O O
etc FW O O
. . O O

This DT O O
first JJ O O
stage NN O O
of IN O O
malware NN O O
helps VBZ O O
the DT B-Entity 1
attackers NNS I-Entity O
to TO O O
identify VB B-Action 2
more RBR B-Entity 3
significant JJ I-Entity O
victims NNS I-Entity O
, , O O
leading VBG O O
to TO O O
the DT O O
selective JJ O O
download NN B-Action 4
of IN O O
more RBR B-Entity 5
advanced JJ I-Entity O
stealing NN I-Entity O
tools NNS I-Entity O
. . O O

At IN O O
the DT O O
hotels NNS O O
, , O O
these DT B-Entity 1
installs NNS I-Entity O
are VBP B-Action 2
selectively RB I-Action O
distributed VBN I-Action O
to TO B-Modifier 3
targeted VBN B-Entity 4
individuals NNS I-Entity O
. . O O

This DT O O
group NN O O
of IN O O
attackers NNS O O
seems VBZ O O
to TO O O
know VB O O
in IN O O
advance NN O O
when WRB O O
these DT O O
individuals NNS O O
will MD O O
arrive VB O O
and CC O O
depart VB O O
from IN O O
their PRP$ O O
high-end JJ O O
hotels NNS O O
. . O O

So RB O O
, , O O
the DT O O
attackers NNS O O
lay VBP O O
in IN O O
wait NN O O
until IN O O
these DT O O
travelers NNS O O
arrive VBP O O
and CC O O
connect VBP O O
to TO O O
the DT O O
Internet NNP O O
. . O O

The DT O O
FBI NNP O O
issued VBD O O
advisories NNS O O
about IN O O
similar JJ O O
hotel NN O O
incidents NNS O O
; : O O
Australian JJ O O
government NN O O
offi- NN O O
cials NNS O O
produced VBD O O
similar JJ O O
, , O O
newsworthy JJ O O
accounts NNS O O
when WRB O O
they PRP O O
were VBD O O
infected JJ O O
. . O O

While IN O O
an DT O O
FBI NNP O O
announcement NN O O
related VBN O O
to TO O O
attacks NNS O O
on IN O O
hotel NN O O
guests NNS O O
overseas RB O O
appeared VBD O O
in IN O O
May NNP O O
2012 CD O O
, , O O
related JJ O O
Darkhotel NN O O
samples NNS O O
were VBD O O
already RB O O
circulating VBG O O
back RB O O
in IN O O
2007 CD O O
. . O O

And CC O O
available JJ O O
Darkhotel NNP O O
server NN O O
log NN O O
data NNS O O
records NNS O O
connections NNS O O
as RB O O
early RB O O
as IN O O
Jan NNP O O
1 CD O O
, , O O
2009 CD O O
. . O O

Addition- NN O O
ally NN O O
, , O O
seeding VBG B-Action 1
p2p NN B-Entity 2
networks NNS I-Entity O
with IN B-Modifier 3
widely RB B-Entity 4
spread VBN I-Entity O
malware NN I-Entity O
and CC I-Entity O
0-day JJ I-Entity O
spear-phishing NN I-Entity O
attacks NNS I-Entity O
demonstrate VBP O O
that IN O O
the DT O O
Darkhotel NNP O O
APT NNP O O
maintains VBZ O O
an DT O O
effective JJ O O
toolset NN O O
and CC O O
a DT O O
long-running JJ O O
operation NN O O
behind IN O O
the DT O O
questionable JJ O O
hospitality NN O O
it PRP O O
shows VBZ O O
its PRP$ O O
guests NNS O O
. . O O

The DT O O
Darkhotel NNP O O
APT NNP O O
's POS O O
precise JJ O O
malware NN O O
spread NN O O
was VBD O O
observed VBN O O
in IN O O
several JJ O O
hotels' NN O O
networks NNS O O
, , O O
where WRB O O
visitors NNS B-Entity 1
connecting VBG I-Entity O
to TO I-Entity O
the DT I-Entity O
hotel NN I-Entity O
's POS I-Entity O
Wi-Fi NN I-Entity O
were VBD B-Action 2
prompted VBN I-Action O
to TO B-Modifier 3
install VB B-Entity 4
software NN I-Entity O
updates NNS I-Entity O
to TO I-Entity O
popular JJ I-Entity O
software NN I-Entity O
packages NNS I-Entity O
. . O O

Of IN O O
course NN O O
, , O O
these DT B-Entity 1
packages NNS I-Entity O
were VBD B-Action 2
really RB B-Entity 3
installers NNS I-Entity O
for IN I-Entity O
Darkhotel NNP I-Entity O
APT NNP I-Entity O
's POS I-Entity O
backdoors NNS I-Entity O
, , O O
added VBD O O
to TO O O
legitimate JJ O O
installers NNS O O
from IN O O
Adobe NNP O O
and CC O O
Google NNP O O
. . O O

Digitally NNP B-Entity 1
signed VBD I-Entity O
Darkhotel NNP I-Entity O
backdoors NNS I-Entity O
were VBD B-Action 2
installed VBN I-Action O
alongside IN B-Modifier 3
the DT B-Entity 4
legitimate JJ I-Entity O
packages NNS I-Entity O
. . O O

The DT O O
most RBS O O
interesting JJ O O
thing NN O O
about IN O O
this DT O O
delivery NN O O
method NN O O
is VBZ O O
that IN O O
the DT O O
hotels NNS O O
require VBP O O
guests NNS O O
to TO O O
use VB O O
their PRP$ O O
last JJ O O
name NN O O
and CC O O
room NN O O
number NN O O
to TO O O
login NN O O
, , O O
yet CC O O
only RB B-Entity 1
a DT I-Entity O
few JJ I-Entity O
guests NNS I-Entity O
received VBD B-Action 2
the DT B-Entity 3
Darkhotel NNP I-Entity O
package NN I-Entity O
. . O O

When WRB O O
visiting VBG O O
the DT O O
same JJ O O
hotels NNS O O
, , O O
our PRP$ O O
honeypot NN O O
research NN O O
systems NNS O O
could MD O O
n't RB O O
attract VB O O
a DT O O
Darkhotel NNP O O
attack NN O O
. . O O

This DT O O
data NN O O
is VBZ O O
inconclusive JJ O O
, , O O
but CC O O
it PRP O O
points VBZ O O
to TO O O
misuse NN O O
of IN O O
check-in NN O O
information NN O O
. . O O

The DT O O
Darkhotel NNP O O
actor NN O O
maintained VBD O O
an DT O O
effective JJ O O
intrusion NN O O
set VBN O O
at IN O O
hotel NN O O
networks NNS O O
, , O O
providing VBG O O
ample JJ O O
access NN O O
to TO O O
unexpected JJ O O
points NNS O O
of IN O O
attack NN O O
over IN O O
several JJ O O
years NNS O O
. . O O

These DT O O
staging NN O O
points NNS O O
also RB O O
provide VBP O O
the DT O O
attackers NNS O O
with IN O O
access NN O O
to TO O O
check-in/check-out NN O O
and CC O O
identity NN O O
information NN O O
of IN O O
visitors NNS O O
to TO O O
high-end JJ O O
and CC O O
luxury NN O O
hotels NNS O O
. . O O

As IN O O
a DT O O
part NN O O
of IN O O
an DT O O
ongoing JJ O O
investigation NN O O
, , O O
our PRP$ O O
research NN O O
led VBD O O
us PRP O O
to TO O O
embedded JJ B-Entity 1
iframes NNS I-Entity O
within IN I-Entity O
hotel NN I-Entity O
networks NNS I-Entity O
that WDT O O
redirected VBD B-Action 2
individuals NNS B-Entity 3
' POS I-Entity O
web NN I-Entity O
browsers NNS I-Entity O
to TO B-Modifier 4
phony JJ B-Entity 5
install- NNP I-Entity O
ers NNPS I-Entity O
. . O O

The DT O O
attackers NNS O O
were VBD O O
very RB O O
careful JJ O O
with IN O O
the DT O O
placement NN O O
of IN O O
these DT O O
iframes NNS O O
and CC O O
executables NNS O O
on IN O O
trusted VBN O O
resources NNS O O
- : O O
the DT O O
hotels NNS O O
' POS O O
network NN O O
login NN O O
portals NNS O O
themselves PRP O O
. . O O

The DT B-Entity 1
attackers NNS I-Entity O
were VBD O O
also RB O O
very RB O O
careful JJ O O
to TO O O
immediately RB O O
delete VB B-Action 2
all DT B-Entity 3
traces NNS I-Entity O
of IN I-Entity O
their PRP$ I-Entity O
tools NNS I-Entity O
as RB B-Modifier 4
soon RB I-Modifier O
as IN I-Modifier O
an DT B-Entity 5
attack NN I-Entity O
was VBD I-Entity O
carried VBN I-Entity O
out RP I-Entity O
successfully RB I-Entity O
. . O O

Those DT O O
portals NNS O O
are VBP O O
now RB O O
reviewed VBN O O
, , O O
cleaned VBN O O
and CC O O
undergoing VBG O O
a DT O O
further JJ O O
review NN O O
and CC O O
hardening NN O O
process NN O O
. . O O

We PRP O O
observed VBD O O
traces NNS O O
of IN O O
a DT O O
couple NN O O
of IN O O
these DT O O
incidents NNS O O
in IN O O
late JJ O O
2013 CD O O
and CC O O
early RB O O
2014 CD O O
on IN O O
a DT O O
victim NN O O
hotel NN O O
's POS O O
network NN O O
. . O O

The DT B-Entity 1
attackers NNS I-Entity O
set VBD O O
up RP O O
the DT O O
environment NN O O
and CC O O
hit VB B-Action 2
their PRP$ B-Entity 3
individual JJ I-Entity O
targets NNS I-Entity O
with IN B-Modifier 4
precision NN B-Entity 5
. . O O

As RB O O
soon RB O O
as IN O O
their PRP$ O O
target NN O O
's POS O O
stay NN O O
was VBD O O
over RB O O
and CC O O
the DT O O
attack-frame NN O O
was VBD O O
closed VBN O O
, , O O
the DT B-Entity 1
attackers NNS I-Entity O
deleted VBD B-Action 2
their PRP$ B-Entity 3
iframe JJ I-Entity O
placement NN I-Entity O
and CC I-Entity O
backdoored JJ I-Entity O
executables NNS I-Entity O
from IN B-Modifier 4
the DT B-Entity 5
hotel NN I-Entity O
network NN I-Entity O
. . O O

The DT B-Entity 1
attackers NNS I-Entity O
successfully RB O O
de- VBP B-Action 2
leted JJ I-Action O
traces NNS B-Entity 3
of IN I-Entity O
their PRP$ I-Entity O
work NN I-Entity O
from IN B-Modifier 4
earlier JJR B-Entity 5
attacks NNS I-Entity O
in IN I-Entity O
another DT I-Entity O
hotel NN I-Entity O
, , O O
but CC O O
their PRP$ O O
offensive JJ O O
techniques NNS O O
were VBD O O
the DT O O
same JJ O O
. . O O

Outside JJ O O
reports NNS O O
of IN O O
the DT O O
same JJ O O
activity NN O O
at IN O O
other JJ O O
hotels NNS O O
provide VBP O O
enough JJ O O
data NNS O O
to TO O O
confirm VB O O
the DT O O
same JJ O O
careful JJ O O
operations NNS O O
there RB O O
. . O O

The DT O O
attack NN O O
technique NN O O
blurs VBZ O O
the DT O O
line NN O O
between IN O O
a DT O O
couple NN O O
of IN O O
common JJ O O
APT NN O O
tactics NNS O O
; : O O
fairly RB O O
inaccurate JJ O O
'' '' O O
watering NN O O
holes NNS O O
'' '' O O
or CC O O
'' '' O O
strategic JJ O O
web NN O O
compromises NNS O O
'' '' O O
and CC O O
more RBR O O
accurate JJ O O
spearphishing NN O O
techniques NNS O O
. . O O

In IN O O
this DT O O
case NN O O
, , O O
the DT O O
Darkhotel NNP O O
attackers NNS O O
wait VBP O O
for IN O O
their PRP$ O O
victim NN O O
to TO O O
connect VB O O
to TO O O
the DT O O
Internet NN O O
over IN O O
the DT O O
hotel NN O O
Wi-Fi NN O O
or CC O O
the DT O O
cable NN O O
in IN O O
their PRP$ O O
room NN O O
. . O O

There EX O O
is VBZ O O
a DT O O
very RB O O
strong JJ O O
likelihood NN O O
the DT O O
targets NNS O O
will MD O O
connect VB O O
over IN O O
these DT O O
resourc- FW O O
es FW O O
, , O O
and CC O O
the DT O O
attackers NNS O O
rely VBP O O
on IN O O
that DT O O
likelihood NN O O
, , O O
much RB O O
like IN O O
at IN O O
a DT O O
watering NN O O
hole NN O O
. . O O

But CC O O
the DT B-Entity 1
attackers NNS I-Entity O
also RB O O
maintain VBP B-Action 2
truly RB B-Entity 3
precise JJ I-Entity O
targeting VBG I-Entity O
information NN I-Entity O
over IN B-Modifier 4
the DT B-Entity 5
victim NN I-Entity O
's POS I-Entity O
visit NN I-Entity O
, , O O
much RB O O
like IN O O
they PRP O O
would MD O O
know VB O O
a DT O O
victim NN O O
's POS O O
email NN O O
address NN O O
and CC O O
content NN O O
interests NNS O O
in IN O O
a DT O O
spearphishing NN O O
attack NN O O
. . O O

While IN O O
setting VBG O O
up RP O O
the DT O O
attack NN O O
, , O O
the DT O O
Darkhotel NNP O O
attackers NNS O O
knew VBD O O
the DT O O
target NN O O
's POS O O
expected VBN O O
arrival NN O O
and CC O O
departure NN O O
times NNS O O
, , O O
room NN O O
number NN O O
, , O O
and CC O O
full JJ O O
name NN O O
, , O O
among IN O O
other JJ O O
data NNS O O
. . O O

This DT O O
data NN O O
enables VBZ O O
the DT B-Entity 1
attackers NNS I-Entity O
to TO O O
present VB B-Action 2
the DT B-Entity 3
malicious JJ I-Entity O
iframe NN I-Entity O
precisely RB B-Modifier 4
to TO I-Modifier O
that DT B-Entity 5
individual JJ I-Entity O
target NN I-Entity O
. . O O

So RB O O
, , O O
here RB O O
we PRP O O
have VBP O O
yet RB O O
another DT O O
unique JJ O O
characteristic NN O O
of IN O O
this DT O O
attacker NN O O
- : O O
they PRP O O
employ VBP O O
a DT O O
loosely RB O O
certain JJ O O
but CC O O
highly RB O O
precise JJ O O
offensive JJ O O
approach NN O O
. . O O

An DT O O
example NN O O
of IN O O
the DT O O
Darkhotel NNP O O
APT NNP O O
's POS O O
indiscriminate JJ O O
malware NN O O
spreading NN O O
is VBZ O O
dem- NN O O
onstrated VBN O O
by IN O O
the DT O O
way NN O O
it PRP B-Entity 1
seeds NNS B-Action 2
Japanese JJ B-Entity 3
p2p NN I-Entity O
sharing NN I-Entity O
sites NNS I-Entity O
, , O O
where WRB O O
the DT B-Entity 4
malware NN I-Entity O
is VBZ B-Action 5
delivered VBN I-Action O
as IN B-Modifier 6
a DT B-Entity 7
part NN I-Entity O
of IN I-Entity O
a DT I-Entity O
large JJ I-Entity O
( NN I-Entity O
approximately RB I-Entity O
900mb FW I-Entity O
) FW I-Entity O
rar FW I-Entity O
archive NN I-Entity O
. . O O

The DT B-Entity 1
archive NN I-Entity O
is VBZ B-Action 2
also RB I-Action O
spread VBN I-Action O
over IN B-Modifier 3
bittorrent NN B-Entity 4
, , O O
as IN O O
detailed VBN O O
below IN O O
. . O O

Darkhotel NNP B-Entity 1
uses VBZ B-Action 2
this DT B-Entity 3
method NN I-Entity O
to TO B-Modifier 4
distribute VB B-Entity 5
their PRP$ I-Entity O
Karba NNP I-Entity O
Trojan NNP I-Entity O
. . O O

These DT O O
Japanese JJ O O
archives NNS O O
, , O O
translated VBN O O
for IN O O
Chinese JJ O O
speaking NN O O
viewers NNS O O
, , O O
appear VBP O O
to TO O O
be VB O O
sexual JJ O O
in IN O O
nature NN O O
, , O O
part NN O O
of IN O O
an DT O O
anime NN O O
sex/military JJ O O
comic JJ O O
scene NN O O
, , O O
exposing VBG O O
the DT O O
likely JJ O O
interests NNS O O
of IN O O
potential JJ O O
targets NNS O O
. . O O

This DT B-Entity 1
Darkhotel NN I-Entity O
package NN I-Entity O
was VBD B-Action 2
downloaded VBN I-Action O
over IN B-Entity 3
30,000 CD I-Entity O
times NNS I-Entity O
in IN B-Modifier 4
less JJR B-Entity 5
than IN I-Entity O
six CD I-Entity O
months NNS I-Entity O
. . O O

The DT O O
p2p NN O O
bittorrent NN O O
Darkhotel NN O O
offering NN O O
is VBZ O O
listed VBN O O
here RB O O
, , O O
posted VBD O O
on IN O O
2013.11.22 CD O O
. . O O

It PRP O O
was VBD O O
spread VBN O O
throughout IN O O
2014 CD O O
. . O O

This DT O O
torrent NN O O
serves VBZ O O
up RP O O
an DT O O
almost RB O O
900 CD O O
mb NN O O
file NN O O
. . O O

The DT O O
rar JJ O O
archive NN O O
decompresses VBZ O O
to TO O O
a DT O O
directory NN O O
full JJ O O
of IN O O
encrypted JJ O O
zips NNS O O
, , O O
the DT O O
associated VBN O O
decryptor NN O O
and CC O O
a DT O O
password NN O O
file NN O O
for IN O O
decrypting VBG O O
the DT O O
zips NNS O O
. . O O

But CC O O
what WP O O
looks VBZ O O
like IN O O
the DT B-Entity 1
AxDecrypt.exe NN I-Entity O
decryptor NN I-Entity O
is VBZ B-Action 2
bound VBN I-Action O
to TO B-Modifier 3
both CC O O
the DT O O
true JJ O O
decryptor NN O O
and CC O O
the DT B-Entity 4
dropper NN I-Entity O
for IN I-Entity O
the DT I-Entity O
Darkhotel NNP I-Entity O
Catch.exe NN I-Entity O
Karba NNP I-Entity O
Trojan NNP I-Entity O
. . O O

When WRB O O
a DT O O
user NN O O
downloads NNS O O
the DT O O
torrent NN O O
and CC O O
decrypts VBZ O O
the DT O O
zip NN O O
files NNS O O
, , O O
the DT B-Entity 1
trojan JJ I-Entity O
surrepti- NN O O
tiously RB O O
is VBZ B-Action 2
installed VBN I-Action O
and CC I-Action O
run VBN I-Action O
on IN B-Modifier 3
the DT B-Entity 4
victim NN I-Entity O
system NN I-Entity O
. . O O

Catch.exe NN B-Entity 1
, , O O
detected VBN B-Action 2
as IN B-Modifier 3
Backdoor.Win32.Agent.dgrn NN B-Entity 4
, , O O
communicates VBZ B-Action 5
with IN B-Modifier 6
the DT B-Entity 7
fol- NN I-Entity O
lowing VBG I-Entity O
Darkhotel NNP I-Entity O
command NN I-Entity O
and CC I-Entity O
control NN I-Entity O
servers NNS I-Entity O
: : O O
Other JJ O O
examples NNS O O
of IN O O
this DT B-Entity 8
Darkhotel NNP I-Entity O
backdoor NN I-Entity O
bound VBD B-Action 9
within IN B-Modifier 10
a DT B-Entity 11
shared JJ I-Entity O
torrent NN I-Entity O
include VBP O O
adult JJ O O
content JJ O O
Japanese JJ O O
anime NN O O
and CC O O
more JJR O O
. . O O

There EX O O
are VBP O O
tens NNS O O
of IN O O
thousands NNS O O
of IN O O
down- NN O O
loads NNS O O
of IN O O
these DT O O
individual JJ O O
torrents NNS O O
. . O O

The DT B-Entity 1
associated VBN I-Entity O
Darkhotel NN I-Entity O
backdoor NN I-Entity O
was VBD B-Action 2
hosted VBN I-Action O
on IN B-Modifier 3
bittorrent NN B-Entity 4
, , I-Entity O
emule NN I-Entity O
, , I-Entity O
etc NN I-Entity O
, , I-Entity O
under IN B-Modifier 5
a DT B-Entity 6
variety NN I-Entity O
of IN I-Entity O
comic JJ I-Entity O
names NNS I-Entity O
. . O O

Examples NNS O O
include VBP O O
comics NNS O O
and CC O O
anime NN O O
offerings NNS O O
. . O O

Related NNP B-Entity 1
Darkhotel NNP I-Entity O
command NN I-Entity O
and CC I-Entity O
control NN I-Entity O
server NN I-Entity O
domains NNS I-Entity O
include VBP B-Action 2
: : O O
Darkhotel NN B-Entity 3
campaigns NNS I-Entity O
involving VBG B-Action 4
typical JJ B-Entity 5
spear-phished JJ I-Entity O
Tapaoux NN I-Entity O
implants NNS I-Entity O
publicly RB O O
appeared VBD O O
in IN O O
bits NNS O O
and CC O O
pieces NNS O O
several JJ O O
times NNS O O
over IN O O
the DT O O
past JJ O O
five CD O O
years NNS O O
. . O O

These DT O O
subproject JJ O O
efforts NNS O O
targeted VBN O O
defense NN O O
industrial JJ O O
base NN O O
( NN O O
DIB NN O O
) NN O O
, , O O
government NN O O
, , O O
and CC O O
NGO NN O O
organizations NNS O O
. . O O

Email VB O O
content NN O O
on IN O O
topics NNS O O
like IN O O
nuclear JJ O O
energy NN O O
and CC O O
weaponry NN O O
capabilities NNS O O
was VBD O O
used VBN O O
as IN O O
a DT O O
lure NN O O
. . O O

Early NNP O O
accounts NNS O O
were VBD O O
posted VBN O O
on IN O O
contagio NN O O
describing VBG O O
attacks NNS O O
on IN O O
NGO FW O O
organi- FW O O
zations NNS O O
and CC O O
government NN O O
policy NN O O
makers NNS O O
. . O O

This DT B-Entity 1
spear-phishing JJ I-Entity O
activity NN I-Entity O
continues VBZ B-Action 2
into IN B-Modifier 3
2014 CD B-Entity 4
. . O O

The DT B-Entity 1
attacks NNS I-Entity O
follow VBP B-Action 2
the DT B-Entity 3
typical JJ I-Entity O
spear-phishing NN I-Entity O
process NN I-Entity O
and CC O O
in IN O O
the DT O O
past JJ O O
couple NN O O
of IN O O
months NNS O O
, , O O
exploited VBN B-Entity 4
systems NNS I-Entity O
retrieved VBD B-Action 5
downloader NN B-Entity 6
executables NNS I-Entity O
from IN B-Modifier 7
web NN B-Entity 8
servers NNS I-Entity O
like IN O O
Over NNP O O
the DT O O
past JJ O O
few JJ O O
years NNS O O
the DT B-Entity 9
group NN I-Entity O
has VBZ O O
emailed VBN B-Action 10
links NNS B-Entity 11
that WDT O O
redirect VBP B-Action 12
targets NNS B-Entity 13
' POS I-Entity O
brows- JJ I-Entity O
ers NNPS I-Entity O
to TO B-Modifier 14
Internet NNP B-Entity 15
Explorer NNP I-Entity O
0-day JJ I-Entity O
exploits NNS I-Entity O
. . O O

Sometimes RB O O
the DT B-Entity 1
attachment NN I-Entity O
itself PRP I-Entity O
includes VBZ B-Action 2
an DT B-Entity 3
Adobe NNP I-Entity O
0-day NN I-Entity O
exploit VB I-Entity O
. . O O

This DT O O
crew NN O O
occasionally RB O O
deploys VBZ O O
0-day JJ O O
exploits NNS O O
, , O O
but CC O O
burns VBZ O O
them PRP O O
when WRB O O
required VBN O O
. . O O

In IN O O
the DT O O
past JJ O O
few JJ O O
years NNS O O
, , O O
they PRP B-Entity 1
deployed VBD B-Action 2
0-day JJ B-Entity 3
spear-phishing NN I-Entity O
attacks NNS I-Entity O
targeting VBG B-Action 4
Adobe NNP B-Entity 5
products NNS I-Entity O
and CC I-Entity O
Microsoft NNP I-Entity O
Internet NNP I-Entity O
Explorer NNP I-Entity O
, , I-Entity O
including VBG I-Entity O
cveÂ­2010Â­0188 NN I-Entity O
. . O O

In IN O O
early JJ O O
2014 CD O O
, , O O
our PRP$ O O
researchers NNS O O
exposed VBD O O
their PRP$ O O
use NN O O
of IN O O
cveÂ­2014Â­0497 NN O O
, , O O
a DT O O
Flash NN O O
0-day NN O O
described VBN O O
on IN O O
Securelist NNP O O
in IN O O
early JJ O O
February NNP O O
. . O O

The DT B-Entity 1
crew NN I-Entity O
spear-phished VBD B-Action 2
a DT B-Entity 3
set NN I-Entity O
of IN I-Entity O
target NN I-Entity O
systems NNS I-Entity O
connected VBN I-Entity O
to TO I-Entity O
the DT I-Entity O
Internet NN I-Entity O
through IN I-Entity O
Chinese JJ I-Entity O
ISPs NNS I-Entity O
, , O O
and CC O O
developed VBD O O
capabilities NNS O O
within IN O O
the DT O O
0-day JJ O O
exploits NNS O O
to TO O O
handle VB O O
hardened VBN O O
Windows NNP O O
8.1 CD O O
systems NNS O O
. . O O

It PRP O O
's VBZ O O
interesting JJ O O
that IN O O
the DT B-Entity 1
Flash NNP I-Entity O
objects NNS I-Entity O
were VBD B-Action 2
embedded VBN I-Action O
in IN B-Modifier 3
Korean JJ B-Entity 4
documents NNS I-Entity O
titled VBN I-Entity O
'' '' I-Entity O
List NN I-Entity O
of IN I-Entity O
the DT I-Entity O
latest JJS I-Entity O
Japanese JJ I-Entity O
AV NN I-Entity O
wind NN I-Entity O
and CC I-Entity O
how WRB I-Entity O
to TO I-Entity O
use VB I-Entity O
torrents.docx NN I-Entity O
'' '' I-Entity O
( CD I-Entity O
loose JJ I-Entity O
English JJ I-Entity O
translation NN I-Entity O
) NN I-Entity O
. . O O

The DT B-Entity 1
dropped VBN I-Entity O
downloader NN I-Entity O
( FW I-Entity O
d8137ded710d83e2339a97ee78494c34 FW I-Entity O
) FW I-Entity O
delivered VBN B-Action 2
malcode NN B-Entity 3
similar JJ I-Entity O
to TO I-Entity O
the DT I-Entity O
'' '' I-Entity O
Information NNP I-Entity O
Stealer NNP I-Entity O
'' '' I-Entity O
component NN I-Entity O
functionality NN I-Entity O
summarized VBD I-Entity O
below IN I-Entity O
, , I-Entity O
and CC I-Entity O
detailed VBN I-Entity O
in IN I-Entity O
Appendix NNP I-Entity O
D NNP I-Entity O
. . O O

The NNP O O
Darkhotel NNP O O
actors NNS O O
typically RB O O
sign VBP O O
their PRP$ O O
backdoors NNS O O
with IN O O
digital JJ O O
certificates NNS O O
of IN O O
one CD O O
kind NN O O
or CC O O
another DT O O
. . O O

However RB O O
, , O O
the DT O O
certificates NNS O O
originally RB O O
chosen VBN O O
by IN O O
this DT O O
crew NN O O
are VBP O O
very RB O O
interesting JJ O O
because IN O O
of IN O O
their PRP$ O O
weak JJ O O
keys NNS O O
and CC O O
likely JJ O O
abuse NN O O
by IN O O
attackers NNS O O
. . O O

Here RB O O
is VBZ O O
a DT O O
listing NN O O
of IN O O
the DT O O
certs NNS O O
that WDT O O
were VBD O O
commonly RB O O
used VBN O O
to TO O O
sign VB O O
Darkhotel NNP O O
malcode NN O O
, , O O
requiring VBG O O
advanced JJ O O
mathematical JJ O O
capabilities NNS O O
to TO O O
factorize VB O O
the DT O O
keys NNS O O
at IN O O
the DT O O
time NN O O
. . O O

They PRP O O
are VBP O O
not RB O O
the DT O O
only JJ O O
certificates NNS O O
used VBN O O
by IN O O
the DT O O
group NN O O
. . O O

More JJR O O
recent JJ O O
activity NN O O
suggests VBZ O O
that IN O O
the DT O O
group NN O O
has VBZ O O
stolen VBN O O
certificates NNS O O
to TO O O
sign VB O O
their PRP$ O O
code NN O O
. . O O

All DT O O
related JJ O O
cases NNS O O
of IN O O
signed JJ O O
Darkhotel NNP O O
malware NN O O
share VBP O O
the DT O O
same JJ O O
Root NN O O
Certificate NNP O O
Authority NNP O O
and CC O O
Intermediate NNP O O
Certificate NNP O O
Authority NNP O O
that WDT O O
issued VBD O O
certificates NNS O O
with IN O O
weak JJ O O
md5 NN O O
keys NNS O O
( CD O O
RSA NN O O
512 CD O O
bits NNS O O
) CD O O
. . O O

We PRP O O
are VBP O O
confident JJ O O
that IN O O
our PRP$ O O
Darkhotel NNP O O
threat NN O O
actor NN O O
fraudulently RB O O
duplicated VBD O O
these DT O O
certificates NNS O O
to TO O O
sign VB O O
its PRP$ O O
malware NN O O
. . O O

These DT O O
keys NNS O O
were VBD O O
not RB O O
stolen VBN O O
. . O O

Many JJ O O
of IN O O
the DT O O
certificates NNS O O
were VBD O O
noted VBN O O
in IN O O
a DT O O
2011 CD O O
FoxÂ­IT NN O O
post NN O O
'' '' O O
RSAÂ­512 NN O O
Certificates NNS O O
Abused VBN O O
in IN O O
the DT O O
Wild NNP O O
'' '' O O
. . O O

To TO O O
further RB O O
support VB O O
this DT O O
speculation NN O O
please VBP O O
note NN O O
the DT O O
nonÂ­specific JJ O O
Microsoft NNP O O
Security NNP O O
Advisory NNP O O
below IN O O
, , O O
the DT O O
Mozilla NNP O O
advisory NN O O
addressing VBG O O
the DT O O
issue NN O O
at IN O O
the DT O O
time NN O O
, , O O
and CC O O
the DT O O
Entrust JJ O O
responses NNS O O
. . O O

From IN O O
Microsoft NNP O O
's POS O O
security NN O O
advisory NN O O
from IN O O
Thursday NNP O O
, , O O
November NNP O O
10 CD O O
, , O O
2011 CD O O
: : O O
'' '' O O
Microsoft NNP O O
is VBZ O O
aware JJ O O
that IN O O
DigiCert NNP O O
Sdn NNP O O
. . O O

Bhd NNP O O
, , O O
a DT O O
Malaysian JJ O O
subordinate JJ O O
certifica- NN O O
tion NN O O
authority NN O O
( NNP O O
CA NNP O O
) NNP O O
under IN O O
Entrust NNP O O
and CC O O
GTE NNP O O
CyberTrust NNP O O
, , O O
has VBZ O O
issued VBN O O
22 CD O O
certifi- NN O O
cates VBZ O O
with IN O O
weak JJ O O
512 CD O O
bit NN O O
keys NNS O O
. . O O

These DT O O
weak JJ O O
encryption NN O O
keys NNS O O
, , O O
when WRB O O
broken VBN O O
, , O O
could MD O O
allow VB O O
an DT B-Entity 1
attacker NN I-Entity O
to TO O O
use VB B-Action 2
the DT B-Entity 3
certificates NNS I-Entity O
fraudulently RB B-Entity 4
to TO B-Modifier 5
spoof NN B-Entity 6
content NN I-Entity O
, , O O
perform VB B-Entity 7
phishing NN I-Entity O
attacks NNS I-Entity O
, , O O
or CC O O
perform VB B-Entity 8
manÂ­inÂ­theÂ­middle NN I-Entity O
attacks NNS I-Entity O
against IN I-Entity O
all DT I-Entity O
Web NN I-Entity O
browser NN I-Entity O
users NNS I-Entity O
including VBG I-Entity O
users NNS I-Entity O
of IN I-Entity O
Internet NNP I-Entity O
Explorer NNP I-Entity O
. . O O

While IN O O
this DT O O
is VBZ O O
not RB O O
a DT O O
vulnerability NN O O
in IN O O
a DT O O
Microsoft NNP O O
product NN O O
, , O O
this DT O O
issue NN O O
affects VBZ O O
all DT O O
supported VBN O O
releases NNS O O
of IN O O
Microsoft NNP O O
Windows NNP O O
. . O O

There EX O O
is VBZ O O
no DT O O
indication NN O O
that IN O O
any DT O O
certificates NNS O O
were VBD O O
issued VBN O O
fraudulently RB O O
. . O O

Instead RB O O
, , O O
cryptographically RB O O
weak JJ O O
keys NNS O O
have VBP O O
allowed VBN O O
some DT O O
of IN O O
the DT O O
certificates NNS O O
to TO O O
be VB O O
dupli- JJ O O
cated VBN O O
and CC O O
used VBN O O
in IN O O
a DT O O
fraudulent JJ O O
manner NN O O
. . O O

Microsoft NNP O O
is VBZ O O
providing VBG O O
an DT O O
update VB O O
for IN O O
all DT O O
supported VBN O O
releases NNS O O
of IN O O
Microsoft NNP O O
Windows NNP O O
that WDT O O
revokes VBZ O O
the DT O O
trust NN O O
in IN O O
DigiCert NNP O O
Sdn NNP O O
. . O O

Bhd NNP O O
. . O O

The DT O O
update VBP O O
revokes VBZ O O
the DT O O
trust NN O O
of IN O O
the DT O O
following JJ O O
two CD O O
intermediate JJ O O
CA NNP O O
certificates NNS O O
: : O O
Digisign NNP O O
Server NN O O
ID NNP O O
â€“ NNP O O
( NNP O O
Enrich NNP O O
) NNP O O
, , O O
issued VBN O O
by IN O O
Entrust.net NN O O
Certification NN O O
Authority NNP O O
( NNP O O
2048 CD O O
) NNP O O
Digisign NNP O O
Server NN O O
ID NNP O O
( NNP O O
Enrich NNP O O
) NNP O O
, , O O
issued VBN O O
by IN O O
GTE NNP O O
CyberTrust NNP O O
Global NNP O O
Root NN O O
'' '' O O
From IN O O
Mozilla NNP O O
's POS O O
2011 CD O O
response NN O O
: : O O
'' '' O O
While IN O O
there EX O O
is VBZ O O
no DT O O
indication NN O O
they PRP O O
were VBD O O
issued VBN O O
fraudulently RB O O
, , O O
the DT O O
weak JJ O O
keys NNS O O
have VBP O O
allowed VBN O O
the DT O O
certificates NNS O O
to TO O O
be VB O O
compromised VBN O O
. . O O

Furthermore RB O O
, , O O
certificates NNS O O
from IN O O
this DT O O
CA NNP O O
contain VBP O O
several JJ O O
technical JJ O O
issues NNS O O
. . O O

They PRP O O
lack VBP O O
an DT O O
EKU NNP O O
extension NN O O
specifying VBG O O
their PRP$ O O
intended JJ O O
usage NN O O
and CC O O
they PRP O O
have VBP O O
been VBN O O
issued VBN O O
without IN O O
revocation NN O O
information NN O O
. . O O

'' '' O O
From IN O O
Entrust NNP O O
's POS O O
response NN O O
: : O O
'' '' O O
There EX O O
is VBZ O O
no DT O O
evidence NN O O
that IN O O
the DT O O
Digicert NNP O O
Malaysia NNP O O
certificate NN O O
authorities NNS O O
have VBP O O
been VBN O O
compromised VBN O O
. . O O

'' '' O O
Here RB O O
are VBP O O
some DT O O
notes NNS O O
on IN O O
the DT O O
costs NNS O O
and CC O O
technical JJ O O
requirements NNS O O
of IN O O
attacking VBG O O
these DT O O
certificates NNS O O
. . O O

The DT O O
computing NN O O
power NN O O
required VBN O O
to TO O O
crack VB O O
and CC O O
factor VB O O
an DT O O
RSA NN O O
512 CD O O
bit NN O O
key NN O O
was VBD O O
$ $ O O
5000 CD O O
and CC O O
the DT O O
period NN O O
of IN O O
time NN O O
required VBN O O
was VBD O O
about IN O O
2 CD O O
weeks NNS O O
. . O O

( NN O O
see VBP O O
http JJ O O
: : O O
//lukenotricks NNS O O
. . O O

blogspot.co.at/2010/03/rsaÂ­512Â­factoringÂ­serviceÂ­twoÂ­weeks.html FW O O
) FW O O
In IN O O
October NNP O O
2012 CD O O
, , O O
Tom NNP O O
Ritter NNP O O
reported VBD O O
that IN O O
it PRP O O
would MD O O
cost VB O O
about IN O O
$ $ O O
120Â­- CD O O
$ $ O O
150 CD O O
, , O O
per- JJ O O
haps NNS O O
even RB O O
as RB O O
little JJ O O
as IN O O
$ $ O O
75 CD O O
. . O O

Going VBG O O
even RB O O
further RBR O O
back RB O O
, , O O
there EX O O
was VBD O O
much JJ O O
discussion NN O O
about IN O O
the DT O O
technical JJ O O
meth- FW O O
ods FW O O
of IN O O
cracking VBG O O
these DT O O
keys NNS O O
: : O O
DJ NNP O O
Bernstein NNP O O
's POS O O
2001 CD O O
paper NN O O
on IN O O
building VBG O O
a DT O O
machine NN O O
reducing VBG O O
the DT O O
cost NN O O
of IN O O
integer NN O O
factorization NN O O
with IN O O
Number NNP O O
Field NNP O O
Sieve NNP O O
techniques NNS O O
, , O O
breaking VBG O O
1024 CD O O
bit NN O O
RSA NN O O
keys NNS O O
. . O O

RSA NNP O O
's POS O O
reaction NN O O
and CC O O
2002 CD O O
statement NN O O
on IN O O
whether IN O O
or CC O O
not RB O O
1024 CD O O
bit NN O O
RSA NN O O
keys NNS O O
are VBP O O
broken VBN O O
: : O O
'' '' O O
NIST NNP O O
offered VBD O O
a DT O O
table NN O O
of IN O O
proposed VBN O O
key JJ O O
sizes NNS O O
for IN O O
discussion NN O O
at IN O O
its PRP$ O O
key JJ O O
man- NN O O
agement NN O O
workshop NN O O
in IN O O
November NNP O O
2001 CD O O
[ NN O O
7 CD O O
] NN O O
. . O O

For IN O O
data NNS O O
that WDT O O
needs VBZ O O
to TO O O
be VB O O
protected VBN O O
no RB O O
later RB O O
than IN O O
the DT O O
year NN O O
2015 CD O O
, , O O
the DT O O
table NN O O
indicates VBZ O O
that IN O O
the DT O O
RSA NN O O
key JJ O O
size NN O O
should MD O O
be VB O O
at IN O O
least JJS O O
1024 CD O O
bits NNS O O
. . O O

For IN O O
data NNS O O
that WDT O O
needs VBZ O O
to TO O O
be VB O O
protected VBN O O
longer RB O O
, , O O
the DT O O
key JJ O O
size NN O O
should MD O O
be VB O O
at IN O O
least JJS O O
2048 CD O O
bits NNS O O
. . O O

'' '' O O
Recent JJ O O
Tapaoux NN O O
attacks NNS O O
and CC O O
backdoors NNS O O
include VBP O O
malware NN O O
signed VBN O O
with IN O O
strong JJ O O
SHA1/RSA NN O O
2048 CD O O
bit NN O O
certificates NNS O O
, , O O
suggesting VBG O O
certificate NN O O
theft NN O O
. . O O

One CD B-Entity 1
of IN I-Entity O
the DT I-Entity O
most RBS I-Entity O
interesting JJ I-Entity O
components NNS I-Entity O
that IN I-Entity O
we PRP I-Entity O
discovered VBD I-Entity O
as IN I-Entity O
a DT I-Entity O
part NN I-Entity O
of IN I-Entity O
this DT I-Entity O
cam- FW I-Entity O
paign FW I-Entity O
was VBD B-Action 2
the DT B-Entity 3
use NN I-Entity O
of IN I-Entity O
a DT I-Entity O
digitallyÂ­signed JJ I-Entity O
advanced JJ I-Entity O
keylogger NN I-Entity O
. . O O

It PRP O O
is VBZ O O
clean JJ O O
, , O O
wellÂ­written NN O O
, , O O
kernel NN O O
level NN O O
malcode NN O O
. . O O

The DT O O
languages NNS O O
of IN O O
its PRP$ O O
strings NNS O O
are VBP O O
a DT O O
mix NN O O
of IN O O
English NNP O O
and CC O O
Korean NNP O O
. . O O

It PRP O O
is VBZ O O
signed VBN O O
with IN O O
the DT O O
familiar JJ O O
'' '' O O
belinda.jablonski FW O O
@ SYM O O
syniverse.com NNP O O
'' '' O O
digital JJ O O
certificate NN O O
. . O O

This DT B-Entity 1
keylogger NN I-Entity O
is VBZ B-Action 2
dropped VBN I-Action O
by IN B-Modifier 3
code NN B-Entity 4
running VBG I-Entity O
within IN I-Entity O
svchost.exe NN I-Entity O
on IN I-Entity O
WinXP NN I-Entity O
SP3 NN I-Entity O
, , O O
which WDT O O
maintains VBZ O O
an DT O O
interesting JJ O O
debug NN O O
string NN O O
: : O O
It PRP O O
probably RB O O
was VBD O O
developed VBN O O
as IN O O
a DT O O
part NN O O
of IN O O
a DT O O
mid-to-late JJ O O
2009 CD O O
project NN O O
: : O O
e LS O O
: : O O
\project\2009\x\totalsource\32bit\ndiskpro\src\ioman.c NN O O
This DT B-Entity 5
driver NN I-Entity O
package NN I-Entity O
is VBZ B-Action 6
built VBN I-Action O
to TO B-Modifier 7
resemble VB B-Entity 8
a DT I-Entity O
legitimate JJ I-Entity O
low-level JJ I-Entity O
Microsoft NNP I-Entity O
system NN I-Entity O
device NN I-Entity O
. . O O

It PRP B-Entity 1
is VBZ B-Action 2
installed VBN I-Action O
as IN B-Modifier 3
a DT B-Entity 4
system NN I-Entity O
kernel NN I-Entity O
driver NN I-Entity O
'' '' I-Entity O
Ndiskpro NNP I-Entity O
'' '' I-Entity O
service NN I-Entity O
, , O O
described VBN O O
as IN O O
a DT O O
'' '' O O
Microcode NNP O O
Update NNP O O
Device NNP O O
'' '' O O
. . O O

It PRP O O
is VBZ O O
slightly RB O O
surprising JJ O O
that IN O O
no DT O O
rootkit NN O O
functionality NN O O
hides VBZ O O
this DT O O
service NN O O
: : O O
When WRB O O
loaded VBN O O
, , O O
the DT B-Entity 1
NDISKPRO.SYS NN I-Entity O
driver NN I-Entity O
hooks NNS B-Action 2
both CC B-Entity 3
INT FW I-Entity O
0x01 FW I-Entity O
and CC I-Entity O
INT FW I-Entity O
0xff FW I-Entity O
, , O O
and CC O O
retrieves VBZ B-Action 4
keystroke NN B-Entity 5
data NNS I-Entity O
directly RB B-Modifier 6
from IN I-Modifier O
port JJ B-Entity 7
0x60 NN I-Entity O
, , I-Entity O
the DT I-Entity O
motherboard NN I-Entity O
keyboard NN I-Entity O
con- NN I-Entity O
troller NN I-Entity O
itself PRP I-Entity O
. . O O

It PRP O O
buffers VBZ O O
, , O O
then RB O O
communicates VBZ O O
logged VBN O O
user NN O O
data NNS O O
to TO O O
the DT O O
running VBG O O
user NN O O
mode NN O O
component NN O O
. . O O

This DT B-Entity 1
component NN I-Entity O
then RB O O
encrypts VBZ B-Action 2
and CC O O
writes VBZ B-Action 3
the DT B-Entity 4
retrieved VBN I-Entity O
values NNS I-Entity O
ondisk VBP I-Entity O
to TO B-Modifier 5
a DT B-Entity 6
randomly RB I-Entity O
named VBN I-Entity O
.tmp NN I-Entity O
, , I-Entity O
file NN I-Entity O
like IN I-Entity O
ffffz07131101.tmp NN I-Entity O
. . O O

This DT O O
file NN O O
is VBZ O O
located JJ O O
in IN O O
the DT O O
same JJ O O
directory NN O O
as IN O O
the DT B-Entity 1
original JJ I-Entity O
dropper NN I-Entity O
, , O O
which WDT O O
maintains VBZ B-Action 2
persistence NN B-Entity 3
across IN B-Modifier 4
reboots NNS B-Entity 5
with IN B-Modifier 6
a DT B-Entity 7
simple JJ I-Entity O
addition NN I-Entity O
to TO I-Entity O
the DT I-Entity O
HKCU NNP I-Entity O
run NN I-Entity O
key NN I-Entity O
. . O O

This DT B-Entity 1
keylogger NN I-Entity O
module NN I-Entity O
encrypts NNS B-Action 2
and CC O O
stores NNS B-Action 3
gathered VBD B-Entity 4
data NNS I-Entity O
in IN B-Modifier 5
a DT B-Entity 6
log NN I-Entity O
file NN I-Entity O
, , O O
as IN O O
men- NN O O
tioned VBD O O
previously RB O O
. . O O

Its PRP$ O O
encryption NN O O
algorithm NN O O
is VBZ O O
similar JJ O O
to TO O O
RC4 NN O O
. . O O

The DT O O
interesting JJ O O
part NN O O
is VBZ O O
that IN O O
the DT O O
module NN O O
randomly RB O O
generates VBZ O O
the DT O O
key NN O O
and CC O O
stores NNS O O
it PRP O O
in IN O O
an DT O O
unexpected JJ O O
place NN O O
: : O O
in IN O O
the DT O O
middle NN O O
of IN O O
the DT O O
log NN O O
file NN O O
name NN O O
. . O O

Hence RB O O
, , O O
the DT O O
numeric JJ O O
part NN O O
of IN O O
the DT O O
filename NN O O
is VBZ O O
used VBN O O
as IN O O
a DT O O
seed NN O O
for IN O O
the DT O O
pseudorandom NN O O
number NN O O
generator NN O O
. . O O

The DT O O
rand NN O O
function NN O O
is VBZ O O
statically RB O O
linked VBN O O
to TO O O
ensure VB O O
same JJ O O
results NNS O O
on IN O O
different JJ O O
computers NNS O O
. . O O

The DT O O
Darkhotel NNP O O
toolset NN O O
consists VBZ O O
of IN O O
multiple JJ O O
components NNS O O
that WDT O O
have VBP O O
been VBN O O
slightly RB O O
modified VBN O O
over IN O O
time NN O O
. . O O

These DT B-Entity 1
tools NNS I-Entity O
are VBP B-Action 2
dropped VBN I-Action O
by IN O O
hotel NN B-Entity 3
installers NNS I-Entity O
spoofing VBG B-Action 4
legiti- JJ B-Entity 5
mate NN I-Entity O
software NN I-Entity O
installers NNS I-Entity O
, , O O
bound VBN B-Action 6
within IN B-Modifier 7
torrent NN B-Entity 8
bundles NNS I-Entity O
, , O O
or CC O O
dropped VBN B-Action 9
by IN O O
exploits NNS B-Entity 10
or CC O O
hypertext NN B-Action 11
linked VBN I-Action O
from IN B-Modifier 12
spear-phishing JJ B-Entity 13
emails NNS I-Entity O
. . O O

More JJR B-Entity 1
advanced JJ I-Entity O
tools NNS I-Entity O
, , I-Entity O
like IN I-Entity O
the DT I-Entity O
keylogger NN I-Entity O
decribed VBD I-Entity O
above IN I-Entity O
, , O O
are VBP B-Action 2
later RB I-Action O
downloaded VBN I-Action O
to TO B-Modifier 3
the DT B-Entity 4
victim NN I-Entity O
system NN I-Entity O
by IN O O
one CD B-Entity 5
of IN I-Entity O
these DT I-Entity O
implants NNS I-Entity O
. . O O

In IN O O
a DT O O
recent JJ O O
case NN O O
, , O O
word NN B-Entity 1
docs FW I-Entity O
embed- FW B-Action 2
ded VBN I-Action O
with IN B-Modifier 3
0-day JJ B-Entity 4
flash NN I-Entity O
swf NN I-Entity O
files NNS I-Entity O
either CC O O
dropped VBD B-Action 5
these DT B-Entity 6
backdoors NNS I-Entity O
or CC O O
downloaded VBN B-Action 7
and CC O O
executed VBN B-Action 8
backdoors NNS B-Entity 9
from IN B-Modifier 10
remote JJ B-Entity 11
web NN I-Entity O
servers NNS I-Entity O
. . O O

These DT B-Entity 1
tools NNS I-Entity O
pull VBP B-Action 2
down RP I-Action O
the DT B-Entity 3
keylog- FW I-Entity O
ger FW I-Entity O
, , O O
steal VBP B-Action 4
information NN B-Entity 5
from IN B-Modifier 6
the DT B-Entity 7
system NN I-Entity O
, , O O
or CC O O
download VB B-Action 8
other JJ B-Entity 9
tools NNS I-Entity O
. . O O

The DT O O
most RBS O O
interesting JJ O O
behaviors NNS O O
of IN O O
these DT O O
components NNS O O
include VBP O O
This DT O O
module NN O O
is VBZ O O
quite RB O O
small JJ O O
( FW O O
27Kb FW O O
) FW O O
and CC O O
comes VBZ O O
as IN O O
a DT O O
part NN O O
of IN O O
WinRar NNP B-Entity 1
SFX NNP I-Entity O
file NN I-Entity O
that WDT O O
drops VBZ B-Action 2
and CC O O
starts VBZ B-Action 3
the DT B-Entity 4
module NN I-Entity O
from IN B-Modifier 5
% NN B-Entity 6
APPDATA CD I-Entity O
% NN I-Entity O
\Microsoft\Crypto\DES64v7\msieckc.exe NN I-Entity O
. . O O

This DT B-Entity 1
module NN I-Entity O
is VBZ O O
designed VBN O O
to TO O O
update VB B-Action 2
malicious JJ B-Entity 3
components NNS I-Entity O
through IN B-Modifier 4
recurring VBG B-Entity 5
checks NNS I-Entity O
at IN I-Entity O
the DT I-Entity O
C NN I-Entity O
& CC I-Entity O
C NN I-Entity O
server NN I-Entity O
. . O O

It PRP B-Entity 1
is VBZ O O
also RB O O
capable JJ O O
of IN O O
removing VBG B-Action 2
some DT B-Entity 3
older JJR I-Entity O
components NNS I-Entity O
, , O O
the DT O O
names NNS O O
of IN O O
which WDT O O
are VBP O O
hardcoded VBN O O
in IN O O
the DT O O
body NN O O
of IN O O
the DT O O
malware NN O O
. . O O

The DT B-Entity 1
module NN I-Entity O
adds VBZ B-Action 2
autorun JJ B-Entity 3
registry NN I-Entity O
settings NNS I-Entity O
to TO B-Modifier 4
enable VB B-Entity 5
an DT I-Entity O
automatic JJ I-Entity O
start NN I-Entity O
during IN I-Entity O
system NN I-Entity O
boot NN I-Entity O
. . O O

One CD B-Entity 1
of IN I-Entity O
the DT I-Entity O
most RBS I-Entity O
interesting JJ I-Entity O
functions NNS I-Entity O
of IN I-Entity O
this DT I-Entity O
executable JJ I-Entity O
is VBZ B-Action 2
its PRP$ B-Entity 3
unusual JJ I-Entity O
delay NN I-Entity O
and CC I-Entity O
persistence NN I-Entity O
. . O O

If IN O O
a DT O O
special JJ O O
file NN O O
exists VBZ O O
on IN O O
the DT O O
system NN O O
, , O O
the DT O O
module NN O O
will MD O O
not RB O O
start VB O O
calling VBG O O
back RB O O
to TO O O
C NN O O
& CC O O
C NN O O
server NN O O
until IN O O
the DT O O
special JJ O O
file NN O O
is VBZ O O
180 CD O O
days NNS O O
old JJ O O
. . O O

So RB O O
, , O O
if IN O O
some DT O O
other JJ O O
critical JJ O O
malicious JJ O O
component NN O O
was VBD O O
removed VBN O O
during IN O O
this DT O O
period NN O O
, , O O
current JJ B-Entity 1
module NN I-Entity O
backs VBZ B-Action 2
up RP I-Action O
and CC I-Action O
restores VBZ I-Action O
access NN B-Entity 3
to TO I-Entity O
the DT I-Entity O
system NN I-Entity O
within IN I-Entity O
6 CD I-Entity O
months NNS I-Entity O
. . O O

The DT B-Entity 1
component NN I-Entity O
gathers VBZ B-Action 2
system NN B-Entity 3
information NN I-Entity O
and CC O O
sends VBZ B-Action 4
it PRP B-Entity 5
to TO B-Modifier 6
the DT B-Entity 7
Darkhotel NNP I-Entity O
com- NN I-Entity O
mand NN I-Entity O
and CC I-Entity O
control NN I-Entity O
servers NNS I-Entity O
as IN O O
detailed VBN O O
in IN O O
Appendix NNP O O
D. NNP O O
This NNP O O
module NN O O
is VBZ O O
relatively RB O O
large JJ O O
( FW O O
455Kb FW O O
) FW O O
and CC O O
comes VBZ O O
as IN O O
a DT O O
part NN O O
of IN O O
a DT B-Entity 8
WinRar NNP I-Entity O
SFX NNP I-Entity O
file NN I-Entity O
that WDT O O
drops VBZ B-Action 9
and CC O O
starts VBZ B-Action 10
the DT B-Entity 11
module NN I-Entity O
from IN B-Modifier 12
% NN B-Entity 13
APPDATA CD I-Entity O
% NN I-Entity O
\Microsoft\Display\DmaUp3 NN I-Entity O
. . I-Entity O
exe NN I-Entity O
. . O O

The DT O O
main JJ O O
purpose NN O O
of IN O O
the DT B-Entity 1
module NN I-Entity O
is VBZ O O
to TO O O
collect VB B-Action 2
various JJ B-Entity 3
secrets NNS I-Entity O
stored VBN I-Entity O
on IN I-Entity O
a DT I-Entity O
lo- FW I-Entity O
cal FW I-Entity O
system NN I-Entity O
and CC O O
upload VB B-Action 4
them PRP B-Entity 5
to TO B-Modifier 6
Darkhotel NNP B-Entity 7
command NN I-Entity O
and CC I-Entity O
control NN I-Entity O
servers NNS I-Entity O
: : O O
This DT B-Entity 8
module NN I-Entity O
is VBZ O O
designed VBN O O
to TO O O
terminate VB B-Action 9
itself PRP B-Entity 10
on IN B-Modifier 11
Windows NNP B-Entity 12
with IN I-Entity O
the DT I-Entity O
system NN I-Entity O
de- NN I-Entity O
fault NN I-Entity O
codepage NN I-Entity O
set VBN I-Entity O
to TO I-Entity O
Korean NNP I-Entity O
. . O O

This DT O O
malware NN O O
is VBZ O O
220Kb NN O O
in IN O O
size NN O O
. . O O

It PRP O O
was VBD O O
built VBN O O
as IN O O
MFC NN O O
framework NN O O
application NN O O
with IN O O
a DT B-Entity 1
lot NN I-Entity O
of IN I-Entity O
extra JJ I-Entity O
calls NNS I-Entity O
that WDT O O
should MD O O
have VB O O
complicated VBN B-Action 2
the DT B-Entity 3
analysis NN I-Entity O
of IN I-Entity O
the DT I-Entity O
sample NN I-Entity O
. . O O

It PRP B-Entity 1
mim- FW B-Action 2
ics FW I-Action O
a DT B-Entity 3
GUI NNP I-Entity O
desktop NN I-Entity O
application NN I-Entity O
but CC O O
it PRP O O
does VBZ O O
not RB O O
create VB O O
any DT O O
visible JJ O O
windows NNS O O
or CC O O
dialogs NNS O O
to TO O O
interact VB O O
with IN O O
local JJ O O
users NNS O O
. . O O

The DT B-Entity 1
Trojan NNP I-Entity O
collects VBZ B-Action 2
data NNS B-Entity 3
about IN B-Modifier 4
the DT B-Entity 5
system NN I-Entity O
and CC O O
antiÂ­ FW B-Entity 6
malware FW I-Entity O
software NN I-Entity O
installed VBN I-Entity O
on IN I-Entity O
it PRP I-Entity O
, , O O
and CC O O
uploads VBZ B-Action 7
that IN B-Entity 8
data NNS I-Entity O
to TO B-Modifier 9
Darkhotel NNP B-Entity 10
command NN I-Entity O
and CC I-Entity O
control NN I-Entity O
servers NNS I-Entity O
. . O O

More JJR O O
technical JJ O O
details NNS O O
are VBP O O
provided VBN O O
in IN O O
Appendix NNP O O
D. NNP O O
This NNP O O
malware NN O O
is VBZ O O
63kb JJ O O
in IN O O
size NN O O
. . O O

It PRP B-Entity 1
is VBZ B-Action 2
bound VBN I-Action O
to TO B-Modifier 3
a DT B-Entity 4
variety NN I-Entity O
of IN I-Entity O
other JJ I-Entity O
software NN I-Entity O
packages NNS I-Entity O
that WDT I-Entity O
vary VBP I-Entity O
in IN I-Entity O
name NN I-Entity O
, , O O
but CC O O
the DT O O
host NN O O
package NN O O
is VBZ O O
consistently RB O O
detected VBN O O
as IN O O
'' '' O O
Virus.Win32 NN O O
. . O O

Pioneer.dx NN O O
'' '' O O
. . O O

It PRP B-Entity 1
drops VBZ B-Action 2
the DT B-Entity 3
igfxext.exe NN I-Entity O
'' '' I-Entity O
selective JJ I-Entity O
infector NN I-Entity O
'' '' I-Entity O
component NN I-Entity O
to TO B-Modifier 4
disk NN B-Entity 5
and CC O O
runs VBZ B-Action 6
it PRP B-Entity 7
. . O O

This DT B-Entity 1
component NN I-Entity O
is VBZ O O
a DT O O
virus NN O O
, , O O
and CC O O
is VBZ O O
used VBN O O
to TO O O
selectively RB O O
infiltrate VB B-Action 2
into IN B-Modifier 3
other JJ B-Entity 4
comput- NNP I-Entity O
ers NNPS I-Entity O
via IN B-Modifier 5
USB JJ B-Entity 6
or CC O O
network NN B-Entity 7
shares NNS I-Entity O
. . O O

First NNP O O
, , O O
the DT B-Entity 1
virus NN I-Entity O
retrieves VBZ B-Action 2
all DT B-Entity 3
available JJ I-Entity O
disks NNS I-Entity O
and CC O O
starting VBG O O
from IN O O
disk NN O O
number NN O O
4 CD O O
( NN O O
D NN O O
: : O O
\ FW O O
) FW O O
to TO O O
disk NN O O
number NN O O
20 CD O O
( NN O O
Z NN O O
: : O O
\ FW O O
) FW O O
, , O O
finds VBZ B-Action 4
executable JJ B-Entity 5
files NNS I-Entity O
and CC O O
infects VBZ B-Action 6
them PRP B-Entity 7
. . O O

The DT B-Entity 1
code NN I-Entity O
simply RB O O
brute JJ B-Action 2
forces NNS I-Action O
the DT B-Entity 3
list NN I-Entity O
of IN I-Entity O
mapped VBN I-Entity O
removable JJ I-Entity O
drives NNS I-Entity O
. . O O

During IN O O
its PRP$ O O
infection NN O O
routine NN O O
, , O O
the DT B-Entity 1
infector NN I-Entity O
changes VBZ B-Action 2
the DT B-Entity 3
entrypoint NN I-Entity O
of IN I-Entity O
executable JJ I-Entity O
files NNS I-Entity O
, , O O
creates VBZ B-Action 4
an DT B-Entity 5
.rdat NN I-Entity O
section NN I-Entity O
, , O O
and CC O O
inserts NNS B-Action 6
a DT B-Entity 7
small JJ I-Entity O
loader NN I-Entity O
in IN B-Modifier 8
the DT B-Entity 9
section NN I-Entity O
, , O O
then RB O O
puts VBZ B-Action 10
its PRP$ B-Entity 11
main JJ I-Entity O
payload NN I-Entity O
in IN B-Modifier 12
the DT B-Entity 13
overlay NN I-Entity O
. . O O

Every DT B-Entity 1
infected JJ I-Entity O
file NN I-Entity O
has VBZ B-Action 2
functionality NN B-Entity 3
described VBN I-Entity O
in IN I-Entity O
TrojanÂ­Dropper NNP I-Entity O
& CC I-Entity O
Injector NNP I-Entity O
section NN I-Entity O
, , O O
so IN O O
it PRP B-Entity 4
can MD O O
collect VB B-Action 5
information NN B-Entity 6
about IN I-Entity O
the DT I-Entity O
comput- FW I-Entity O
er FW I-Entity O
, , O O
send VB B-Action 7
it PRP B-Entity 8
to TO B-Modifier 9
the DT B-Entity 10
C2 NN I-Entity O
and CC O O
download VB B-Action 11
other JJ B-Entity 12
Darkhotel NNP I-Entity O
components NNS I-Entity O
as IN B-Modifier 13
commanded VBN B-Entity 14
. . O O

Observed VBD O O
downloaded VBN O O
components NNS O O
are VBP O O
signed VBN O O
with IN O O
a DT O O
familiar JJ O O
expired VBN O O
certificate NN O O
from IN O O
www.esupplychain.com.tw NN O O
, , O O
issued VBN O O
by IN O O
Cybertrust NNP O O
SureServer NNP O O
CA NNP O O
. . O O

Again NNP O O
, , O O
further JJ O O
technical JJ O O
details NNS O O
are VBP O O
provided VBN O O
in IN O O
Appendix NNP O O
D. NNP O O
Almost RB B-Entity 1
every DT I-Entity O
backdoor NN I-Entity O
in IN I-Entity O
this DT I-Entity O
set NN I-Entity O
maintains VBZ B-Action 2
an DT B-Entity 3
internal JJ I-Entity O
campaign NN I-Entity O
code NN I-Entity O
or CC I-Entity O
id NN I-Entity O
, , I-Entity O
used VBN I-Entity O
in IN I-Entity O
initial JJ I-Entity O
c2 NN I-Entity O
communications NNS I-Entity O
as IN I-Entity O
described VBN I-Entity O
above IN I-Entity O
. . O O

Some DT O O
IDs NNS O O
appear VBP O O
to TO O O
be VB O O
related JJ O O
to TO O O
geographic JJ O O
interests NNS O O
, , O O
others NNS O O
do VBP O O
not RB O O
seem VB O O
obvious JJ O O
. . O O

We PRP O O
gathered VBD O O
a DT O O
list NN O O
of IN O O
Darkhotel NNP O O
campaign NN O O
IDs NNS O O
shown VBN O O
below IN O O
. . O O

Internal JJ O O
IDs NNS O O
and CC O O
c2 NN O O
resources NNS O O
overlap VBP O O
across IN O O
these DT O O
com- JJ O O
ponents NNS O O
, , O O
there EX O O
is VBZ O O
no DT O O
pattern NN O O
of IN O O
distribution NN O O
according VBG O O
to TO O O
connectback NN O O
resources NNS O O
. . O O

The DT O O
most RBS O O
common JJ O O
id NN O O
is VBZ O O
'' '' O O
DEXT87 NN O O
'' '' O O
: : O O
This DT O O
infrastructure NN O O
team NN O O
appears VBZ O O
to TO O O
employ VB O O
a DT O O
lesser JJR O O
skillset NN O O
than IN O O
top JJ O O
notch NN O O
campaigns NNS O O
, , O O
maintaining VBG O O
weak JJ O O
server NN O O
configurations NNS O O
with IN O O
limited JJ O O
monitoring NN O O
and CC O O
defensive JJ O O
reactions NNS O O
, , O O
and CC O O
making VBG O O
some DT O O
simple JJ O O
mistakes NNS O O
. . O O

However RB O O
, , O O
they PRP O O
are VBP O O
ef- FW O O
fective FW O O
at IN O O
maintaining VBG O O
a DT O O
fully RB O O
available JJ O O
infrastructure NN O O
to TO O O
support VB O O
new JJ O O
and CC O O
existing JJ O O
infections NNS O O
. . O O

Overall NNP O O
, , O O
victims NNS O O
in IN O O
our PRP$ O O
sinkhole NN O O
logs NNS O O
and CC O O
KSN NN O O
data NNS O O
were VBD O O
found VBN O O
across IN O O
the DT O O
globe NN O O
, , O O
with IN O O
the DT O O
majority NN O O
in IN O O
Japan NNP O O
, , O O
Taiwan NNP O O
, , O O
China NNP O O
, , O O
Russia NNP O O
, , O O
Korea NNP O O
and CC O O
Hong NNP O O
Kong NNP O O
. . O O

The DT O O
following VBG O O
C NN O O
& CC O O
C NN O O
domains NNS O O
have VBP O O
been VBN O O
sinkholed VBN O O
and CC O O
redirected VBN O O
to TO O O
the DT O O
Kaspersky NNP O O
Sinkhole NNP O O
Server NN O O
Our NNP O O
Kaspersky NNP O O
Security NNP O O
Network NNP O O
detected VBD O O
Darkhotel NNP O O
infections NNS O O
across IN O O
thousands NNS O O
of IN O O
machines NNS O O
, , O O
mostly RB O O
related JJ O O
to TO O O
the DT O O
Darkhotel NNP O O
p2p NN O O
campaigns NNS O O
. . O O

These DT O O
geolocation NN O O
estimates NNS O O
probably RB O O
provide VBP O O
the DT O O
most RBS O O
accurate JJ O O
picture NN O O
of IN O O
where WRB O O
Darkhotel NN O O
activity NN O O
is VBZ O O
occurring VBG O O
. . O O

Here RB O O
is VBZ O O
a DT O O
pie NN O O
chart NN O O
to TO O O
better RBR O O
visualize VB O O
the DT O O
proportions NNS O O
of IN O O
attack NN O O
activity NN O O
throughout IN O O
the DT O O
world NN O O
. . O O

As IN O O
you PRP O O
can MD O O
see VB O O
, , O O
over IN O O
90 CD O O
% NN O O
of IN O O
it PRP O O
occurs VBZ O O
in IN O O
the DT O O
top JJ O O
five CD O O
countries NNS O O
: : O O
Japan NNP O O
, , O O
followed VBN O O
by IN O O
Taiwan NNP O O
, , O O
China NNP O O
, , O O
Russia NNP O O
and CC O O
Korea NNP O O
. . O O

Because IN O O
the DT B-Entity 1
operators NNS I-Entity O
very RB O O
actively RB O O
build VB B-Action 2
up RP I-Action O
new JJ B-Entity 3
command NN I-Entity O
and CC I-Entity O
control VB I-Entity O
serv- NNP I-Entity O
ers NNPS I-Entity O
, , O O
it PRP O O
is VBZ O O
difficult JJ O O
to TO O O
sinkhole VB O O
enough JJ O O
domains NNS O O
to TO O O
get VB O O
an DT O O
accurate JJ O O
overall JJ O O
picture NN O O
of IN O O
victim NN O O
system NN O O
location NN O O
based VBN O O
on IN O O
this DT O O
data NNS O O
. . O O

Also RB O O
, , O O
many JJ O O
researcher NN O O
systems NNS O O
are VBP O O
connected VBN O O
to TO O O
the DT O O
sinkholed JJ O O
domains NNS O O
. . O O

However RB O O
, , O O
this DT O O
graph NN O O
of IN O O
current JJ O O
sinkhole NN O O
callbacks NNS O O
presents VBZ O O
a DT O O
low JJ O O
confidence NN O O
distribution NN O O
of IN O O
victim NN O O
geolocation NN O O
, , O O
with IN O O
India NNP O O
, , O O
Japan NNP O O
, , O O
Ireland NNP O O
, , O O
Korea NNP O O
, , O O
China NNP O O
and CC O O
Taiwan NNP O O
in IN O O
the DT O O
top JJ O O
slots NNS O O
. . O O

Removing VBG O O
India NNP O O
and CC O O
Ireland NNP O O
, , O O
the DT O O
set NN O O
more RBR O O
closely RB O O
matches VBZ O O
our PRP$ O O
KSN NNP O O
data NNS O O
. . O O

Many JJ B-Entity 1
of IN I-Entity O
these DT I-Entity O
c2s NNS I-Entity O
maintain VBP B-Action 2
a DT B-Entity 3
common JJ I-Entity O
directory NN I-Entity O
path NN I-Entity O
that WDT I-Entity O
serves VBZ I-Entity O
a DT I-Entity O
ddrlog NN I-Entity O
. . O O

The DT O O
ddrlogs NNS O O
appear VBP O O
to TO O O
maintain VB O O
callback NN O O
data NNS O O
that IN O O
the DT O O
attackers NNS O O
want VBP O O
to TO O O
set VB O O
aside RB O O
in IN O O
error NN O O
logs NNS O O
. . O O

Many JJ O O
of IN O O
the DT O O
callback NN O O
URLs NNS O O
have VBP O O
errors NNS O O
, , O O
many JJ O O
are VBP O O
from IN O O
unwanted JJ O O
IP NNP O O
ranges NNS O O
, , O O
and CC O O
others NNS O O
are VBP O O
clearly RB O O
unwanted JJ O O
researcher NN O O
sandbox NN O O
system NN O O
callbacks NNS O O
. . O O

A DT O O
description NN O O
of IN O O
the DT O O
detailed JJ O O
connectback NN O O
URL NN O O
values NNS O O
and CC O O
their PRP$ O O
xor/base64 NN O O
encoding VBG O O
scheme NN O O
is VBZ O O
included VBN O O
in IN O O
the DT O O
'' '' O O
Interesting JJ O O
Malware NN O O
Trojan.Win32.Karba.e NN O O
'' '' O O
technical JJ O O
notes NNS O O
in IN O O
Appendix NNP O O
D. NNP O O
The NNP B-Entity 1
Darkhotel NNP I-Entity O
c2 NN I-Entity O
maintain VBP B-Action 2
these DT B-Entity 3
directory NN I-Entity O
structures NNS I-Entity O
to TO B-Modifier 4
store VB B-Entity 5
and CC I-Entity O
serve VB I-Entity O
ddrlog JJ I-Entity O
content NN I-Entity O
: : O O
The DT O O
following JJ O O
structures NNS O O
appear VBP O O
to TO O O
be VB O O
common JJ O O
across IN O O
servers NNS O O
, , O O
but CC O O
do VBP O O
not RB O O
pro- JJ O O
duce FW O O
ddrlog FW O O
and CC O O
do VBP O O
not RB O O
maintain VB O O
an DT O O
/error/ NN O O
directory NN O O
: : O O
Two CD O O
ddrlog NN O O
files VBZ O O
report NN O O
entries NNS O O
starting VBG O O
January NNP O O
1 CD O O
, , O O
2009 CD O O
at IN O O
9:16 CD O O
a.m. RB O O
All DT O O
of IN O O
the DT O O
logs NNS O O
maintain VBP O O
a DT O O
significant JJ O O
number NN O O
of IN O O
entries NNS O O
, , O O
almost RB O O
50,000 CD O O
, , O O
with IN O O
a DT O O
simple JJ O O
stamp NN O O
'' '' O O
B NN O O
'' '' O O
or CC O O
'' '' O O
L NN O O
'' '' O O
. . O O

Those DT O O
records NNS O O
are VBP O O
formatted VBN O O
in IN O O
the DT O O
following JJ O O
manner NN O O
: : O O
Only RB O O
120 CD O O
IP NNP O O
addresses NNS O O
perform VBP O O
the DT O O
'' '' O O
B NN O O
'' '' O O
checkin NN O O
, , O O
and CC O O
90 CD O O
% NN O O
of IN O O
these DT O O
are VBP O O
from IN O O
the DT O O
range NN O O
150.70.97.x NN O O
. . O O

This DT O O
entire JJ O O
range NN O O
is VBZ O O
owned VBN O O
by IN O O
Trend NNP O O
Micro NNP O O
in IN O O
Tokyo NNP O O
, , O O
JP NNP O O
. . O O

A DT O O
handful NN O O
of IN O O
the DT O O
remaining VBG O O
addresses NNS O O
, , O O
like IN O O
222.150.70.228 CD O O
, , O O
appear VBP O O
to TO O O
come VB O O
from IN O O
other JJ O O
ranges NNS O O
owned VBN O O
by IN O O
Trend NNP O O
Micro NNP O O
in IN O O
JP NNP O O
. . O O

One CD O O
outlier NN O O
comes VBZ O O
from IN O O
an DT O O
El NNP O O
Sal- FW O O
vadoran FW O O
ISP NN O O
, , O O
and CC O O
another DT O O
is VBZ O O
connected VBN O O
to TO O O
a DT O O
Japanese JJ O O
ISP NN O O
. . O O

Approximately RB O O
20,000 CD O O
IP NNP O O
addresses NNS O O
perform VBP O O
the DT O O
'' '' O O
L NN O O
'' '' O O
checkin NN O O
. . O O

Other JJ O O
ddrlogs NNS O O
may MD O O
include VB O O
'' '' O O
A NNP O O
'' '' O O
tags NNS O O
as RB O O
well RB O O
. . O O

The DT O O
'' '' O O
A NN O O
'' '' O O
tag NN O O
labels VBZ O O
unwanted JJ O O
checkins NNS O O
from IN O O
untargeted JJ O O
locations NNS O O
, , O O
like IN O O
Hungary NNP O O
and CC O O
Italy NNP O O
. . O O

The DT O O
'' '' O O
B NN O O
'' '' O O
tag NN O O
labels VBZ O O
unwanted JJ O O
checkins NNS O O
from IN O O
Trend NNP O O
Micro NNP O O
IP NNP O O
ranges NNS O O
. . O O

The DT O O
'' '' O O
L NN O O
'' '' O O
tag NN O O
labels VBZ O O
unwanted JJ O O
checkins NNS O O
from IN O O
a DT O O
variety NN O O
of IN O O
ranges NNS O O
, , O O
but CC O O
includes VBZ O O
odd JJ O O
IP NNP O O
like IN O O
the DT O O
loopback NN O O
address NN O O
, , O O
127.0.0.1 CD O O
, , O O
clearly RB O O
an DT O O
error NN O O
. . O O

Entries NNS O O
in IN O O
these DT O O
logs NNS O O
include VBP O O
callback NN O O
URLs NNS O O
that WDT O O
have VBP O O
spaces NNS O O
and CC O O
unusual JJ O O
charac- NN O O
ters NNS O O
that WDT O O
do VBP O O
not RB O O
conform VB O O
to TO O O
the DT O O
required VBN O O
base64 NN O O
character NN O O
dictionary NN O O
. . O O

Typical JJ O O
main JJ O O
page NN O O
: : O O
For IN O O
begatrendstone.com NNP O O
, , O O
we PRP O O
have VBP O O
the DT O O
following JJ O O
directory NN O O
structure NN O O
: : O O
The DT B-Entity 1
group NN I-Entity O
encrypts VBZ B-Action 2
victim NN B-Entity 3
data NNS I-Entity O
on IN B-Modifier 4
their PRP$ B-Entity 5
servers NNS I-Entity O
with IN B-Modifier 6
single JJ B-Entity 7
user/passkey JJ I-Entity O
combi- JJ I-Entity O
nations NNS I-Entity O
across IN I-Entity O
multiple JJ I-Entity O
victims NNS I-Entity O
. . O O

When WRB O O
an DT O O
unauthorized JJ O O
user NN O O
attempts NNS O O
to TO O O
access VB O O
a DT O O
Darkhotel NNP O O
web NN O O
interface NN O O
for IN O O
victim NN O O
management NN O O
without IN O O
the DT O O
correct JJ O O
passkey NN O O
, , O O
the DT O O
html NN O O
page NN O O
and CC O O
table NN O O
layout NN O O
renders VBZ O O
properly RB O O
, , O O
but CC O O
all PDT O O
the DT O O
data NNS O O
values NNS O O
on IN O O
the DT O O
page NN O O
are VBP O O
returned VBN O O
as IN O O
garbled JJ O O
ciphertext NN O O
. . O O

New JJ B-Entity 1
victim NN I-Entity O
systems NNS I-Entity O
appear VBP O O
to TO O O
be VB B-Action 2
systematically RB I-Action O
vetted VBN I-Action O
. . O O

The DT B-Entity 1
attackers NNS I-Entity O
maintain VBP B-Action 2
a DT B-Entity 3
web NN I-Entity O
interface NN I-Entity O
to TO B-Modifier 4
vet NN B-Entity 5
these DT I-Entity O
new JJ I-Entity O
victim NN I-Entity O
systems NNS I-Entity O
. . O O

The DT B-Entity 1
attackers NNS I-Entity O
first JJ O O
and CC O O
foremost JJ O O
list NN B-Action 2
and CC I-Action O
sort NN I-Action O
victim NN B-Entity 3
systems NNS I-Entity O
according VBG B-Modifier 4
to TO I-Modifier O
their PRP$ B-Entity 5
latest JJS I-Entity O
c2 NN I-Entity O
checkÂ­in NN I-Entity O
. . O O

Collected VBN O O
data NNS O O
probably RB O O
is VBZ O O
presented VBN O O
in IN O O
order NN O O
of IN O O
importance NN O O
: : O O
Here RB O O
is VBZ O O
an DT O O
example NN O O
of IN O O
one CD O O
of IN O O
these DT O O
web NN O O
pages NNS O O
: : O O
Clearly RB O O
, , O O
some DT O O
automated JJ O O
analysis NN O O
activity NN O O
involving VBG O O
researchers NNS O O
' POS O O
sandbox NN O O
tools NNS O O
are VBP O O
filling VBG O O
up RP O O
these DT O O
logs NNS O O
. . O O

From IN O O
June NNP O O
2013 CD O O
to TO O O
April NNP O O
2014 CD O O
( NNP O O
approximately RB O O
an DT O O
11 CD O O
month NN O O
period NN O O
) NN O O
, , O O
in IN O O
only RB O O
15 CD O O
ddrlog NN O O
files NNS O O
, , O O
we PRP O O
observe VBP O O
almost RB O O
7,000 CD O O
connections NNS O O
from IN O O
research NN O O
sandbox NN O O
systems NNS O O
. . O O

The DT O O
network NN O O
connections NNS O O
provide VBP O O
a1= NN O O
through IN O O
a3= NN O O
values NNS O O
identifying VBG O O
a DT O O
QEMU NNP O O
based VBN O O
sandbox NN O O
, , O O
all DT O O
sourced VBD O O
from IN O O
only RB O O
485 CD O O
WAN NNP O O
IP NNP O O
ad- JJ O O
dresses NNS O O
. . O O

Under IN O O
30 CD O O
lan JJ O O
IPs NNS O O
are VBP O O
recorded VBN O O
, , O O
all DT O O
in IN O O
the DT O O
same JJ O O
172.16.2.14Â­126 CD O O
range NN O O
. . O O

This DT O O
system NN O O
( CD O O
s NN O O
) NN O O
uses VBZ O O
a DT O O
'' '' O O
Dave NNP O O
'' '' O O
user NN O O
account NN O O
and CC O O
'' '' O O
HOMEÂ­OFFÂ­D5F0AC NNP O O
'' '' O O
Windows NNP O O
system NN O O
name NN O O
. . O O

These DT O O
characteristics NNS O O
correspond VBP O O
with IN O O
network NN O O
activity NN O O
generated VBN O O
by IN O O
GFI NN O O
Soft- NN O O
ware NN O O
's POS O O
'' '' O O
CWsandbox NN O O
'' '' O O
tools NNS O O
, , O O
now RB O O
owned VBN O O
by IN O O
'' '' O O
ThreatTrack NNP O O
Security NNP O O
'' '' O O
. . O O

For IN O O
the DT O O
past JJ O O
seven CD O O
years NNS O O
, , O O
a DT O O
strong JJ O O
threat NN O O
actor NN O O
named VBN O O
Darkhotel NNP O O
, , O O
also RB O O
known VBN O O
as IN O O
Tapaoux NNP O O
, , O O
has VBZ O O
carried VBN O O
out RP O O
a DT O O
number NN O O
of IN O O
successful JJ O O
attacks NNS O O
against IN O O
a DT O O
wide JJ O O
range NN O O
of IN O O
victims NNS O O
from IN O O
around IN O O
the DT O O
world NN O O
. . O O

It PRP O O
employs VBZ O O
methods NNS O O
and CC O O
techniques NNS O O
which WDT O O
go VBP O O
well RB O O
beyond IN O O
typical JJ O O
cybercriminal JJ O O
behavior NN O O
. . O O

The DT O O
Darkhotel NNP O O
crew NN O O
's POS O O
skillset NN O O
allows VBZ O O
it PRP O O
to TO O O
launch VB O O
interesting JJ O O
cryptographical JJ O O
at- NN O O
tacks VBZ O O
, , O O
for IN O O
instance NN O O
factoring VBG O O
512 CD O O
bit NN O O
RSA NN O O
keys NNS O O
. . O O

Its PRP$ O O
use NN O O
of IN O O
0-days NNS O O
is VBZ O O
another DT O O
indica- JJ O O
tor NN O O
of IN O O
a DT O O
strong JJ O O
threat NN O O
actor NN O O
. . O O

The DT O O
targeting NN O O
of IN O O
top JJ O O
executives NNS O O
from IN O O
various JJ O O
large JJ O O
companies NNS O O
around IN O O
the DT O O
world NN O O
during IN O O
their PRP$ O O
stay NN O O
at IN O O
certain JJ O O
'' '' O O
Dark JJ O O
Hotels NNPS O O
'' '' O O
is VBZ O O
one CD O O
of IN O O
the DT O O
most RBS O O
interesting JJ O O
aspects NNS O O
of IN O O
this DT O O
operation NN O O
. . O O

The DT O O
exact JJ O O
method NN O O
of IN O O
targeting NN O O
is VBZ O O
still RB O O
unknown JJ O O
- : O O
for IN O O
instance NN O O
, , O O
why WRB O O
some DT O O
people NNS O O
are VBP O O
targeted VBN O O
while IN O O
others NNS O O
are VBP O O
not RB O O
. . O O

The DT O O
fact NN O O
that IN O O
most JJS O O
of IN O O
the DT O O
time NN O O
the DT O O
victims NNS O O
are VBP O O
top JJ O O
executives NNS O O
indicates VBZ O O
the DT O O
attackers NNS O O
have VBP O O
knowledge NN O O
of IN O O
their PRP$ O O
victims NNS O O
whereabouts NN O O
, , O O
including VBG O O
name NN O O
and CC O O
place NN O O
of IN O O
stay NN O O
. . O O

This DT O O
paints NNS O O
a DT O O
dark JJ O O
, , O O
dangerous JJ O O
web NN O O
in IN O O
which WDT O O
unsuspecting JJ O O
travelers NNS O O
can MD O O
easily RB O O
fall VB O O
. . O O

While IN O O
the DT O O
exact JJ O O
reason NN O O
why WRB O O
some DT O O
hotels NNS O O
function VBP O O
as IN O O
an DT O O
attacker NN O O
vector NN O O
are VBP O O
unknown JJ O O
, , O O
certain JJ O O
suspicions NNS O O
ex- FW O O
ist FW O O
, , O O
indicating VBG O O
possibly RB O O
a DT O O
much RB O O
larger JJR O O
compromise NN O O
. . O O

We PRP O O
are VBP O O
still RB O O
investigating VBG O O
this DT O O
aspect NN O O
of IN O O
the DT O O
operation NN O O
and CC O O
will MD O O
publish VB O O
more JJR O O
information NN O O
in IN O O
the DT O O
future NN O O
. . O O

A DT O O
further JJ O O
interesting JJ O O
trait NN O O
is VBZ O O
the DT O O
deployment NN O O
of IN O O
multiple JJ O O
types NNS O O
of IN O O
campaigns NNS O O
, , O O
both CC O O
targeted VBN O O
and CC O O
botnet NN O O
. . O O

This DT O O
is VBZ O O
becoming VBG O O
more RBR O O
and CC O O
more RBR O O
common JJ O O
on IN O O
the DT O O
APT NNP O O
scene NN O O
, , O O
where WRB O O
targeted VBN B-Entity 1
attacks NNS I-Entity O
are VBP O O
used VBN O O
to TO O O
compromise VB B-Action 2
high JJ B-Entity 3
profile NN I-Entity O
victims NNS I-Entity O
and CC O O
botnet NN B-Entity 4
style NN I-Entity O
operations NNS I-Entity O
are VBP B-Action 5
used VBN I-Action O
for IN B-Modifier 6
massive JJ B-Entity 7
surveillance NN I-Entity O
or CC O O
performing VBG O O
other JJ O O
tasks NNS O O
such JJ O O
as IN O O
launching VBG B-Action 8
DDoS NN B-Entity 9
attacks NNS I-Entity O
on IN B-Modifier 10
hostile JJ B-Entity 11
parties NNS I-Entity O
or CC O O
simply RB O O
upgrading VBG B-Action 12
victims NNS B-Entity 13
to TO B-Modifier 14
more RBR B-Entity 15
sophisticated JJ I-Entity O
espionage NN I-Entity O
tools NNS I-Entity O
. . O O

We PRP O O
expect VBP O O
the DT O O
Darkhotel NNP O O
crew NN O O
to TO O O
continue VB O O
their PRP$ O O
activities NNS O O
against IN O O
DIB NNP O O
, , O O
Govern- NN O O
ment NN O O
and CC O O
NGO NN O O
sectors NNS O O
. . O O

The DT O O
appendix NN O O
released VBN O O
with IN O O
this DT O O
paper NN O O
provides VBZ O O
technical JJ O O
indicators NNS O O
of IN O O
compromise NN O O
which WDT O O
should MD O O
help VB O O
victims NNS O O
identify VB O O
the DT O O
malicious JJ O O
traffic NN O O
and CC O O
enable VB O O
targets NNS O O
to TO O O
protect VB O O
themselves PRP O O
better RBR O O
against IN O O
attack NN O O
. . O O

