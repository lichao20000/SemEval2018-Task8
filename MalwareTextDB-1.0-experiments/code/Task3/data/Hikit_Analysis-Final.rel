Hikit NNP O O
consists VBZ O O
of IN O O
at IN B-Entity 1
least JJS I-Entity O
two CD I-Entity O
generations NNS I-Entity O
of IN I-Entity O
malware NN I-Entity O
that WDT O O
provides VBZ B-Action 2
basic JJ B-Entity 3
RAT NN I-Entity O
functionality NN I-Entity O
. . O O

The DT B-Entity 1
first JJ I-Entity O
generation NN I-Entity O
of IN I-Entity O
Hikit FW I-Entity O
( FW I-Entity O
referred VBN I-Entity O
to TO I-Entity O
as IN I-Entity O
'' '' I-Entity O
Gen NN I-Entity O
1 CD I-Entity O
'' '' I-Entity O
) NN I-Entity O
operates VBZ B-Action 2
as IN B-Modifier 3
a DT B-Entity 4
server NN I-Entity O
and CC O O
requires VBZ O O
an DT O O
externally RB O O
exposed VBN O O
network NN O O
interface NN O O
in IN O O
order NN O O
for IN O O
an DT B-Entity 5
attacker NN I-Entity O
to TO O O
access VB B-Action 6
the DT B-Entity 7
victim NN I-Entity O
machine NN I-Entity O
. . O O

The DT B-Entity 1
second JJ I-Entity O
generation NN I-Entity O
of IN I-Entity O
Hikit FW I-Entity O
( FW I-Entity O
referred VBN I-Entity O
to TO I-Entity O
as IN I-Entity O
'' '' I-Entity O
Gen NN I-Entity O
2 CD I-Entity O
'' '' I-Entity O
) NN I-Entity O
uses VBZ O O
the DT O O
more RBR O O
traditional JJ O O
client NN O O
model NN O O
and CC O O
beacons NNS B-Action 2
out RP B-Modifier 3
to TO I-Modifier O
an DT B-Entity 4
attacker NN I-Entity O
's POS I-Entity O
C2 NN I-Entity O
server NN I-Entity O
. . O O

While IN O O
the DT O O
communication NN O O
models NNS O O
shifted VBD O O
dramatically RB O O
between IN O O
Gen NN O O
1 CD O O
and CC O O
Gen NN O O
2 CD O O
, , O O
both DT B-Entity 1
generations NNS I-Entity O
of IN I-Entity O
Hikit NNP I-Entity O
retain VBP B-Action 2
the DT B-Entity 3
same JJ I-Entity O
basic JJ I-Entity O
RAT NN I-Entity O
function NN I-Entity O
consisting VBG I-Entity O
of IN I-Entity O
remote JJ I-Entity O
command NN I-Entity O
shell NN I-Entity O
, , I-Entity O
file NN I-Entity O
management NN I-Entity O
, , I-Entity O
network NN I-Entity O
proxy NN I-Entity O
and CC I-Entity O
port NN I-Entity O
forwarding NN I-Entity O
. . O O

Both CC O O
Gen NN O O
1 CD O O
and CC O O
Gen NN O O
2 CD O O
sub-families NNS O O
of IN O O
Hikit NNP O O
consist VBP O O
of IN O O
a DT B-Entity 1
main JJ I-Entity O
DLL NNP I-Entity O
( NNP I-Entity O
referred VBD I-Entity O
to TO I-Entity O
as IN I-Entity O
'' '' I-Entity O
the DT I-Entity O
DLL NNP I-Entity O
'' '' I-Entity O
) NN I-Entity O
that WDT O O
contains VBZ B-Action 2
the DT B-Entity 3
RAT NN I-Entity O
functionality NN I-Entity O
; : O O
a DT O O
kernel NN O O
driver NN O O
( NN O O
referred VBN O O
to TO O O
as IN O O
'' '' O O
the DT O O
Driver NN O O
'' '' O O
) NN O O
with IN O O
Gen NN O O
2 CD O O
also RB O O
employs VBZ O O
an DT O O
additional JJ O O
component NN O O
: : O O
a DT O O
loader NN O O
executable JJ O O
. . O O

The DT O O
driver NN O O
component NN O O
of IN O O
Gen NN O O
1 CD O O
and CC O O
Gen NN O O
2 CD O O
are VBP O O
drastically RB O O
different JJ O O
in IN O O
their PRP$ O O
operation NN O O
and CC O O
intent NN O O
. . O O

For IN O O
the DT O O
Gen NN O O
1 CD O O
sub-family NN O O
of IN O O
Hikit NNP O O
, , O O
the DT O O
driver NN O O
acts VBZ O O
as IN O O
a DT O O
NDIS FW O O
( FW O O
network NN O O
) NN O O
driver NN O O
that WDT O O
is VBZ O O
responsible JJ O O
for IN O O
interfacing VBG O O
the DT O O
DLL NNP O O
to TO O O
the DT O O
network NN O O
while IN O O
preventing VBG O O
a DT O O
direct JJ O O
WinSock NNP O O
interface NN O O
from IN O O
occurring VBG O O
. . O O

The DT B-Entity 1
Gen NN I-Entity O
1 CD I-Entity O
Driver NN I-Entity O
listens VBZ B-Action 2
to TO B-Modifier 3
network NN B-Entity 4
traffic NN I-Entity O
arriving VBG I-Entity O
at IN I-Entity O
the DT I-Entity O
local JJ I-Entity O
network NN I-Entity O
interface NN I-Entity O
and CC O O
waits VBZ O O
for IN O O
a DT O O
specific JJ O O
trigger NN O O
string NN O O
. . O O

The DT O O
trigger NN O O
string NN O O
varies VBZ O O
by IN O O
Driver NN O O
and CC O O
DLL NN O O
sample NN O O
. . O O

The DT B-Entity 1
Gen NN I-Entity O
2 CD I-Entity O
Driver NN I-Entity O
is VBZ O O
a DT O O
simpler JJR O O
system NN O O
driver NN O O
that WDT O O
acts VBZ O O
as IN O O
a DT O O
rootkit NN O O
to TO O O
hide VB B-Action 2
processes NNS B-Entity 3
, , I-Entity O
registry NN I-Entity O
keys NNS I-Entity O
and CC I-Entity O
network NN I-Entity O
connections NNS I-Entity O
associated VBN I-Entity O
with IN I-Entity O
Gen NN I-Entity O
2 CD I-Entity O
activity NN I-Entity O
on IN I-Entity O
the DT I-Entity O
victim NN I-Entity O
's POS I-Entity O
system NN I-Entity O
. . O O

Gen NN O O
2 CD O O
uses VBZ O O
a DT O O
standard JJ O O
client-server JJ O O
malware NN O O
model NN O O
meaning VBG O O
that IN O O
the DT O O
malware NN O O
no RB O O
longer RB O O
requires VBZ O O
a DT O O
direct JJ O O
Internet-facing JJ O O
network NN O O
card NN O O
, , O O
no RB O O
longer RB O O
uses VBZ O O
a DT O O
network NN O O
driver NN O O
for IN O O
networking NN O O
, , O O
and CC O O
provides VBZ O O
the DT O O
ability NN O O
to TO O O
network VB O O
multiple JJ O O
Gen NN O O
2 CD O O
samples NNS O O
behind IN O O
a DT O O
firewall NN O O
with IN O O
greater JJR O O
ease NN O O
( NN O O
from IN O O
the DT O O
attacker's NN O O
perspective NN O O
) NN O O
. . O O

The DT O O
Gen NN O O
2 CD O O
sub-family NN O O
, , O O
however RB O O
, , O O
no RB O O
longer RB O O
employs VBZ O O
network NN O O
stealth NN O O
provided VBN O O
by IN O O
the DT O O
Gen NN O O
1 CD O O
network NN O O
driver NN O O
which WDT O O
exposes VBZ O O
the DT O O
C2 NN O O
server NN O O
addresses NNS O O
to TO O O
analysts NNS O O
. . O O

Each DT O O
of IN O O
the DT O O
Hikit NN O O
generations NNS O O
contains VBZ O O
multiple JJ O O
sub-generations NNS O O
as IN O O
the DT O O
author NN O O
( CD O O
s NN O O
) NN O O
of IN O O
Hikit NNP O O
have VBP O O
evolved VBN O O
their PRP$ O O
code NN O O
over IN O O
time NN O O
. . O O

There EX O O
is VBZ O O
a DT O O
noticeable JJ O O
steep JJ O O
improvement NN O O
over IN O O
the DT O O
code NN O O
base NN O O
of IN O O
Gen NN O O
1 CD O O
Hikit NN O O
family NN O O
during IN O O
its PRP$ O O
2011 CD O O
development NN O O
period NN O O
. . O O

The DT O O
Gen NN O O
2 CD O O
sub-generations NNS O O
share VBP O O
a DT O O
similar JJ O O
improvement NN O O
scale NN O O
between IN O O
late JJ O O
2011 CD O O
and CC O O
late JJ O O
2013 CD O O
. . O O

The DT O O
earliest JJS O O
known JJ O O
Hikit NN O O
sample NN O O
dates NNS O O
back RB O O
to TO O O
31 CD O O
March NNP O O
2011 CD O O
. . O O

Known VBN O O
as IN O O
the DT O O
Gen NN O O
1.0 CD O O
sub-generation NN O O
of IN O O
Hikit NN O O
Gen NN O O
1 CD O O
, , O O
the DT O O
first JJ O O
known JJ O O
sample NN O O
of IN O O
Hikit NN O O
deviated VBN O O
from IN O O
the DT O O
later JJ O O
traditional JJ O O
Gen NN O O
1 CD O O
model NN O O
. . O O

The DT O O
Gen NN O O
1.0 CD O O
sample NN O O
was VBD O O
a DT O O
standalone NN O O
executable JJ O O
whereas IN O O
subsequent JJ O O
Gen NN O O
1 CD O O
sub-generations NNS O O
use VBP O O
a DT O O
DLL NNP O O
running VBG O O
as IN O O
a DT O O
service NN O O
. . O O

The DT O O
Gen NN O O
1.0 CD O O
sample NN O O
is VBZ O O
clearly RB O O
a DT O O
work-in-progress NN O O
. . O O

The DT O O
Gen NN O O
1.0 CD O O
sample NN O O
, , O O
while IN O O
different JJ O O
than IN O O
subsequent JJ O O
sub-generations NNS O O
, , O O
does VBZ O O
still RB O O
rely VB O O
on IN O O
the DT O O
Driver NN O O
component NN O O
and CC O O
for IN O O
the DT O O
most JJS O O
part NN O O
the DT O O
structure NN O O
of IN O O
the DT O O
code NN O O
does VBZ O O
not RB O O
differ VB O O
much RB O O
going VBG O O
forward RB O O
into IN O O
the DT O O
Gen NN O O
1 CD O O
evolution NN O O
. . O O

Less RBR O O
than IN O O
three CD O O
weeks NNS O O
after IN O O
Gen NN O O
1.0 CD O O
, , O O
the DT O O
author NN O O
( CD O O
s NN O O
) NN O O
of IN O O
Hikit JJ O O
move NN O O
into IN O O
Gen NN O O
1.1 CD O O
. . O O

The DT O O
notable JJ O O
change NN O O
is VBZ O O
that IN O O
the DT O O
Hikit NNP O O
model NN O O
of IN O O
using VBG O O
a DT O O
DLL NN O O
and CC O O
driver NN O O
, , O O
which WDT O O
has VBZ O O
remained VBN O O
until IN O O
present JJ O O
day NN O O
, , O O
comes VBZ O O
into IN O O
being VBG O O
. . O O

The DT O O
code NN O O
matures VBZ O O
slightly RB O O
between IN O O
Gen NN O O
1.0 CD O O
and CC O O
Gen NN O O
1.1 CD O O
but CC O O
the DT O O
functionality NN O O
does VBZ O O
not RB O O
change VB O O
. . O O

Both CC O O
Gen NN O O
1.0 CD O O
and CC O O
Gen NN O O
1.1 CD O O
use NN O O
plaintext NN O O
data NNS O O
transmissions NNS O O
. . O O

Development NNP O O
appears VBZ O O
to TO O O
halt VB O O
on IN O O
Gen NN O O
1 CD O O
for IN O O
4 CD O O
months NNS O O
between IN O O
20 CD O O
June NNP O O
2011 CD O O
and CC O O
23 CD O O
October NNP O O
2011 CD O O
based VBN O O
on IN O O
a DT O O
lack NN O O
of IN O O
available JJ O O
samples NNS O O
found VBD O O
. . O O

During IN O O
this DT O O
time NN O O
the DT O O
development NN O O
of IN O O
Hikit NNP O O
appears VBZ O O
to TO O O
change VB O O
locations NNS O O
. . O O

Gen NN O O
1 CD O O
samples NNS O O
have VBP O O
Program NNP O O
Database NNP O O
( FW O O
PDB FW O O
) FW O O
file NN O O
strings NNS O O
that WDT O O
identify VBP O O
the DT O O
file NN O O
path NN O O
of IN O O
the DT O O
Hikit NNP O O
source NN O O
code NN O O
. . O O

For IN O O
Gen NN O O
1.0 CD O O
and CC O O
Gen NN O O
1.1 CD O O
samples NNS O O
, , O O
the DT O O
file NN O O
path NN O O
of IN O O
the DT O O
Hikit NNP O O
source NN O O
code NN O O
is VBZ O O
consistently RB O O
h NN O O
: : O O
\JmVodServer\hikit NN O O
. . O O

Starting VBG O O
with IN O O
Gen NN O O
1.2 CD O O
, , O O
the DT O O
file NN O O
path NN O O
switches VBZ O O
to TO O O
e SYM O O
: : O O
\SourceCode\hikitnew NN O O
. . O O

It PRP O O
is VBZ O O
at IN O O
this DT O O
time NN O O
that IN O O
the DT O O
functionality NN O O
of IN O O
Hikit NN O O
Gen NN O O
1 CD O O
begins VBZ O O
to TO O O
mature VB O O
. . O O

In IN O O
Gen NN O O
1.2 CD O O
, , O O
the DT B-Entity 1
communication NN I-Entity O
between IN I-Entity O
the DT I-Entity O
infected JJ I-Entity O
machine NN I-Entity O
and CC I-Entity O
the DT I-Entity O
attacker NN I-Entity O
is VBZ B-Action 2
encrypted VBN I-Action O
using VBG B-Modifier 3
an DT B-Entity 4
XOR NN I-Entity O
mask NN I-Entity O
. . O O

A DT O O
more RBR O O
subtle JJ O O
change NN O O
is VBZ O O
the DT O O
renaming NN O O
of IN O O
the DT O O
'' '' O O
socks5 NN O O
'' '' O O
command NN O O
to TO O O
simply RB O O
'' '' O O
proxy NN O O
'' '' O O
within IN O O
the DT O O
code NN O O
. . O O

The DT O O
code NN O O
within IN O O
Hikit NNP O O
begins VBZ O O
to TO O O
mature VB O O
but CC O O
the DT O O
overall JJ O O
functionality NN O O
does VBZ O O
not RB O O
expand VB O O
beyond IN O O
the DT O O
original JJ O O
set NN O O
of IN O O
commands NNS O O
found VBN O O
in IN O O
Gen NN O O
1.0 CD O O
. . O O

The DT O O
other JJ O O
remarkable JJ O O
change NN O O
within IN O O
the DT O O
Gen NN O O
1.1 CD O O
to TO O O
Gen NN O O
1.2 CD O O
development NN O O
is VBZ O O
the DT O O
way NN O O
in IN O O
which WDT O O
the DT O O
session NN O O
handshake NN O O
trigger NN O O
operates VBZ O O
. . O O

In IN O O
Gen NN O O
1.0 CD O O
and CC O O
Gen NN O O
1.1 CD O O
, , O O
the DT O O
DLL NNP O O
instructs VBZ O O
the DT O O
Driver NN O O
to TO O O
listen VB O O
for IN O O
a DT O O
specific JJ O O
string NN O O
( NN O O
typically RB O O
a DT O O
HTTP NN O O
request NN O O
string NN O O
) NN O O
and CC O O
responds VBZ O O
with IN O O
another DT O O
string NN O O
. . O O

In IN O O
Gen NN O O
1.2 CD O O
, , O O
the DT O O
Driver NN O O
has VBZ O O
a DT O O
hardcoded JJ O O
trigger NN O O
string NN O O
( NN O O
a DT O O
specific JJ O O
HTTP NN O O
request NN O O
string NN O O
) NN O O
and CC O O
the DT O O
DLL NNP O O
instructs VBZ O O
the DT O O
Driver NN O O
to TO O O
inspect VB O O
a DT O O
specific JJ O O
HTTP NN O O
header NN O O
field NN O O
for IN O O
a DT O O
specific JJ O O
hexadecimal JJ O O
value NN O O
. . O O

This DT O O
moves VBZ O O
Gen NN O O
1.2 CD O O
into IN O O
more JJR O O
of IN O O
a DT O O
username/password JJ O O
authentication NN O O
scheme NN O O
whereas IN O O
previous JJ O O
sub-generations NNS O O
could MD O O
potentially RB O O
be VB O O
accessed VBN O O
by IN O O
accidental JJ O O
HTTP NN O O
requests NNS O O
. . O O

At IN O O
the DT O O
same JJ O O
time NN O O
, , O O
the DT O O
Driver NN O O
responds VBZ O O
with IN O O
a DT O O
specific JJ O O
value NN O O
with IN O O
in IN O O
the DT O O
Etag NNP O O
HTTP NNP O O
header NN O O
field NN O O
. . O O

This DT O O
places NNS O O
Gen NN O O
1.2 CD O O
into IN O O
a DT O O
more RBR O O
stealth JJ O O
position NN O O
as IN O O
a DT O O
random JJ O O
, , O O
non-HTTP JJ O O
compliant JJ O O
response NN O O
from IN O O
Gen NN O O
1.0 CD O O
and CC O O
Gen NN O O
1.1 CD O O
samples NNS O O
is VBZ O O
more RBR O O
obvious JJ O O
than IN O O
a DT O O
legitimate JJ O O
HTTP NN O O
response NN O O
with IN O O
a DT O O
specially RB O O
crafted VBN O O
Etag NN O O
header NN O O
. . O O

Gen NN O O
1.2 CD O O
's POS O O
development NN O O
cycle NN O O
appears VBZ O O
to TO O O
exist VB O O
between IN O O
23 CD O O
October NNP O O
2011 CD O O
and CC O O
2 CD O O
November NNP O O
2011 CD O O
with IN O O
several JJ O O
new JJ O O
samples NNS O O
being VBG O O
found VBN O O
on IN O O
the DT O O
Internet NN O O
having VBG O O
legitimate JJ O O
compile VBP O O
times NNS O O
during IN O O
this DT O O
time NN O O
window NN O O
. . O O

There EX O O
is VBZ O O
, , O O
however RB O O
, , O O
evidence NN O O
that IN O O
the DT O O
development NN O O
of IN O O
Hikit NN O O
Gen NN O O
1 CD O O
and CC O O
Gen NN O O
2 CD O O
overlap VBP O O
by IN O O
several JJ O O
months NNS O O
. . O O

The DT O O
earliest JJS O O
Gen NN O O
2 CD O O
sample NN O O
known VBN O O
to TO O O
exist VB O O
dates NNS O O
to TO O O
28 CD O O
August NNP O O
2011 CD O O
, , O O
two CD O O
months NNS O O
before IN O O
the DT O O
first JJ O O
known JJ O O
Gen NN O O
1.2 CD O O
sample NN O O
. . O O

The DT O O
last JJ O O
known JJ O O
Gen NN O O
1.2 CD O O
sample NN O O
, , O O
and CC O O
by IN O O
extension NN O O
, , O O
the DT O O
last JJ O O
known JJ O O
Gen NN O O
1 CD O O
sample NN O O
, , O O
dates VBZ O O
to TO O O
9 CD O O
April NNP O O
2012 CD O O
. . O O

The DT O O
first JJ O O
known JJ O O
Gen NN O O
2 CD O O
sub-generation NN O O
, , O O
Gen NN O O
2.0 CD O O
Alpha NNP O O
, , O O
much RB O O
like IN O O
Gen NN O O
1.0 CD O O
, , O O
represents VBZ O O
an DT O O
early JJ O O
development NN O O
version NN O O
of IN O O
the DT O O
Gen NN O O
2 CD O O
Hikit NN O O
sub-family NN O O
. . O O

Gen NN O O
2.0 CD O O
Alpha NN O O
is VBZ O O
a DT O O
stand-alone JJ O O
Windows NNP O O
console NN O O
executable NN O O
that WDT O O
can MD O O
run VB O O
as IN O O
a DT O O
service NN O O
executable JJ O O
. . O O

Gen NN O O
2.0 CD O O
Alpha NN O O
supports VBZ O O
the DT O O
same JJ O O
commands NNS O O
as IN O O
Gen NN O O
1.2 CD O O
with IN O O
an DT O O
additional JJ O O
command NN O O
that WDT O O
returns VBZ O O
the DT O O
infection NN O O
's POS O O
configuration NN O O
information NN O O
. . O O

On IN O O
9 CD O O
February NNP O O
2012 CD O O
the DT O O
first JJ O O
known JJ O O
sample NN O O
for IN O O
Gen NN O O
2.0 CD O O
Beta NN O O
is VBZ O O
compiled VBN O O
by IN O O
the DT O O
developer NN O O
( CD O O
s NN O O
) NN O O
of IN O O
Hikit NNP O O
. . O O

Also RB O O
a DT O O
stand-alone JJ O O
console NN O O
executable JJ O O
like IN O O
Gen NN O O
2.0 CD O O
Alpha NNP O O
, , O O
the DT O O
Gen NN O O
2.0 CD O O
Beta NN O O
code NN O O
changes NNS O O
internally RB O O
without IN O O
providing VBG O O
significant JJ O O
functionality NN O O
improvements NNS O O
with IN O O
the DT O O
exception NN O O
of IN O O
now RB O O
the DT O O
executable JJ O O
uses NNS O O
a DT O O
device NN O O
driver NN O O
to TO O O
hide VB O O
network NN O O
, , O O
file NN O O
, , O O
and CC O O
registry NN O O
artifacts NNS O O
related VBN O O
to TO O O
its PRP$ O O
operation NN O O
. . O O

Both CC O O
Gen NN O O
2.0 CD O O
Alpha NN O O
and CC O O
Gen NN O O
2.0 CD O O
Beta NNP O O
still RB O O
retain VB O O
PDB NN O O
file NN O O
path NN O O
information NN O O
within IN O O
their PRP$ O O
binaries NNS O O
. . O O

During IN O O
the DT O O
development NN O O
phase NN O O
of IN O O
Gen NN O O
2.0 CD O O
Alpha NN O O
, , O O
development NN O O
of IN O O
the DT O O
Gen NN O O
2.0 CD O O
Alpha NN O O
variants NNS O O
changes NNS O O
locations NNS O O
. . O O

First JJ O O
version NN O O
of IN O O
the DT O O
Gen NN O O
2.0 CD O O
Alpha NN O O
malware NN O O
, , O O
from IN O O
28 CD O O
August NNP O O
2011 CD O O
, , O O
has VBZ O O
the DT O O
PDB NN O O
path NN O O
located JJ O O
in IN O O
H NN O O
: : O O
\JmVodServer\Matrixnew2 NN O O
whereas IN O O
the DT O O
file NN O O
path NN O O
for IN O O
later JJ O O
Gen NN O O
2.0 CD O O
Alpha NN O O
and CC O O
Gen NN O O
2.0 CD O O
Beta NNP O O
binaries NNS O O
has VBZ O O
the DT O O
PDB NN O O
path NN O O
in IN O O
E NN O O
: : O O
\SourceCode\Matrixnew NN O O
which WDT O O
suggests VBZ O O
that IN O O
the DT O O
source NN O O
code NN O O
for IN O O
both DT O O
Gen NN O O
1 CD O O
and CC O O
Gen NN O O
2 CD O O
existed VBD O O
on IN O O
the DT O O
same JJ O O
machine NN O O
and CC O O
moved VBD O O
at IN O O
roughly RB O O
the DT O O
same JJ O O
time NN O O
. . O O

This DT O O
may MD O O
indicate VB O O
either CC O O
a DT O O
single JJ O O
developer NN O O
or CC O O
a DT O O
team NN O O
( NN O O
or CC O O
set NN O O
of IN O O
teams NNS O O
) VBP O O
with IN O O
shared JJ O O
resources NNS O O
. . O O

The DT O O
first JJ O O
known JJ O O
Gen NN O O
2.1 CD O O
binary JJ O O
has VBZ O O
a DT O O
compile VBP O O
date NN O O
of IN O O
17 CD O O
April NNP O O
2012 CD O O
. . O O

Gen NN O O
2.1 CD O O
represents VBZ O O
the DT O O
first JJ O O
Gen NN O O
2 CD O O
sub-generation NN O O
to TO O O
use VB O O
an DT O O
executable-based JJ O O
loader NN O O
, , O O
DLL NN O O
and CC O O
driver NN O O
model NN O O
, , O O
a DT O O
model NN O O
that IN O O
all DT O O
subsequent JJ O O
Gen NN O O
2 CD O O
sub-generations NNS O O
employ VBP O O
. . O O

The DT O O
functionality NN O O
of IN O O
the DT O O
Gen NN O O
2.1 CD O O
sub-generation NN O O
is VBZ O O
the DT O O
same JJ O O
as IN O O
the DT O O
previous JJ O O
generations NNS O O
with IN O O
no DT O O
new JJ O O
commands NNS O O
being VBG O O
introduced VBN O O
. . O O

Gen NN O O
2.1 CD O O
is VBZ O O
the DT O O
first JJ O O
sub-generation NN O O
in IN O O
the DT O O
Gen NN O O
2 CD O O
sub-family NN O O
to TO O O
introduce VB O O
64-bit JJ O O
binaries NNS O O
. . O O

The DT O O
Gen NN O O
2.2 CD O O
sub-generation NN O O
appears VBZ O O
to TO O O
have VB O O
begun VBN O O
on IN O O
20 CD O O
July NNP O O
2012 CD O O
. . O O

Gen NN O O
2.2 CD O O
is VBZ O O
notable JJ O O
for IN O O
altering VBG O O
where WRB O O
the DT O O
configuration NN O O
information NN O O
of IN O O
the DT O O
RAT NN O O
is VBZ O O
stored VBN O O
and CC O O
using VBG O O
both CC O O
DLL-based JJ O O
and CC O O
executable- JJ O O
based JJ O O
loaders NNS O O
. . O O

Also RB O O
notable JJ O O
is VBZ O O
the DT O O
fact NN O O
that IN O O
the DT O O
sub-generation NN O O
spans VBZ O O
a DT O O
significant JJ O O
amount NN O O
of IN O O
time NN O O
with IN O O
intermittent JJ O O
periods NNS O O
of IN O O
development NN O O
. . O O

The DT O O
bulk NN O O
of IN O O
the DT O O
Gen NN O O
2.2 CD O O
samples NNS O O
that WDT O O
have VBP O O
the DT O O
tell-tale NN O O
marks NNS O O
of IN O O
being VBG O O
the DT O O
product NN O O
of IN O O
a DT O O
builder NN O O
have VBP O O
a DT O O
compile VBP O O
date NN O O
of IN O O
26 CD O O
July NNP O O
2013 CD O O
, , O O
a DT O O
full JJ O O
year NN O O
after IN O O
the DT O O
first JJ O O
known JJ O O
Gen NN O O
2.2 CD O O
sample NN O O
. . O O

Between IN O O
21 CD O O
July NNP O O
2012 CD O O
and CC O O
20 CD O O
February NNP O O
2013 CD O O
, , O O
there EX O O
are VBP O O
no DT O O
known JJ O O
Gen NN O O
2.2 CD O O
binaries NNS O O
. . O O

The DT O O
two CD O O
20 CD O O
July NNP O O
2012 CD O O
samples NNS O O
have VBP O O
different JJ O O
compile VB O O
times NNS O O
indicating VBG O O
they PRP O O
were VBD O O
not RB O O
the DT O O
product NN O O
of IN O O
a DT O O
builder NN O O
but CC O O
rather RB O O
unique JJ O O
compilations NNS O O
. . O O

Between IN O O
21 CD O O
February NNP O O
2013 CD O O
and CC O O
27 CD O O
February NNP O O
2013 CD O O
, , O O
there EX O O
are VBP O O
4 CD O O
unique JJ O O
compilation NN O O
dates NNS O O
for IN O O
the DT O O
DLL NNP O O
component NN O O
with IN O O
7 CD O O
unique JJ O O
, , O O
known JJ O O
Gen NN O O
2.2 CD O O
DLLs NNS O O
. . O O

The DT O O
bulk NN O O
of IN O O
Gen NN O O
2.2 CD O O
samples NNS O O
have VBP O O
a DT O O
compile VBP O O
date NN O O
of IN O O
26 CD O O
July NNP O O
2013 CD O O
. . O O

There EX O O
are VBP O O
approximately RB O O
25 CD O O
known JJ O O
Gen NN O O
2.2 CD O O
DLLs NNS O O
with IN O O
the DT O O
26 CD O O
July NNP O O
2013 CD O O
compile VBP O O
date NN O O
. . O O

The DT O O
Gen NN O O
2.2 CD O O
sub-generation NN O O
appears VBZ O O
to TO O O
exist VB O O
through IN O O
at IN O O
least JJS O O
19 CD O O
September NNP O O
2013 CD O O
. . O O

The DT O O
last JJ O O
known JJ O O
Gen NN O O
2 CD O O
sub-generation NN O O
, , O O
Gen NN O O
2.3 CD O O
, , O O
began VBD O O
on IN O O
12 CD O O
December NNP O O
2013 CD O O
. . O O

Gen NN O O
2.3 CD O O
is VBZ O O
notable JJ O O
for IN O O
its PRP$ O O
use NN O O
of IN O O
a DT O O
legitimate JJ O O
SSL NN O O
certificate NN O O
as IN O O
part NN O O
of IN O O
the DT O O
handshake NN O O
between IN O O
the DT O O
infected JJ O O
machine NN O O
and CC O O
the DT O O
attacker NN O O
's POS O O
C2 NN O O
. . O O

The DT B-Entity 1
DLL NNP I-Entity O
will MD O O
send VB B-Action 2
a DT B-Entity 3
legitimate JJ I-Entity O
SSL NN I-Entity O
certificate NN I-Entity O
as IN B-Modifier 4
a DT B-Entity 5
means NN I-Entity O
to TO I-Entity O
disrupt VB I-Entity O
heuristic NN I-Entity O
IDS NNP I-Entity O
sensors NNS I-Entity O
that WDT I-Entity O
look VBP I-Entity O
for IN I-Entity O
encrypted JJ I-Entity O
traffic NN I-Entity O
. . O O

Another DT O O
interesting JJ O O
aspect NN O O
of IN O O
the DT O O
Gen NN O O
2.3 CD O O
sub-generation NN O O
is VBZ O O
that IN O O
there EX O O
is VBZ O O
no DT O O
longer RBR O O
a DT O O
marker NN O O
to TO O O
designate VB O O
the DT O O
beginning NN O O
of IN O O
the DT O O
embedded JJ O O
configuration NN O O
. . O O

Gen NN O O
2.1 CD O O
and CC O O
Gen NN O O
2.2 CD O O
uses VBZ O O
a DT O O
specific JJ O O
string NN O O
to TO O O
indicate VB O O
the DT O O
beginning NN O O
of IN O O
the DT O O
embedded JJ O O
configuration NN O O
presumably RB O O
in IN O O
order NN O O
to TO O O
allow VB O O
the DT O O
builder NN O O
to TO O O
locate VB O O
the DT O O
configuration NN O O
space NN O O
when WRB O O
constructing VBG O O
a DT O O
new JJ O O
configuration NN O O
for IN O O
the DT O O
binaries NNS O O
. . O O

Gen NN O O
2.3 CD O O
, , O O
however RB O O
, , O O
uses VBZ O O
a DT O O
specific JJ O O
location NN O O
instead RB O O
, , O O
requiring VBG O O
the DT O O
builder NN O O
to TO O O
calculate VB O O
the DT O O
specific JJ O O
location NN O O
using VBG O O
the DT O O
PE/COFF NN O O
header NN O O
of IN O O
the DT O O
binary JJ O O
. . O O

Also RB O O
, , O O
while IN O O
Gen NN O O
2.1 CD O O
and CC O O
Gen NN O O
2.2 CD O O
retain VBP O O
the DT O O
configuration NN O O
within IN O O
the DT O O
DLL NNP O O
component NN O O
, , O O
Gen NN O O
2.3 CD O O
stores NNS O O
the DT O O
configuration NN O O
within IN O O
the DT O O
loader NN O O
component NN O O
. . O O

This DT O O
allows VBZ O O
the DT O O
attackers NNS O O
to TO O O
configure VB O O
the DT O O
loader NN O O
without IN O O
having VBG O O
to TO O O
update VB O O
the DT O O
DLL NNP O O
. . O O

The DT O O
evolution NN O O
of IN O O
Hikit NNP O O
is VBZ O O
a DT O O
long JJ O O
and CC O O
drawn VBN O O
out RP O O
series NN O O
of IN O O
small JJ O O
, , O O
incremental JJ O O
development NN O O
changes NNS O O
. . O O

The DT O O
important JJ O O
take NN O O
away RB O O
from IN O O
the DT O O
evolution NN O O
of IN O O
Hikit NNP O O
is VBZ O O
that IN O O
the DT O O
developers NNS O O
for IN O O
Gen NN O O
1 CD O O
appear VBP O O
to TO O O
have VB O O
changed VBN O O
in IN O O
late JJ O O
2011 CD O O
and CC O O
development NN O O
of IN O O
Gen NN O O
2 CD O O
has VBZ O O
a DT O O
several JJ O O
month NN O O
overlap VBP O O
with IN O O
the DT O O
development NN O O
and CC O O
usage NN O O
of IN O O
Gen NN O O
1 CD O O
. . O O

The DT O O
following VBG O O
table NN O O
provides VBZ O O
a DT O O
quick JJ O O
reference NN O O
to TO O O
the DT O O
generational JJ O O
( NN O O
and CC O O
sub-generational JJ O O
) NN O O
designations NNS O O
of IN O O
Hikit NNP O O
. . O O

The DT O O
Driver NN O O
component NN O O
for IN O O
Hikit NNP O O
varies VBZ O O
based VBN O O
on IN O O
the DT O O
specific JJ O O
Hikit JJ O O
sub-family JJ O O
( NN O O
Gen NN O O
1 CD O O
or CC O O
Gen NN O O
2 CD O O
) NN O O
. . O O

As IN O O
such JJ O O
it PRP O O
is VBZ O O
necessary JJ O O
to TO O O
describe VB O O
each DT O O
in IN O O
the DT O O
context NN O O
of IN O O
its PRP$ O O
specific JJ O O
sub-family NN O O
. . O O

The DT O O
Driver NN O O
component NN O O
of IN O O
Gen NN O O
1 CD O O
Hikit NN O O
variants NNS O O
provides VBZ O O
the DT O O
interface NN O O
between IN O O
the DT O O
victim NN O O
's POS O O
network NN O O
interface NN O O
card NN O O
( NN O O
NIC NN O O
) NN O O
and CC O O
the DT O O
DLL NNP O O
. . O O

The DT O O
Driver NN O O
is VBZ O O
a DT O O
NDIS FW O O
( FW O O
network NN O O
) NN O O
driver NN O O
that WDT O O
integrates VBZ O O
into IN O O
the DT O O
victim's NNP O O
network NN O O
stack VB O O
. . O O

The DT B-Entity 1
Driver NN I-Entity O
intercepts VBZ B-Action 2
any DT B-Entity 3
and CC I-Entity O
all DT I-Entity O
network NN I-Entity O
communication NN I-Entity O
that WDT I-Entity O
traverses VBZ I-Entity O
the DT I-Entity O
Windows NNP I-Entity O
network NN I-Entity O
stack VB I-Entity O
and CC O O
potentially RB O O
removes VBZ O O
the DT O O
data NNS O O
from IN O O
the DT O O
network NN O O
stack VB O O
under IN O O
very RB O O
specific JJ O O
conditions NNS O O
. . O O

When WRB O O
the DT O O
Driver NN O O
removes VBZ O O
data NNS O O
from IN O O
the DT O O
network NN O O
stack VBP O O
, , O O
the DT O O
Driver NN O O
stores NNS O O
the DT O O
removed VBN O O
data NNS O O
in IN O O
local JJ O O
buffers NNS O O
for IN O O
the DT O O
Gen NN O O
1 CD O O
DLL NN O O
to TO O O
query VB O O
against IN O O
. . O O

The DT O O
purpose NN O O
of IN O O
this DT O O
behavior NN O O
is VBZ O O
to TO O O
allow VB O O
the DT B-Entity 1
DLL NNP I-Entity O
to TO O O
interact VB B-Action 2
with IN B-Modifier 3
the DT B-Entity 4
network NN I-Entity O
without IN B-Modifier 5
utilizes VBZ B-Entity 6
the DT I-Entity O
WinSock NNP I-Entity O
API NNP I-Entity O
which WDT I-Entity O
could MD I-Entity O
potentially RB I-Entity O
reveal VB I-Entity O
the DT I-Entity O
presence NN I-Entity O
of IN I-Entity O
Hikit NNP I-Entity O
. . O O

In IN O O
order NN O O
to TO O O
interact VB O O
with IN O O
the DT O O
Driver NN O O
, , O O
the DT O O
DLL NNP O O
uses VBZ O O
the DT O O
function NN O O
The DT O O
Driver NN O O
will MD O O
remove VB O O
data NNS O O
from IN O O
the DT O O
network NN O O
stack VBP O O
only RB O O
if IN O O
a DT O O
new JJ O O
channel NN O O
is VBZ O O
being VBG O O
established VBN O O
. . O O

A DT O O
new JJ O O
channel NN O O
occurs VBZ O O
when WRB O O
the DT O O
Driver NN O O
detects VBZ O O
a DT O O
trigger NN O O
string NN O O
. . O O

The DT O O
trigger NN O O
string NN O O
is VBZ O O
typically RB O O
a DT O O
short JJ O O
form NN O O
HTTP NN O O
request NN O O
with IN O O
the DT O O
following VBG O O
trigger NN O O
strings NNS O O
found VBN O O
in IN O O
the DT O O
wild JJ O O
: : O O
Up IN O O
to TO O O
and CC O O
including VBG O O
Gen NN O O
1.1 CD O O
Drivers NNS O O
required VBD O O
the DT O O
DLL NNP O O
to TO O O
specify VB O O
the DT O O
trigger NN O O
string NN O O
in IN O O
addition NN O O
to TO O O
the DT O O
authentication NN O O
value NN O O
whereas IN O O
Gen NN O O
1.2 CD O O
Drivers NNS O O
had VBD O O
the DT O O
trigger NN O O
strings NNS O O
hardcoded VBD O O
. . O O

In IN O O
Gen NN O O
1.2 CD O O
, , O O
whenever WRB O O
the DT O O
Driver NN O O
detects VBZ O O
a DT O O
trigger NN O O
string NN O O
, , O O
the DT O O
Driver NN O O
inspects VBZ O O
the DT O O
rest NN O O
of IN O O
the DT O O
data NNS O O
received VBN O O
for IN O O
the DT O O
authentication NN O O
value NN O O
. . O O

If IN O O
the DT O O
token JJ O O
follows VBZ O O
the DT O O
trigger NN O O
string NN O O
( NN O O
there EX O O
is VBZ O O
no DT O O
specific JJ O O
limitation NN O O
on IN O O
how WRB O O
far RB O O
from IN O O
the DT O O
trigger NN O O
string NN O O
the DT O O
password NN O O
token JJ O O
must MD O O
be VB O O
) CD O O
, , O O
then RB O O
the DT O O
Driver NN O O
generates VBZ O O
a DT O O
new JJ O O
channel NN O O
that IN O O
the DT O O
DLL NNP O O
will MD O O
use VB O O
as IN O O
the DT O O
conduit NN O O
between IN O O
the DT O O
DLL NNP O O
and CC O O
the DT O O
client NN O O
. . O O

The DT O O
Driver NN O O
appears VBZ O O
to TO O O
be VB O O
based VBN O O
off IN O O
the DT O O
NDIS NN O O
example NN O O
source NN O O
code NN O O
PassThru NNP O O
. . O O

More RBR O O
specifically RB O O
, , O O
the DT O O
author NN O O
( CD O O
s NN O O
) NN O O
of IN O O
the DT O O
Driver NN O O
appear VBP O O
to TO O O
have VB O O
used VBN O O
the DT O O
modified VBN O O
version NN O O
of IN O O
the DT O O
PassThru NNP O O
example NN O O
, , O O
PassThruEx NN O O
, , O O
by IN O O
James NNP O O
Antognini NNP O O
and CC O O
Thomas NNP O O
Devine JJ O O
from IN O O
a DT O O
2003 CD O O
blog NN O O
post NN O O
. . O O

The DT B-Entity 1
Gen NN I-Entity O
2 CD I-Entity O
sub-family NN I-Entity O
, , I-Entity O
beginning VBG I-Entity O
with IN I-Entity O
Gen NN I-Entity O
2.0 CD I-Entity O
Beta NNP I-Entity O
, , O O
employs VBZ B-Action 2
a DT B-Entity 3
Windows NNP I-Entity O
device NN I-Entity O
driver NN I-Entity O
( NN I-Entity O
'' '' I-Entity O
the DT I-Entity O
Driver NN I-Entity O
'' '' I-Entity O
) NN I-Entity O
to TO B-Modifier 4
hide VB B-Entity 5
aspects NNS I-Entity O
of IN I-Entity O
the DT I-Entity O
DLL NNP I-Entity O
's POS I-Entity O
functionality NN I-Entity O
from IN I-Entity O
normal JJ I-Entity O
system NN I-Entity O
processes NNS I-Entity O
. . O O

The DT O O
Driver NN O O
is VBZ O O
a DT O O
relatively RB O O
straightforward JJ O O
piece NN O O
of IN O O
software NN O O
. . O O

It PRP O O
does VBZ O O
not RB O O
attempt VB O O
to TO O O
obfuscate VB O O
its PRP$ O O
functionality NN O O
from IN O O
static JJ O O
analysis NN O O
and CC O O
it PRP B-Entity 1
hooks VBZ B-Action 2
a DT B-Entity 3
minimum JJ I-Entity O
number NN I-Entity O
of IN I-Entity O
kernel NN I-Entity O
API NN I-Entity O
functions NNS I-Entity O
in IN B-Modifier 4
order NN I-Modifier O
to TO I-Modifier O
hide VB B-Entity 5
different JJ I-Entity O
pieces NNS I-Entity O
of IN I-Entity O
information NN I-Entity O
. . O O

The DT O O
Driver NN O O
is VBZ O O
based VBN O O
primarily RB O O
on IN O O
the DT O O
open JJ O O
source NN O O
Agony NN O O
rootkit NN O O
and CC O O
it PRP O O
has VBZ O O
evidence NN O O
of IN O O
some DT O O
portions NNS O O
of IN O O
the DT O O
code NN O O
coming VBG O O
directly RB O O
from IN O O
a DT O O
Chinese JJ O O
blog NN O O
. . O O

The DT O O
Driver NN O O
expose VBP O O
an DT O O
IOCTL NN O O
interface NN O O
that WDT O O
supports VBZ O O
the DT O O
following JJ O O
OIDs NNS O O
: : O O
The DT B-Entity 1
Driver NN I-Entity O
is VBZ O O
capable JJ O O
of IN O O
hiding VBG B-Action 2
processes NNS B-Entity 3
( VBN O O
by IN O O
PID NN O O
, , O O
not RB O O
name NN O O
) NN O O
, , O O
system NN B-Entity 4
modules NNS I-Entity O
, , O O
services NNS B-Entity 5
, , O O
network NN B-Entity 6
connections NNS I-Entity O
, , O O
listening VBG B-Entity 7
ports NNS I-Entity O
, , O O
directories NNS B-Entity 8
( NN O O
and CC O O
by IN O O
extension NN O O
, , O O
files NNS B-Entity 9
) VBP O O
, , O O
as RB O O
well RB O O
as IN O O
registry NN B-Entity 10
keys NNS I-Entity O
and CC I-Entity O
values NNS I-Entity O
. . O O

In IN B-Modifier 1
order NN I-Modifier O
to TO I-Modifier O
hide VB B-Entity 2
these DT I-Entity O
items NNS I-Entity O
, , O O
the DT B-Entity 3
Driver NN I-Entity O
hooks NNS B-Action 4
various JJ B-Entity 5
Windows NNP I-Entity O
Kernel NNP I-Entity O
API NNP I-Entity O
calls VBZ I-Entity O
. . O O

The DT O O
following VBG O O
table NN O O
maps VBZ O O
the DT B-Entity 1
items NNS I-Entity O
the DT B-Entity 2
Driver NN I-Entity O
can MD O O
hide VB B-Action 3
to TO O O
the DT B-Entity 4
API NNP I-Entity O
function NN I-Entity O
that IN O O
the DT B-Entity 5
Driver NN I-Entity O
hooks NNS B-Action 6
: : O O
In IN O O
order NN O O
to TO O O
hide VB B-Action 7
services NNS B-Entity 8
, , O O
the DT B-Entity 9
Driver NN I-Entity O
will MD O O
access VB B-Action 10
the DT B-Entity 11
memory NN I-Entity O
of IN I-Entity O
the DT I-Entity O
services.exe NN I-Entity O
process NN I-Entity O
, , O O
locate VBP O O
the DT O O
linked VBN O O
list NN O O
of IN O O
services NNS O O
and CC O O
remove VB B-Action 12
the DT B-Entity 13
service NN I-Entity O
entry NN I-Entity O
that IN I-Entity O
the DT I-Entity O
Driver NN I-Entity O
wishes VBZ I-Entity O
to TO I-Entity O
hide VB I-Entity O
. . O O

This DT O O
is VBZ O O
a DT O O
surprisingly RB O O
invasive JJ O O
method NN O O
to TO O O
obfuscate VB B-Action 1
a DT B-Entity 2
process NN I-Entity O
. . O O

Upon IN O O
activation NN O O
, , O O
the DT B-Entity 1
Driver NN I-Entity O
will MD O O
expose VB O O
its PRP$ O O
interface NN O O
by IN O O
calling VBG B-Action 2
IoCreateDevice NNP B-Entity 3
with IN B-Modifier 4
the DT B-Entity 5
name NN I-Entity O
\Device\agony FW I-Entity O
( FW I-Entity O
for IN I-Entity O
Gen NN I-Entity O
2.0 CD I-Entity O
Beta NNP I-Entity O
samples NNS I-Entity O
) NN I-Entity O
, , I-Entity O
\Device\HTTPS NN I-Entity O
( NN I-Entity O
for IN I-Entity O
Gen NN I-Entity O
2.1 CD I-Entity O
samples NNS I-Entity O
) NN I-Entity O
, , I-Entity O
\Device\advcachemgr NN I-Entity O
( NN I-Entity O
for IN I-Entity O
Gen NN I-Entity O
2.2 CD I-Entity O
samples NNS I-Entity O
) CD I-Entity O
or CC I-Entity O
\Device\diskdump FW I-Entity O
( FW I-Entity O
for IN I-Entity O
Gen NN I-Entity O
2.3 CD I-Entity O
samples NNS I-Entity O
) NN I-Entity O
. . O O

The DT B-Entity 1
Driver NN I-Entity O
also RB O O
creates VBZ B-Action 2
a DT B-Entity 3
symbolic JJ I-Entity O
link NN I-Entity O
to TO B-Modifier 4
the DT B-Entity 5
device NN I-Entity O
using VBG B-Modifier 6
the DT B-Entity 7
same JJ I-Entity O
name NN I-Entity O
but CC I-Entity O
under IN I-Entity O
the DT I-Entity O
\DosDevices\ NN I-Entity O
tree NN I-Entity O
. . O O

For IN O O
reasons NNS O O
unknown JJ O O
, , O O
the DT O O
authors NNS O O
of IN O O
the DT O O
Driver NN O O
used VBD O O
code NN O O
from IN O O
a DT O O
Chinese JJ O O
blog NN O O
that IN O O
details NNS O O
how WRB O O
to TO O O
hide VB O O
network NN O O
connections NNS O O
on IN O O
Windows NNP O O
Vista NNP O O
and CC O O
later RB O O
decided VBD O O
to TO O O
keep VB O O
the DT O O
example NN O O
IP NNP O O
address NN O O
within IN O O
the DT O O
code NN O O
. . O O

The DT B-Entity 1
Hikit NNP I-Entity O
family NN I-Entity O
has VBZ O O
supported VBN B-Action 2
roughly RB B-Entity 3
the DT I-Entity O
same JJ I-Entity O
set NN I-Entity O
of IN I-Entity O
commands NNS I-Entity O
since IN B-Modifier 4
the DT B-Entity 5
first JJ I-Entity O
known JJ I-Entity O
samples NNS I-Entity O
of IN I-Entity O
Gen NN I-Entity O
1.0 CD I-Entity O
. . O O

Gen NN O O
2.0 CD O O
introduced VBD O O
a DT O O
single JJ O O
command NN O O
to TO O O
provide VB O O
insight NN O O
into IN O O
an DT O O
infected JJ O O
machine NN O O
's POS O O
Hikit JJ O O
configuration NN O O
( NN O O
something NN O O
that WDT O O
is VBZ O O
not RB O O
necessary JJ O O
for IN O O
Gen NN O O
1 CD O O
variants NNS O O
since IN O O
they PRP O O
are VBP O O
server-based JJ O O
) NN O O
. . O O

The DT B-Entity 1
RAT NN I-Entity O
supports VBZ B-Action 2
the DT B-Entity 3
following JJ I-Entity O
commands NNS I-Entity O
: : O O
The DT B-Entity 4
shell NN I-Entity O
command NN I-Entity O
activates VBZ B-Action 5
a DT B-Entity 6
remote JJ I-Entity O
shell NN I-Entity O
on IN B-Modifier 7
the DT B-Entity 8
victim NN I-Entity O
's POS I-Entity O
computer NN I-Entity O
. . O O

The DT O O
remote JJ O O
shell NN O O
function NN O O
uses VBZ O O
the DT O O
standard JJ O O
pipe NN O O
redirection NN O O
method NN O O
for IN O O
interfacing VBG O O
a DT O O
network NN O O
application NN O O
( NN O O
in IN O O
this DT O O
case NN O O
, , O O
the DT O O
DLL NNP O O
) CD O O
to TO O O
a DT O O
hidden JJ O O
command NN O O
shell NN O O
. . O O

The DT B-Entity 1
file NN I-Entity O
command NN I-Entity O
provides VBZ O O
an DT O O
attacker NN O O
with IN O O
a DT O O
variety NN O O
of IN O O
disk NN O O
access NN O O
options NNS O O
such JJ O O
as IN O O
listing NN B-Action 2
directories NNS B-Entity 3
, , O O
changing VBG O O
the DT O O
current JJ O O
directory NN O O
, , O O
and CC O O
uploading VBG B-Action 4
and CC O O
downloading VBG B-Action 5
files NNS B-Entity 6
. . O O

The DT O O
connect VBP O O
function NN O O
provides VBZ O O
the DT O O
functionality NN O O
to TO O O
allow VB O O
one CD O O
Hikit NNP O O
DLL NNP O O
to TO O O
interface NN O O
with IN O O
another DT O O
DLL NNP O O
of IN O O
a DT O O
similar JJ O O
version NN O O
. . O O

The DT O O
use NN O O
of IN O O
this DT O O
functionality NN O O
can MD O O
best RB O O
be VB O O
illustrated VBN O O
by IN O O
considering VBG O O
the DT O O
fact NN O O
that IN O O
the DT O O
Gen NN O O
1 CD O O
Driver NN O O
requires VBZ O O
an DT O O
exposed JJ O O
network NN O O
interface NN O O
in IN O O
order NN O O
for IN O O
an DT O O
external JJ O O
attacker NN O O
to TO O O
access VB O O
the DT O O
Gen NN O O
1 CD O O
's POS O O
RAT NN O O
function NN O O
. . O O

This DT O O
would MD O O
prohibit VB O O
lateral JJ O O
movement NN O O
within IN O O
a DT O O
victim NN O O
's POS O O
network NN O O
as IN O O
the DT O O
bulk NN O O
of IN O O
any DT O O
organization NN O O
's POS O O
network NN O O
infrastructure NN O O
is VBZ O O
not RB O O
directly RB O O
exposed VBN O O
to TO O O
the DT O O
Internet NNP O O
. . O O

By IN O O
using VBG O O
the DT O O
connect VB O O
command NN O O
, , O O
an DT O O
attacker NN O O
can MD O O
instruct VB O O
the DT O O
externally RB O O
exposed VBN O O
Gen NN O O
1 CD O O
DLL NN O O
to TO O O
route NN O O
traffic NN O O
to TO O O
a DT O O
Gen NN O O
1 CD O O
DLL NN O O
that WDT O O
is VBZ O O
behind IN O O
the DT O O
firewall NN O O
, , O O
effectively RB O O
making VBG O O
the DT O O
externally RB O O
exposed VBN O O
Gen NN O O
1 CD O O
DLL NN O O
a DT O O
local JJ O O
router NN O O
for IN O O
Hikit NNP O O
traffic NN O O
. . O O

The DT O O
proxy JJ O O
( NN O O
or CC O O
socks5 FW O O
) FW O O
command NN O O
allows VBZ O O
an DT B-Entity 1
attacker NN I-Entity O
to TO O O
utilize VB B-Action 2
a DT B-Entity 3
Hikit-infected JJ I-Entity O
machine NN I-Entity O
as IN B-Modifier 4
a DT B-Entity 5
proxy NN I-Entity O
. . O O

Gen NN B-Entity 1
2 CD I-Entity O
samples NNS I-Entity O
rely VBP B-Action 2
on IN B-Modifier 3
a DT B-Entity 4
configuration NN I-Entity O
in IN B-Modifier 5
order NN I-Modifier O
to TO I-Modifier O
know VB B-Entity 6
where WRB I-Entity O
the DT I-Entity O
C2 NN I-Entity O
server NN I-Entity O
exists VBZ I-Entity O
along IN O O
with IN O O
other JJ O O
operational JJ O O
aspects NNS O O
such JJ O O
as IN O O
the DT O O
name NN O O
of IN O O
its PRP$ O O
service NN O O
and CC O O
operational JJ O O
times NNS O O
. . O O

This DT O O
information NN O O
is VBZ O O
important JJ O O
for IN O O
the DT O O
attacker NN O O
to TO O O
have VB O O
access NN O O
to TO O O
in IN O O
order NN O O
to TO O O
determine VB O O
if IN O O
any DT O O
aspect NN O O
of IN O O
the DT O O
configuration NN O O
is VBZ O O
out IN O O
of IN O O
date NN O O
( NN O O
thus RB O O
requiring VBG O O
a DT O O
new JJ O O
variant NN O O
of IN O O
the DT O O
Gen NN O O
2 CD O O
binary JJ O O
to TO O O
be VB O O
configured VBN O O
and CC O O
deployed VBN O O
) NN O O
. . O O

The DT O O
information NN O O
command NN O O
returns VBZ O O
to TO O O
the DT O O
attacker NN O O
the DT O O
complete JJ O O
configuration NN O O
and CC O O
current JJ O O
state NN O O
of IN O O
the DT O O
Gen NN O O
2 CD O O
malware NN O O
. . O O

As IN O O
the DT O O
name NN O O
implies VBZ O O
, , O O
the DT O O
exit NN O O
command NN O O
causes VBZ O O
the DT O O
DLL NNP O O
to TO O O
discontinue VB O O
the DT O O
current JJ O O
connection NN O O
. . O O

With IN O O
the DT O O
Gen NN O O
1 CD O O
sub-family NN O O
using VBG O O
a DT O O
server NN O O
model NN O O
and CC O O
the DT O O
Gen NN O O
2 CD O O
sub-family NN O O
using VBG O O
the DT O O
client NN O O
model NN O O
, , O O
understanding VBG O O
how WRB O O
each DT O O
of IN O O
the DT O O
DLL NNP O O
components NNS O O
of IN O O
the DT O O
sub-families JJ O O
works NNS O O
is VBZ O O
best RB O O
done VBN O O
, , O O
as IN O O
with IN O O
the DT O O
Driver NN O O
above IN O O
, , O O
in IN O O
the DT O O
context NN O O
of IN O O
the DT O O
specific JJ O O
sub-family NN O O
. . O O

As IN O O
noted VBN O O
previously RB O O
in IN O O
this DT O O
report NN O O
, , O O
the DT O O
Gen NN O O
1 CD O O
sub-family NN O O
has VBZ O O
several JJ O O
sub-generations NNS O O
but CC O O
overall RB O O
the DT O O
functionality NN O O
of IN O O
the DT O O
Gen NN O O
1 CD O O
sub-family NN O O
has VBZ O O
remained VBN O O
constant JJ O O
. . O O

With IN O O
the DT O O
exception NN O O
of IN O O
Gen NN O O
1.0 CD O O
, , O O
the DT O O
functionality NN O O
of IN O O
Gen NN O O
1 CD O O
comes VBZ O O
from IN O O
the DT O O
DLL NNP O O
component NN O O
( NN O O
Gen NN O O
1.0 CD O O
uses VBZ O O
a DT O O
stand-alone JJ O O
executable JJ O O
to TO O O
achieve VB O O
the DT O O
same JJ O O
results NNS O O
) VBP O O
. . O O

The DT O O
DLL NNP O O
operates VBZ O O
as IN O O
a DT O O
service NN O O
, , O O
requiring VBG O O
an DT B-Entity 1
attacker NN I-Entity O
is VBZ B-Action 2
install VB I-Action O
the DT B-Entity 3
DLL NNP I-Entity O
as IN B-Modifier 4
a DT B-Entity 5
service NN I-Entity O
at IN B-Modifier 6
some DT B-Entity 7
point NN I-Entity O
prior RB I-Entity O
to TO I-Entity O
activation NN I-Entity O
. . O O

The DT O O
DLL NNP O O
contains VBZ O O
only RB O O
two CD O O
exports NNS O O
: : O O
DllEntryPoint NNP O O
and CC O O
DllRegisterServer NNP O O
. . O O

Ultimately RB O O
, , O O
both DT B-Entity 1
exports NNS I-Entity O
generate VBP B-Action 2
a DT B-Entity 3
new JJ I-Entity O
thread NN I-Entity O
of IN I-Entity O
the DT I-Entity O
same JJ I-Entity O
function NN I-Entity O
( NN I-Entity O
'' '' I-Entity O
mainThread NN I-Entity O
'' '' I-Entity O
) NN I-Entity O
. . O O

The DT O O
difference NN O O
between IN O O
the DT O O
two CD O O
exports NNS O O
is VBZ O O
that IN O O
DllRegisterServer NNP O O
can MD O O
take VB O O
an DT O O
optional JJ O O
command NN O O
line NN O O
argument NN O O
of IN O O
the DT O O
letter NN O O
'' '' O O
u NN O O
'' '' O O
which WDT O O
will MD O O
instruct VB O O
the DT B-Entity 1
main JJ I-Entity O
thread NN I-Entity O
to TO O O
uninstall VB B-Action 2
the DT B-Entity 3
Gen NN I-Entity O
1 CD I-Entity O
system NN I-Entity O
from IN B-Modifier 4
a DT B-Entity 5
victim NN I-Entity O
's POS I-Entity O
computer NN I-Entity O
. . O O

If IN O O
the DT O O
uninstall JJ O O
argument NN O O
exists VBZ O O
, , O O
mainThread NN B-Entity 1
will MD O O
simply RB O O
remove VB B-Action 2
the DT B-Entity 3
Driver NN I-Entity O
from IN B-Modifier 4
the DT B-Entity 5
victim NN I-Entity O
's POS I-Entity O
machine NN I-Entity O
and CC O O
terminate VB O O
. . O O

The DT O O
authors NNS O O
of IN O O
Gen NN O O
1 CD O O
used VBD O O
freely RB O O
available JJ O O
source NN O O
code NN O O
found VBD O O
online NN O O
for IN O O
their PRP$ O O
removal NN O O
function NN O O
. . O O

When WRB O O
the DT O O
DLL NNP O O
activates VBZ O O
, , O O
either CC O O
by IN O O
a DT O O
call NN O O
to TO O O
DllEntryPoint NN O O
or CC O O
by IN O O
calling VBG B-Action 1
DllRegisterServer NNP B-Entity 2
without IN B-Modifier 3
the DT B-Entity 4
u NN I-Entity O
parameter NN I-Entity O
, , O O
mainThread NN O O
begins VBZ O O
by IN O O
verifying VBG O O
the DT O O
version NN O O
of IN O O
the DT O O
Driver NN O O
installed VBN O O
on IN O O
the DT O O
victim NN O O
's POS O O
machine NN O O
. . O O

This DT O O
requires VBZ O O
sending VBG O O
OID NN O O
0x12C850 NN O O
to TO O O
the DT O O
Driver NN O O
and CC O O
comparing VBG O O
the DT O O
resulting VBG O O
32-bit JJ O O
value NN O O
with IN O O
the DT O O
required JJ O O
driver NN O O
version NN O O
. . O O

If IN O O
the DT O O
version NN O O
is VBZ O O
incorrect JJ O O
( FW O O
i.e FW O O
. . O O

it PRP O O
does VBZ O O
n't RB O O
match VB O O
the DT O O
specified VBN O O
version NN O O
) NN O O
, , O O
the DT B-Entity 1
DLL NNP I-Entity O
installs VBZ B-Action 2
the DT B-Entity 3
version NN I-Entity O
of IN I-Entity O
the DT I-Entity O
Driver NN I-Entity O
found VBN I-Entity O
within IN I-Entity O
the DT I-Entity O
DLL NNP I-Entity O
's POS I-Entity O
resource NN I-Entity O
section NN I-Entity O
( NN I-Entity O
under IN I-Entity O
the DT I-Entity O
BIN NNP I-Entity O
resource NN I-Entity O
tree NN I-Entity O
) NN I-Entity O
. . O O

With IN O O
the DT O O
Driver NN O O
version NN O O
verified VBD O O
( CD O O
or CC O O
forcibly RB O O
corrected VBN O O
by IN O O
installing VBG B-Action 1
the DT B-Entity 2
appropriate JJ I-Entity O
Driver NN I-Entity O
) NN O O
, , O O
the DT O O
DLL NNP O O
will MD O O
instruct VB O O
the DT O O
Driver NN O O
to TO O O
use VB O O
a DT O O
specified JJ O O
string NN O O
( NN O O
for IN O O
Gen NN O O
1.0 CD O O
and CC O O
Gen NN O O
1.1 CD O O
samples NNS O O
) CD O O
or CC O O
a DT O O
DWORD FW O O
( FW O O
for IN O O
Gen NN O O
1.2 CD O O
samples NNS O O
) CD O O
as IN O O
the DT O O
acknowledgment NN O O
value NN O O
to TO O O
send VB O O
to TO O O
a DT O O
connecting VBG O O
client NN O O
who WP O O
requests NNS O O
the DT O O
appropriate JJ O O
URL NN O O
. . O O

The DT O O
DLL NNP O O
again RB O O
checks VBZ O O
the DT O O
version NN O O
of IN O O
the DT O O
Driver NN O O
and CC O O
, , O O
in IN O O
some DT O O
versions NNS O O
of IN O O
the DT O O
DLL NNP O O
, , O O
will MD O O
print VB O O
a DT O O
message NN O O
indicating VBG O O
the DT O O
version NN O O
of IN O O
the DT O O
Driver NN O O
installed VBN O O
and CC O O
report VBP O O
the DT O O
'' '' O O
Transate NN O O
version NN O O
'' '' O O
( CD O O
the DT O O
word NN O O
translate VB O O
is VBZ O O
misspelled VBN O O
within IN O O
the DT O O
binary JJ O O
) NN O O
. . O O

It PRP O O
appears VBZ O O
that IN O O
the DT O O
Driver NN O O
and CC O O
the DT O O
communication NN O O
protocol NN O O
version NN O O
do VBP O O
not RB O O
necessarily RB O O
have VB O O
to TO O O
match VB O O
exactly RB O O
, , O O
allowing VBG O O
the DT O O
possibility NN O O
that IN O O
the DT O O
Driver NN O O
and CC O O
the DT O O
DLL NNP O O
could MD O O
be VB O O
compiled VBN O O
at IN O O
separate JJ O O
times NNS O O
. . O O

If IN O O
the DT O O
Driver NN O O
version NN O O
is VBZ O O
less JJR O O
than IN O O
the DT O O
'' '' O O
Transate NNP O O
'' '' O O
version NN O O
( NN O O
indicating VBG O O
that IN O O
the DT O O
Driver NN O O
is VBZ O O
a DT O O
version NN O O
too RB O O
old JJ O O
to TO O O
support VB O O
the DT O O
necessary JJ O O
communication NN O O
protocols NNS O O
) CD O O
, , O O
the DT O O
DLL NNP O O
will MD O O
, , O O
in IN O O
some DT O O
version NN O O
of IN O O
the DT O O
DLL NNP O O
, , O O
print VB O O
out RP O O
a DT O O
line NN O O
to TO O O
the DT O O
screen NN O O
indicating VBG O O
the DT O O
DRIVERMINVERSION NN O O
required VBN O O
along IN O O
with IN O O
the DT O O
current JJ O O
Driver NN O O
version NN O O
. . O O

Following VBG O O
this DT O O
, , O O
the DT B-Entity 1
DLL NNP I-Entity O
will MD O O
then RB O O
attempt VB O O
to TO O O
install VB B-Action 2
the DT B-Entity 3
correct JJ I-Entity O
version NN I-Entity O
of IN I-Entity O
the DT I-Entity O
Driver NN I-Entity O
prior RB B-Modifier 4
to TO I-Modifier O
terminating VBG B-Entity 5
. . O O

It PRP O O
is VBZ O O
unclear JJ O O
why WRB O O
this DT O O
code NN O O
exists VBZ O O
given VBN O O
that IN O O
the DT O O
DLL NNP O O
will MD O O
check VB O O
the DT O O
Driver NN O O
version NN O O
and CC O O
correct VB O O
the DT O O
Driver NN O O
if IN O O
necessary JJ O O
prior RB O O
to TO O O
reaching VBG O O
the DT O O
portion NN O O
of IN O O
the DT O O
code NN O O
that WDT O O
reports VBZ O O
the DT O O
DRIVERMINVERSION NNP O O
. . O O

It PRP O O
is VBZ O O
possible JJ O O
that IN O O
the DT B-Entity 1
second JJ I-Entity O
Driver NN I-Entity O
version NN I-Entity O
check NN I-Entity O
is VBZ O O
a DT O O
last JJ O O
ditch NN O O
effort NN O O
to TO O O
ensure VB B-Action 2
the DT B-Entity 3
correct JJ I-Entity O
Driver NN I-Entity O
is VBZ I-Entity O
installed VBN I-Entity O
. . O O

The DT O O
DLL NNP O O
enters VBZ O O
an DT O O
infinite JJ O O
loop NN O O
where WRB O O
the DT O O
DLL NNP O O
waits VBZ O O
for IN O O
the DT O O
Driver NN O O
to TO O O
report VB O O
a DT O O
new JJ O O
channel NN O O
exists VBZ O O
. . O O

A DT O O
channel NN O O
represents VBZ O O
an DT O O
established JJ O O
connection NN O O
between IN O O
the DT O O
Driver NN O O
and CC O O
an DT O O
external JJ O O
party NN O O
that WDT O O
has VBZ O O
provided VBN O O
the DT O O
proper JJ O O
initial JJ O O
request NN O O
and CC O O
, , O O
for IN O O
Gen NN O O
1.2 CD O O
variants NNS O O
, , O O
provided VBD O O
the DT O O
proper JJ O O
authentication NN O O
value NN O O
. . O O

When WRB O O
the DT O O
Driver NN O O
establishes VBZ O O
a DT O O
new JJ O O
channel NN O O
, , O O
the DT B-Entity 1
DLL NNP I-Entity O
generates VBZ O O
a DT O O
runtime NN O O
data NN O O
structure NN O O
before IN O O
generating VBG B-Action 2
a DT B-Entity 3
new JJ I-Entity O
thread NN I-Entity O
( NN I-Entity O
'' '' I-Entity O
HikitThreadFunc NNP I-Entity O
'' '' I-Entity O
) NN I-Entity O
which WDT I-Entity O
will MD I-Entity O
service VB I-Entity O
any DT I-Entity O
request NN I-Entity O
coming VBG I-Entity O
from IN I-Entity O
the DT I-Entity O
new JJ I-Entity O
channel NN I-Entity O
. . O O

This DT O O
allows VBZ O O
the DT O O
DLL NNP O O
to TO O O
service VB O O
multiple JJ O O
channels NNS O O
at IN O O
one CD O O
time NN O O
. . O O

The DT O O
HikitThreadFunc NNP O O
function NN O O
is VBZ O O
, , O O
at IN O O
its PRP$ O O
core NN O O
, , O O
a DT O O
simple JJ O O
wait NN O O
and CC O O
respond NN O O
loop NN O O
. . O O

The DT O O
function NN O O
begins VBZ O O
by IN O O
transmitting VBG O O
a DT O O
Hikit JJ O O
command NN O O
prompt JJ O O
to TO O O
the DT O O
client NN O O
( FW O O
Hikit FW O O
> JJR O O
) NN O O
before IN O O
settling VBG O O
into IN O O
an DT O O
infinite JJ O O
loop NN O O
of IN O O
The DT O O
communication NN O O
scheme NN O O
between IN O O
the DT O O
DLL NNP O O
and CC O O
the DT O O
client NN O O
consists VBZ O O
of IN O O
a DT O O
20 CD O O
to TO O O
24 CD O O
byte NN O O
header NN O O
( NN O O
for IN O O
Gen NN O O
1.0 CD O O
and CC O O
Gen NN O O
1.1 CD O O
) NN O O
or CC O O
a DT O O
28 CD O O
byte NN O O
header NN O O
( NN O O
for IN O O
Gen NN O O
1.2 CD O O
) NN O O
followed VBN O O
by IN O O
an DT O O
optional JJ O O
payload NN O O
. . O O

The DT O O
format NN O O
of IN O O
the DT O O
Gen NN O O
1.0 CD O O
and CC O O
Gen NN O O
1.1 CD O O
header NN O O
is VBZ O O
as IN O O
follows VBZ O O
: : O O
While IN O O
the DT O O
Gen NN O O
1.2 CD O O
header NN O O
is VBZ O O
: : O O
For IN O O
Gen NN O O
1.0 CD O O
and CC O O
Gen NN O O
1.1 CD O O
samples NNS O O
, , O O
the DT O O
magic JJ O O
field NN O O
contains VBZ O O
the DT O O
string NN O O
'' '' O O
.. FW O O

.. FW O O

'' '' O O
( CD O O
two CD O O
dots NNS O O
followed VBN O O
by IN O O
a DT O O
space NN O O
then RB O O
two CD O O
more JJR O O
dots NNS O O
) VBP O O
. . O O

Whereas IN O O
the DT O O
key JJ O O
field NN O O
in IN O O
Gen NN O O
1.2 CD O O
samples NNS O O
contains VBZ O O
a DT O O
32-bit JJ O O
value NN O O
that WDT O O
represents VBZ O O
the DT O O
XOR NNP O O
key NN O O
for IN O O
the DT O O
remainder NN O O
of IN O O
the DT O O
PacketHeader NNP O O
and CC O O
any DT O O
additional JJ O O
payload NN O O
data NNS O O
. . O O

The DT O O
XOR NN O O
scheme NN O O
works VBZ O O
on IN O O
32-bit JJ O O
chunks NNS O O
of IN O O
data NNS O O
where WRB O O
each DT O O
32-bit JJ O O
chunk NN O O
of IN O O
data NNS O O
is VBZ O O
XOR NNP O O
'd NNP O O
against IN O O
the DT O O
key JJ O O
value NN O O
. . O O

Version NN O O
checking NN O O
is VBZ O O
important JJ O O
in IN O O
all DT O O
Gen NN O O
1 CD O O
variants NNS O O
. . O O

The DT B-Entity 1
dwHikitVersion NN I-Entity O
field NN I-Entity O
allows VBZ B-Action 2
the DT B-Entity 3
client NN I-Entity O
and CC I-Entity O
the DT I-Entity O
DLL NNP I-Entity O
to TO B-Modifier 4
ensure VB B-Entity 5
that IN I-Entity O
they PRP I-Entity O
have VBP I-Entity O
a DT I-Entity O
compatible JJ I-Entity O
communication NN I-Entity O
scheme NN I-Entity O
in IN I-Entity O
place NN I-Entity O
prior RB B-Modifier 6
to TO I-Modifier O
executing VBG B-Entity 7
commands NNS I-Entity O
. . O O

Gen NN O O
1 CD O O
samples NNS O O
have VBP O O
a DT O O
particular JJ O O
interest NN O O
in IN O O
the DT O O
victim NN O O
's POS O O
locale NN O O
language NN O O
preferences NNS O O
. . O O

While IN O O
it PRP O O
is VBZ O O
typical JJ O O
for IN O O
most JJS O O
RATs NNS O O
that WDT O O
provide VBP O O
remote JJ O O
shells NNS O O
to TO O O
simply RB O O
pass VB O O
data NNS O O
unfiltered JJ O O
from IN O O
client NN O O
to TO O O
server NN O O
and CC O O
server NN O O
to TO O O
client NN O O
without IN O O
regard NN O O
to TO O O
code VB O O
pages NNS O O
, , O O
Gen NN O O
1 CD O O
samples NNS O O
take VBP O O
special JJ O O
care NN O O
to TO O O
record VB O O
the DT O O
code NN O O
page NN O O
and CC O O
locale NN O O
information NN O O
in IN O O
each DT O O
and CC O O
every DT O O
packet NN O O
header NN O O
that WDT O O
traverses VBZ O O
the DT O O
divide NN O O
between IN O O
client NN O O
and CC O O
server NN O O
and CC O O
server NN O O
and CC O O
client NN O O
. . O O

This DT O O
could MD O O
indicate VB O O
that IN O O
the DT O O
authors NNS O O
of IN O O
Gen NN O O
1 CD O O
understood VBN O O
from IN O O
an DT O O
early JJ O O
stage NN O O
in IN O O
the DT O O
development NN O O
of IN O O
Gen NN O O
1 CD O O
that IN O O
they PRP O O
would MD O O
be VB O O
attacking VBG O O
computer NN O O
systems NNS O O
with IN O O
different JJ O O
locales NNS O O
and CC O O
code NN O O
pages NNS O O
. . O O

The DT B-Entity 1
Gen NN I-Entity O
2 CD I-Entity O
sub-family NN I-Entity O
, , O O
like IN O O
Gen NN O O
1.2 CD O O
, , O O
uses VBZ B-Action 2
a DT B-Entity 3
DLL NNP I-Entity O
for IN B-Modifier 4
the DT B-Entity 5
core NN I-Entity O
of IN I-Entity O
its PRP$ I-Entity O
RAT NN I-Entity O
functionality NN I-Entity O
. . O O

In IN B-Modifier 1
order NN I-Modifier O
for IN I-Modifier O
the DT B-Entity 2
DLL NNP I-Entity O
to TO I-Entity O
load VB I-Entity O
, , O O
Gen NN B-Entity 3
2 CD I-Entity O
( NN O O
starting VBG O O
with IN O O
Gen NN O O
2.1 CD O O
) NN O O
uses VBZ B-Action 4
a DT B-Entity 5
loader NN I-Entity O
application NN I-Entity O
( NN O O
referred VBD O O
to TO O O
simply RB O O
as IN O O
'' '' O O
the DT O O
Loader NNP O O
'' '' O O
) NNP O O
. . O O

The DT O O
Loader NNP O O
comes VBZ O O
in IN O O
the DT O O
form NN O O
of IN O O
a DT O O
standard JJ O O
executable JJ O O
image NN O O
or CC O O
a DT O O
DLL NNP O O
image NN O O
. . O O

Despite IN O O
the DT O O
different JJ O O
models NNS O O
, , O O
both DT B-Entity 1
variants NNS I-Entity O
of IN I-Entity O
the DT I-Entity O
Loader NNP I-Entity O
load VB B-Action 2
the DT B-Entity 3
embedded JJ I-Entity O
DLL NNP I-Entity O
in IN B-Modifier 4
the DT B-Entity 5
exact JJ I-Entity O
same JJ I-Entity O
way NN I-Entity O
. . O O

The DT O O
only JJ O O
difference NN O O
between IN O O
the DT O O
executable JJ O O
and CC O O
DLL NNP O O
versions NNS O O
of IN O O
the DT O O
Loader NNP O O
comes VBZ O O
in IN O O
how WRB O O
they PRP O O
handle VBP O O
the DT O O
initialization NN O O
of IN O O
the DT O O
embedded JJ O O
DLL NNP O O
. . O O

Figure NNP O O
1 CD O O
provides VBZ O O
a DT O O
side NN O O
by IN O O
side JJ O O
comparison NN O O
of IN O O
the DT O O
startup NN O O
routines NNS O O
for IN O O
the DT O O
executable JJ O O
and CC O O
DLL NNP O O
Loaders NNPS O O
. . O O

Both DT B-Entity 1
versions NNS I-Entity O
of IN I-Entity O
the DT I-Entity O
Loader NNP I-Entity O
begin VB O O
by IN O O
loading VBG B-Action 2
the DT B-Entity 3
embedded JJ I-Entity O
DLL NNP I-Entity O
from IN B-Modifier 4
the DT B-Entity 5
Loader NNP I-Entity O
's POS I-Entity O
resources NNS I-Entity O
( CD O O
item NN O O
102 CD O O
under IN O O
the DT O O
Group NNP O O
Icons NNP O O
resource NN O O
tree NN O O
) NN O O
, , O O
decrypting VBG O O
and CC O O
decompressing VBG O O
the DT O O
image NN O O
into IN O O
memory NN O O
, , O O
then RB O O
manually RB O O
loading VBG B-Action 6
the DT B-Entity 7
DLL NNP I-Entity O
into IN B-Modifier 8
memory NN B-Entity 9
using VBG B-Modifier 10
a DT B-Entity 11
custom NN I-Entity O
loading VBG I-Entity O
routine NN I-Entity O
. . O O

The DT O O
function NN O O
LoadEmbeddedImage NNP O O
, , O O
as IN O O
seen VBN O O
in IN O O
part NN O O
in IN O O
Figure NNP O O
2 CD O O
, , O O
is VBZ O O
responsible JJ O O
for IN O O
this DT O O
operation NN O O
. . O O

The DT O O
Loader NNP O O
obfuscates VBZ O O
many JJ O O
strings NNS O O
by IN O O
using VBG O O
a DT O O
simple JJ O O
XOR NN O O
encoding NN O O
scheme NN O O
. . O O

Decryption NN O O
of IN O O
encoded VBN O O
strings NNS O O
consists VBZ O O
of IN O O
taking VBG O O
the DT O O
first JJ O O
value NN O O
of IN O O
the DT O O
string NN O O
as IN O O
the DT O O
XOR NN O O
key NN O O
, , O O
XOR'ing VBG O O
all DT O O
subsequent JJ O O
bytes NNS O O
until IN O O
the DT O O
result NN O O
of IN O O
the DT O O
XOR NN O O
returns NNS O O
0 CD O O
. . O O

The DT O O
decoding NN O O
of IN O O
the DT O O
encoded VBN O O
strings NNS O O
is VBZ O O
handled VBN O O
by IN O O
the DT O O
DecodeString NN O O
function NN O O
. . O O

The DT O O
Loader NNP O O
stores VBZ O O
the DT O O
embedded JJ O O
DLL NN O O
within IN O O
a DT O O
Group NNP O O
Icon NNP O O
resource NN O O
within IN O O
a DT O O
legitimate JJ O O
icon NN O O
image NN O O
. . O O

In IN O O
order NN O O
to TO O O
locate VB O O
the DT O O
embedded JJ O O
DLL NNP O O
, , O O
LoadEmbeddedImage NNP O O
will MD O O
use VB O O
the DT O O
DecodeString NNP O O
function NN O O
to TO O O
decrypt VB O O
the DT O O
delimiter NN O O
string NN O O
( NN O O
which WDT O O
is VBZ O O
typically RB O O
zzzzzzzzzz JJ O O
or CC O O
yyyyyyyyyy JJ O O
) NN O O
and CC O O
then RB O O
search VB O O
the DT O O
icon's JJ O O
resource NN O O
memory NN O O
for IN O O
the DT O O
delimiter NN O O
string NN O O
. . O O

Once RB O O
located JJ O O
, , O O
LoadEmbeddedImage NNP O O
will MD O O
use VB O O
the DT O O
first JJ O O
12 CD O O
bytes NNS O O
immediately RB O O
after IN O O
the DT O O
string NN O O
as IN O O
the DT O O
information NN O O
structure NN O O
about IN O O
the DT O O
embedded JJ O O
DLL NNP O O
. . O O

The DT O O
structure NN O O
( NN O O
seen VBN O O
below IN O O
) NN O O
defines VBZ O O
the DT O O
size NN O O
of IN O O
the DT O O
embedded JJ O O
DLL NN O O
within IN O O
the DT O O
icon NN O O
's POS O O
resource NN O O
memory NN O O
, , O O
the DT O O
size NN O O
of IN O O
the DT O O
DLL NNP O O
after IN O O
it PRP O O
is VBZ O O
decompressed VBN O O
and CC O O
a DT O O
4-byte JJ O O
XOR NN O O
key NN O O
that IN O O
LoadEmbeddedImage NNP O O
must MD O O
use VB O O
to TO O O
decode VB O O
the DT O O
embedded JJ O O
DLL NNP O O
prior RB O O
to TO O O
decompression NN O O
. . O O

LoadEmbeddedImage NN B-Entity 1
copies NNS B-Action 2
the DT B-Entity 3
compressed VBN I-Entity O
embedded JJ I-Entity O
DLL NNP I-Entity O
into IN B-Modifier 4
a DT B-Entity 5
newly RB I-Entity O
allocated VBN I-Entity O
heap NN I-Entity O
buffer NN I-Entity O
and CC O O
then RB O O
calls VBZ B-Action 6
the DT B-Entity 7
function NN I-Entity O
decodeBuffer NN I-Entity O
( NN I-Entity O
using VBG I-Entity O
the DT I-Entity O
EncodingKey NNP I-Entity O
value NN I-Entity O
) NN I-Entity O
to TO B-Modifier 8
decrypt VB B-Entity 9
the DT I-Entity O
embedded JJ I-Entity O
DLL NNP I-Entity O
. . O O

Another DT O O
heap NN O O
buffer NN O O
is VBZ O O
allocated VBN O O
with IN O O
a DT O O
size NN O O
equal JJ O O
to TO O O
the DT O O
value NN O O
of IN O O
dwImageSizeDecompressed NN O O
. . O O

The DT O O
decompression NN O O
buffer NN O O
along IN O O
with IN O O
the DT O O
now RB O O
decoded VBN O O
compressed VBN O O
buffer NN O O
are VBP O O
given VBN O O
to TO O O
lzodecompress NN O O
which WDT O O
decompresses VBZ O O
the DT O O
compressed VBN O O
image NN O O
using VBG O O
the DT O O
LZO1X NN O O
algorithm NN O O
. . O O

With IN O O
the DT O O
embedded JJ O O
DLL NNP O O
now RB O O
decompressed VBN O O
into IN O O
a DT O O
heap NN O O
buffer NN O O
, , O O
LoadEmbeddedImage NNP B-Entity 1
calls VBZ B-Action 2
ImageLoaderData NNP B-Entity 3
: : I-Entity O
:LoadDll NN I-Entity O
to TO O O
manually RB O O
load VB B-Action 4
the DT B-Entity 5
DLL NNP I-Entity O
into IN B-Modifier 6
memory NN B-Entity 7
. . O O

ImageLoaderData NNP B-Entity 1
: : I-Entity O
:LoadDll NN I-Entity O
interprets VBZ O O
the DT O O
PE/COFF NN O O
header NN O O
of IN O O
the DT O O
DLL NNP O O
image NN O O
, , O O
loads NNS B-Action 2
the DT B-Entity 3
image NN I-Entity O
into IN B-Modifier 4
the DT B-Entity 5
appropriate JJ I-Entity O
memory NN I-Entity O
configuration NN I-Entity O
, , O O
performs VBZ O O
the DT O O
necessary JJ O O
relocation NN O O
operations NNS O O
, , O O
and CC O O
calls VBZ B-Action 6
the DT B-Entity 7
DllMain NNP I-Entity O
( NNP I-Entity O
DLL NNP I-Entity O
's POS I-Entity O
entry NN I-Entity O
point NN I-Entity O
) NN I-Entity O
function NN I-Entity O
. . O O

After IN O O
loading VBG B-Action 1
the DT B-Entity 2
embedded JJ I-Entity O
DLL NNP I-Entity O
image NN I-Entity O
into IN B-Modifier 3
memory NN B-Entity 4
, , O O
the DT B-Entity 5
Loader NNP I-Entity O
will MD O O
either RB O O
call VB B-Action 6
the DT B-Entity 7
DLL's NNP I-Entity O
StartServer NNP I-Entity O
or CC I-Entity O
MatrixMain NNP I-Entity O
function NN I-Entity O
depending VBG O O
on IN O O
the DT O O
type NN O O
of IN O O
Loader NNP O O
. . O O

The DT B-Entity 1
standalone JJ I-Entity O
Loaders NNS I-Entity O
use VBP B-Action 2
the DT B-Entity 3
MatrixMain NNP I-Entity O
function NN I-Entity O
while IN O O
the DT B-Entity 4
DLL NNP I-Entity O
Loaders NNP I-Entity O
will MD O O
call VB B-Action 5
the DT B-Entity 6
StartServer NNP I-Entity O
function NN I-Entity O
. . O O

The DT B-Entity 1
Loaders NNP I-Entity O
, , O O
upon IN B-Modifier 2
unloading VBG B-Entity 3
, , O O
will MD O O
call VB B-Action 4
the DT B-Entity 5
StopServer NNP I-Entity O
function NN I-Entity O
in IN B-Modifier 6
order NN I-Modifier O
to TO I-Modifier O
shut VB B-Entity 7
down RP I-Entity O
the DT I-Entity O
embedded JJ I-Entity O
DLL NNP I-Entity O
. . O O

The DT O O
Gen NN O O
2 CD O O
DLL NNP O O
exposes VBZ O O
five CD O O
exported VBN O O
functions NNS O O
( VBP O O
besides IN O O
the DT O O
DllEntryPoint/DllMain NNP O O
) NNP O O
. . O O

MatrixMain NNP B-Entity 1
and CC I-Entity O
StartServer NNP I-Entity O
both DT O O
ultimately RB O O
generate VB B-Action 2
a DT B-Entity 3
new JJ I-Entity O
thread NN I-Entity O
( NN O O
using VBG B-Modifier 4
the DT B-Entity 5
POSIX NNP I-Entity O
API NNP I-Entity O
function NN I-Entity O
beginthreadex NN I-Entity O
instead RB B-Modifier 6
of IN I-Modifier O
the DT B-Entity 7
more RBR I-Entity O
common JJ I-Entity O
CreateThread NNP I-Entity O
) NN O O
that WDT O O
contains VBZ O O
the DT O O
main JJ O O
loop NN O O
of IN O O
the DT O O
Gen NN O O
2 CD O O
RAT NN O O
functionality NN O O
. . O O

MatrixMain NNP O O
, , O O
however RB O O
, , O O
has VBZ O O
added VBN O O
functionality NN O O
. . O O

The DT O O
prototype NN O O
for IN O O
MatrixMain NNP O O
is VBZ O O
as IN O O
follows VBZ O O
: : O O
where WRB O O
Arguments NNS O O
parameter NN O O
can MD O O
be VB O O
: : O O
If IN O O
the DT O O
i FW O O
parameter NN O O
is VBZ O O
given VBN O O
, , O O
the DT B-Entity 1
DLL NNP I-Entity O
will MD O O
install VB B-Action 2
itself PRP B-Entity 3
as IN B-Modifier 4
a DT B-Entity 5
service NN I-Entity O
on IN B-Modifier 6
the DT B-Entity 7
victim NN I-Entity O
's POS I-Entity O
machine NN I-Entity O
. . O O

The DT B-Entity 1
DLL NNP I-Entity O
will MD O O
create VB B-Action 2
a DT B-Entity 3
new JJ I-Entity O
service NN I-Entity O
( FW O O
e.g FW O O
. . O O

'' '' O O
Network NNP O O
DDE NNP O O
Service NNP O O
'' '' O O
) NN O O
and CC O O
assign VB O O
itself PRP O O
as IN O O
the DT O O
executable JJ O O
for IN O O
the DT O O
service NN O O
. . O O

The DT B-Entity 1
DLL NNP I-Entity O
's POS I-Entity O
RAT NN I-Entity O
functionality NN I-Entity O
provides VBZ B-Action 2
basic JJ O O
features NNS O O
such JJ O O
as IN O O
network NN O O
port NN O O
forwarding NN O O
( FW O O
proxying FW O O
) NN O O
, , O O
file NN O O
transfer NN O O
, , O O
and CC O O
remote JJ B-Entity 3
command NN I-Entity O
shell NN I-Entity O
. . O O

The DT O O
RAT NN O O
functionality NN O O
provides VBZ O O
an DT O O
attacker NN O O
with IN O O
the DT O O
ability NN O O
to TO O O
establish VB O O
a DT O O
phantom JJ O O
network NN O O
within IN O O
a DT O O
victim NN O O
's POS O O
infrastructure NN O O
by IN O O
having VBG O O
individual JJ B-Entity 1
instances NNS I-Entity O
of IN I-Entity O
Gen NN I-Entity O
2 CD I-Entity O
DLL NNP I-Entity O
listen VB B-Action 2
for IN B-Modifier 3
incoming JJ B-Entity 4
connections NNS I-Entity O
on IN B-Modifier 5
local JJ B-Entity 6
ports NNS I-Entity O
( VBP O O
presumably RB O O
, , O O
NAT NNP O O
'd NNP O O
ports NNS O O
) VBP O O
and CC O O
accept VBP B-Action 7
commands NNS B-Entity 8
from IN B-Modifier 9
the DT B-Entity 10
inbound JJ I-Entity O
connection NN I-Entity O
. . O O

This DT O O
allows VBZ O O
an DT O O
attacker NN O O
to TO O O
establish VB O O
several JJ O O
Gen2 NN O O
infections NNS O O
within IN O O
a DT O O
victim's NN O O
infrastructure NN O O
and CC O O
if IN O O
outbound JJ O O
connectivity NN O O
is VBZ O O
prohibited VBN O O
for IN O O
any DT O O
of IN O O
the DT O O
infected JJ O O
machines NNS O O
, , O O
the DT O O
attacker NN O O
can MD O O
route NN O O
commands NNS O O
to TO O O
the DT O O
pseudo-isolated JJ O O
infections NNS O O
through IN O O
accessible JJ O O
infected JJ O O
machines NNS O O
providing VBG B-Action 1
a DT B-Entity 2
high JJ I-Entity O
level NN I-Entity O
of IN I-Entity O
persistence NN I-Entity O
to TO B-Modifier 3
the DT B-Entity 4
malware NN I-Entity O
. . O O

Each DT B-Entity 1
Gen NN I-Entity O
2 CD I-Entity O
infection NN I-Entity O
can MD O O
support VB B-Action 2
up IN B-Modifier 3
to TO I-Modifier O
10 CD B-Entity 4
listening NN I-Entity O
ports NNS I-Entity O
. . O O

The DT B-Entity 1
communication NN I-Entity O
between IN I-Entity O
the DT I-Entity O
Gen NN I-Entity O
2 CD I-Entity O
malware NN I-Entity O
and CC I-Entity O
the DT I-Entity O
C2 NN I-Entity O
( NN O O
or CC O O
other JJ O O
Gen NN O O
2 CD O O
malware NN O O
, , O O
in IN O O
the DT O O
case NN O O
of IN O O
the DT O O
internal JJ O O
routing VBG O O
functionality NN O O
) NN O O
is VBZ B-Action 2
encrypted VBN I-Action O
using VBG B-Modifier 3
a DT B-Entity 4
simple JJ I-Entity O
DWORD NN I-Entity O
XOR NN I-Entity O
scheme NN I-Entity O
. . O O

Each DT O O
communication NN O O
burst NN O O
( NN O O
either CC O O
between IN O O
the DT O O
malware NN O O
and CC O O
the DT O O
C2 NN O O
or CC O O
the DT O O
malware NN O O
and CC O O
neighboring JJ O O
malware NN O O
) NN O O
begins VBZ O O
with IN O O
a DT O O
24-byte JJ O O
header NN O O
identical JJ O O
to TO O O
the DT O O
header NN O O
found VBN O O
in IN O O
Gen NN O O
1.2 CD O O
. . O O

Immediately RB O O
following VBG O O
the DT O O
header NN O O
is VBZ O O
the DT O O
type-specific JJ O O
( NN O O
as IN O O
indicated VBN O O
by IN O O
the DT O O
dwPayloadType NN O O
field NN O O
) CD O O
payload NN O O
data NNS O O
. . O O

Note VB O O
that IN O O
the DT O O
dwXORKey NN O O
value NN O O
is VBZ O O
NOT RB O O
encoded VBN O O
with IN O O
the DT O O
XOR NN O O
value NN O O
, , O O
but CC O O
rather RB O O
is VBZ O O
the DT O O
value NN O O
that WDT O O
is VBZ O O
used VBN O O
for IN O O
encoding VBG O O
the DT O O
header NN O O
and CC O O
payload NN O O
. . O O

Each DT O O
DLL NNP O O
includes VBZ O O
a DT O O
hardcoded NN O O
, , O O
default NN O O
configuration NN O O
. . O O

At IN O O
the DT O O
time NN O O
that IN O O
the DT O O
RAT NN O O
functionality NN O O
activates VBZ O O
, , O O
the DT O O
DLL NNP O O
will MD O O
drop VB O O
the DT O O
current JJ O O
configuration NN O O
to TO O O
disk NN O O
. . O O

If IN O O
the DT O O
configuration NN O O
file NN O O
already RB O O
exists VBZ O O
, , O O
then RB O O
the DT O O
RAT NN O O
will MD O O
use VB O O
the DT O O
file NN O O
version NN O O
of IN O O
the DT O O
configuration NN O O
over IN O O
the DT O O
default NN O O
configuration NN O O
. . O O

The DT O O
configuration NN O O
data NN O O
structure NN O O
( NN O O
seen VBN O O
below IN O O
) NN O O
doubles VBZ O O
as IN O O
a DT O O
current JJ O O
state NN O O
record NN O O
for IN O O
some DT O O
aspects NNS O O
of IN O O
the DT O O
communication NN O O
subsystem NN O O
of IN O O
the DT O O
DLL NNP O O
. . O O

When WRB O O
stored VBN O O
on IN O O
disk NN O O
, , O O
the DT O O
configuration NN O O
is VBZ O O
preceded VBN O O
by IN O O
a DT O O
GUID NN O O
value NN O O
( NN O O
16 CD O O
bytes NNS O O
) NN O O
that WDT O O
represents VBZ O O
the DT O O
unique JJ O O
identifier NN O O
for IN O O
the DT O O
specific JJ O O
infection NN O O
. . O O

The DT O O
configuration NN O O
is VBZ O O
XOR NNP O O
encoded VBN O O
using VBG O O
the DT O O
first JJ O O
4 CD O O
bytes FW O O
( FW O O
as IN O O
a DT O O
DWORD FW O O
) FW O O
of IN O O
the DT O O
GUID NN O O
. . O O

In IN O O
order NN O O
to TO O O
provide VB O O
some DT O O
level NN O O
of IN O O
stealth NN O O
, , O O
the DT B-Entity 1
RAT NN I-Entity O
will MD O O
install VB B-Action 2
a DT B-Entity 3
rootkit NN I-Entity O
on IN B-Modifier 4
32-bit JJ B-Entity 5
versions NNS I-Entity O
of IN I-Entity O
Windows NNP I-Entity O
. . O O

The DT O O
DLL NNP O O
contains VBZ O O
a DT O O
device NN O O
driver NN O O
image NN O O
embedded VBN O O
within IN O O
an DT O O
encoded VBN O O
buffer NN O O
which WDT O O
the DT O O
RAT NN O O
functionality NN O O
code NN O O
will MD O O
extract VB O O
to TO O O
the DT O O
% NN O O
TEMP NN O O
% NN O O
directory NN O O
( NN O O
after IN O O
XOR'ing VBG O O
the DT O O
buffer NN O O
with IN O O
0x76 FW O O
) FW O O
. . O O

To TO O O
activate VB O O
the DT O O
rootkit NN O O
, , O O
the DT B-Entity 1
RAT NN I-Entity O
functionality NN I-Entity O
code NN I-Entity O
creates VBZ B-Action 2
a DT B-Entity 3
service NN I-Entity O
with IN B-Modifier 4
the DT B-Entity 5
driver NN I-Entity O
in IN I-Entity O
the DT I-Entity O
% NN I-Entity O
TEMP NN I-Entity O
% NN I-Entity O
directory NN I-Entity O
as IN I-Entity O
the DT I-Entity O
executable JJ I-Entity O
for IN I-Entity O
the DT I-Entity O
service NN I-Entity O
. . O O

The DT B-Entity 1
RAT NN I-Entity O
functionality NN I-Entity O
code NN I-Entity O
then RB O O
activates VBZ B-Action 2
the DT B-Entity 3
service NN I-Entity O
and CC O O
opens VBZ O O
a DT O O
handle VB O O
to TO O O
device NN O O
driver NN O O
's POS O O
interface NN O O
( FW O O
e.g FW O O
. . O O

\Globals\HTTPS FW O O
) FW O O
. . O O

With IN O O
the DT O O
handle VBP O O
open JJ O O
to TO O O
the DT O O
rootkit NN O O
driver NN O O
, , O O
the DT B-Entity 1
RAT NN I-Entity O
functionality NN I-Entity O
code NN I-Entity O
deletes VBZ B-Action 2
the DT B-Entity 3
service NN I-Entity O
in IN B-Modifier 4
order NN I-Modifier O
to TO I-Modifier O
reduce VB B-Entity 5
the DT I-Entity O
visible JJ I-Entity O
footprint NN I-Entity O
of IN I-Entity O
the DT I-Entity O
new JJ I-Entity O
driver NN I-Entity O
. . O O

To TO O O
further RB O O
reduce VB O O
the DT O O
footprint NN O O
of IN O O
the DT O O
driver NN O O
, , O O
the DT B-Entity 1
RAT NN I-Entity O
functionality NN I-Entity O
code NN I-Entity O
also RB O O
uses VBZ O O
the DT O O
cloaking VBG O O
functionality NN O O
of IN O O
the DT O O
rootkit NN O O
to TO O O
hide VB B-Action 2
the DT B-Entity 3
DLL NNP I-Entity O
's POS I-Entity O
PID NNP I-Entity O
, , O O
any DT O O
references NNS O O
to TO O O
the DT O O
GUID NNP O O
{ NNP O O
4AE26357-79A3-466D-A6D9- NNP O O
FC38BFB67DEA NNP O O
} NNP O O
, , O O
the DT B-Entity 4
DLL NNP I-Entity O
's POS I-Entity O
service NN I-Entity O
names NNS I-Entity O
( FW I-Entity O
e.g FW I-Entity O
. . I-Entity O
'' '' I-Entity O
NetDDESrv NNP I-Entity O
'' '' I-Entity O
and CC I-Entity O
'' '' I-Entity O
Network NNP I-Entity O
DDE NNP I-Entity O
Service NNP I-Entity O
'' '' I-Entity O
) NN I-Entity O
and CC I-Entity O
the DT I-Entity O
service NN I-Entity O
entry NN I-Entity O
as RB I-Entity O
well RB I-Entity O
. . O O

Additionally RB O O
, , O O
the DT B-Entity 1
code NN I-Entity O
also RB O O
attempts VBZ O O
to TO O O
hide VB B-Action 2
a DT B-Entity 3
service NN I-Entity O
named VBN I-Entity O
'' '' I-Entity O
Hitx NNP I-Entity O
'' '' I-Entity O
. . O O

In IN O O
addition NN O O
to TO O O
the DT O O
main JJ O O
Hikit FW O O
malware FW O O
, , O O
there EX O O
are VBP O O
at IN O O
least JJS O O
two CD O O
examples NNS O O
of IN O O
support NN O O
programs NNS O O
that WDT O O
belong VBP O O
to TO O O
the DT O O
Hikit NN O O
family NN O O
. . O O

Samples NNS O O
b04de6c417b6f8836e3f2d8822be2e68f4f9722b NN O O
and CC O O
7c4da9deff3e5c7611b9e1bd67d0e74aa7d2d0f6 NN O O
are VBP O O
examples NNS O O
of IN O O
Gen NN O O
1.0 CD O O
and CC O O
Gen NN O O
1.2 CD O O
operator NN O O
consoles VBZ O O
. . O O

The DT B-Entity 1
console NN I-Entity O
is VBZ O O
a DT O O
text NN O O
based JJ O O
application NN O O
that WDT O O
takes VBZ O O
a DT O O
Gen NN O O
1.0 CD O O
or CC O O
Gen NN O O
1.2 CD O O
infection NN O O
's POS O O
IP NNP O O
address NN O O
and CC O O
proceeds NNS O O
to TO O O
connect VB B-Action 2
and CC I-Action O
authenticate VB I-Action O
with IN B-Modifier 3
the DT B-Entity 4
infected JJ I-Entity O
server NN I-Entity O
. . O O

Once RB O O
connected VBN O O
, , O O
the DT B-Entity 1
operator NN I-Entity O
has VBZ B-Action 2
the DT B-Entity 3
basic JJ I-Entity O
Hikit NN I-Entity O
functionalities NNS I-Entity O
available JJ I-Entity O
to TO I-Entity O
them PRP I-Entity O
via IN B-Modifier 4
commands NNS B-Entity 5
such JJ I-Entity O
as IN I-Entity O
file NN I-Entity O
and CC I-Entity O
shell NN I-Entity O
. . O O

Detecting VBG O O
Hikit JJ O O
variants NNS O O
on IN O O
disk NN O O
and CC O O
in IN O O
memory NN O O
is VBZ O O
possible JJ O O
using VBG O O
the DT O O
following VBG O O
YARA NN O O
signature NN O O
developed VBN O O
by IN O O
Symantec NNP O O
: : O O
Detecting VBG O O
nominal JJ O O
Gen NN O O
1.2 CD O O
and CC O O
later JJ O O
network NN O O
activity NN O O
is VBZ O O
problematic JJ O O
given VBN O O
the DT O O
nature NN O O
of IN O O
the DT O O
communication NN O O
structure NN O O
. . O O

The DT O O
encrypted JJ O O
nature NN O O
of IN O O
the DT O O
nominal JJ O O
Gen NN O O
1.2 CD O O
and CC O O
later JJ O O
network NN O O
traffic NN O O
makes VBZ O O
a DT O O
signature NN O O
difficult JJ O O
. . O O

Snort VB O O
signature NN O O
30948 CD O O
may MD O O
detect VB O O
some DT O O
Hikit NNP O O
based VBN O O
network NN O O
traffic NN O O
for IN O O
only JJ O O
Gen NN O O
1.0 CD O O
and CC O O
Gen NN O O
1.1 CD O O
. . O O

From IN O O
a DT O O
system NN O O
objects NNS O O
perspective NN O O
, , O O
Gen NN B-Entity 1
2 CD I-Entity O
samples NNS I-Entity O
produce VBP B-Action 2
up IN B-Modifier 3
to TO I-Modifier O
three CD B-Entity 4
named VBN I-Entity O
events NNS I-Entity O
. . O O

The DT O O
event NN O O
names NNS O O
change VBP O O
per IN O O
infection NN O O
, , O O
but CC O O
have VBP O O
a DT O O
common JJ O O
format NN O O
. . O O

The DT O O
following JJ O O
three CD O O
strings NNS O O
represent VBP O O
the DT O O
known JJ O O
mutex NN O O
strings NNS O O
for IN O O
Gen NN O O
2 CD O O
samples NNS O O
: : O O
where WRB O O
the DT O O
% NN O O
s NN O O
format NN O O
variable NN O O
is VBZ O O
replaced VBN O O
with IN O O
a DT O O
UUID NN O O
value NN O O
string NN O O
specific JJ O O
to TO O O
the DT O O
infected JJ O O
machine. NN O O
