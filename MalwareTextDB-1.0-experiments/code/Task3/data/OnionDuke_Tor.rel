Recently RB O O
, , O O
research NN O O
was VBD O O
published VBN O O
identifying VBG O O
a DT B-Entity 1
Tor NN I-Entity O
exit NN I-Entity O
node NN I-Entity O
, , O O
located JJ O O
in IN O O
Russia NNP O O
, , O O
that WDT O O
was VBD B-Action 2
consistently RB I-Action O
and CC I-Action O
maliciously RB I-Action O
modifying VBG I-Action O
any DT B-Entity 3
uncompressed JJ I-Entity O
Windows NNP I-Entity O
executables NNS I-Entity O
downloaded VBD I-Entity O
through IN I-Entity O
it PRP I-Entity O
. . O O

Naturally RB O O
this DT O O
piqued VBD O O
our PRP$ O O
interest NN O O
, , O O
so IN O O
we PRP O O
decided VBD O O
to TO O O
peer VB O O
down RP O O
the DT O O
rabbit NN O O
hole NN O O
. . O O

Suffice NNP O O
to TO O O
say VB O O
, , O O
the DT O O
hole NN O O
was VBD O O
a DT O O
lot NN O O
deeper JJR O O
than IN O O
we PRP O O
expected VBD O O
! . O O
In IN O O
fact NN O O
, , O O
it PRP O O
went VBD O O
all PDT O O
the DT O O
way NN O O
back RB O O
to TO O O
the DT O O
notorious JJ O O
Russian NNP O O
APT NNP O O
family NN O O
MiniDuke NNP O O
, , O O
known VBN O O
to TO O O
have VB O O
been VBN O O
used VBN O O
in IN O O
targeted VBN O O
attacks NNS O O
against IN O O
NATO NNP O O
and CC O O
European JJ O O
government NN O O
agencies NNS O O
. . O O

The DT O O
malware NN O O
used VBN O O
in IN O O
this DT O O
case NN O O
is VBZ O O
, , O O
however RB O O
, , O O
not RB O O
a DT O O
version NN O O
of IN O O
MiniDuke NNP O O
. . O O

It PRP O O
is VBZ O O
instead RB O O
a DT O O
separate JJ O O
, , O O
distinct JJ O O
family NN O O
of IN O O
malware NN O O
that IN O O
we PRP O O
have VBP O O
since IN O O
taken VBN O O
to TO O O
calling VBG O O
OnionDuke NNP O O
. . O O

But CC O O
lets VBZ O O
start NN O O
from IN O O
the DT O O
beginning NN O O
. . O O

When WRB O O
a DT O O
user NN O O
attempts VBZ O O
to TO O O
download VB O O
an DT O O
executable JJ O O
via IN O O
the DT O O
malicious JJ O O
Tor NN O O
exit NN O O
node NN O O
, , O O
what WP O O
they PRP O O
actually RB O O
receive VBP O O
is VBZ O O
an DT O O
executable JJ O O
'' '' O O
wrapper NN O O
'' '' O O
that WDT O O
embeds VBZ O O
both CC O O
the DT O O
original JJ O O
executable JJ O O
and CC O O
a DT O O
second JJ O O
, , O O
malicious JJ O O
executable JJ O O
. . O O

By IN B-Modifier 1
using VBG B-Entity 2
a DT I-Entity O
separate JJ I-Entity O
wrapper NN I-Entity O
, , O O
the DT B-Entity 3
malicious JJ I-Entity O
actors NNS I-Entity O
are VBP O O
able JJ O O
to TO O O
bypass VB B-Action 4
any DT B-Entity 5
integrity NN I-Entity O
checks VBZ I-Entity O
the DT I-Entity O
original JJ I-Entity O
binary JJ I-Entity O
might MD I-Entity O
contain VB I-Entity O
. . O O

Upon IN O O
execution NN O O
, , O O
the DT O O
wrapper NN O O
will MD O O
proceed VB O O
to TO O O
write VB O O
to TO O O
disk NN O O
and CC O O
execute VB O O
the DT O O
original JJ O O
executable JJ O O
, , O O
thereby RB O O
tricking VBG O O
the DT O O
user NN O O
into IN O O
believing VBG O O
that DT O O
everything NN O O
went VBD O O
fine JJ O O
. . O O

However RB O O
, , O O
the DT O O
wrapper NN O O
will MD O O
also RB O O
write VB O O
to TO O O
disk NN O O
and CC O O
execute VB O O
the DT O O
second JJ O O
executable JJ O O
. . O O

In IN O O
all PDT O O
the DT O O
cases NNS O O
we PRP O O
have VBP O O
observed VBN O O
, , O O
this DT O O
malicious JJ O O
executable JJ O O
has VBZ O O
been VBN O O
the DT O O
same JJ O O
binary JJ O O
( NN O O
SHA1 NN O O
: : O O
a75995f94854dea8799650a2f4a97980b71199d2 NN O O
, , O O
detected VBN O O
as IN O O
Trojan-Dropper NNP O O
: : O O
W32/OnionDuke.A FW O O
) FW O O
. . O O

This DT B-Entity 1
executable JJ I-Entity O
is VBZ B-Action 2
a DT B-Entity 3
dropper NN I-Entity O
containing VBG O O
a DT B-Entity 4
PE NN I-Entity O
resource NN I-Entity O
that WDT O O
pretends VBZ B-Action 5
to TO B-Modifier 6
be VB B-Entity 7
an DT I-Entity O
embedded JJ I-Entity O
GIF NN I-Entity O
image NN I-Entity O
file NN I-Entity O
. . O O

In IN O O
reality NN O O
, , O O
the DT O O
resource NN O O
is VBZ O O
actually RB O O
an DT O O
encrypted JJ O O
dynamically RB O O
linked VBN O O
library NN O O
( NN O O
DLL NN O O
) NN O O
file NN O O
. . O O

The DT B-Entity 1
dropper NN I-Entity O
will MD O O
proceed VB B-Action 2
to TO B-Modifier 3
decrypt VB B-Entity 4
this DT I-Entity O
DLL NNP I-Entity O
, , I-Entity O
write VB I-Entity O
it PRP I-Entity O
to TO I-Entity O
disk NN I-Entity O
and CC I-Entity O
execute VB I-Entity O
it PRP I-Entity O
. . O O

Once RB O O
executed VBN O O
, , O O
the DT B-Entity 1
DLL NNP I-Entity O
file NN I-Entity O
( NN O O
SHA1 NN O O
: : O O
b491c14d8cfb48636f6095b7b16555e9a575d57f NN O O
, , O O
detected VBN O O
as IN O O
Backdoor NNP O O
: : O O
W32/OnionDuke.B NNP O O
) NNP O O
will MD O O
decrypt VB O O
an DT O O
embedded JJ O O
configuration NN O O
( NN O O
shown VBN O O
below IN O O
) NN O O
and CC O O
attempt NN O O
to TO O O
connect VB B-Action 2
to TO B-Modifier 3
hardcoded JJ B-Entity 4
C NN I-Entity O
& CC I-Entity O
C NN I-Entity O
URLs NNS I-Entity O
specified VBN I-Entity O
in IN I-Entity O
the DT I-Entity O
configuration NN I-Entity O
data NNS I-Entity O
. . O O

From IN O O
these DT O O
C NNP O O
& CC O O
Cs NNP O O
the DT B-Entity 1
malware NN I-Entity O
may MD O O
receive VB B-Action 2
instructions NNS B-Entity 3
to TO O O
download VB B-Action 4
and CC I-Action O
execute VB I-Action O
additional JJ B-Entity 5
malicious JJ I-Entity O
components NNS I-Entity O
. . O O

It PRP O O
should MD O O
be VB O O
noted VBN O O
, , O O
that IN O O
we PRP O O
believe VBP O O
all DT O O
five CD O O
domains NNS O O
contacted VBN O O
by IN O O
the DT O O
malware NN O O
are VBP O O
innocent JJ O O
websites NNS O O
compromised VBN O O
by IN O O
the DT O O
malware NN O O
operators NNS O O
, , O O
not RB O O
dedicated VBN O O
malicious JJ O O
servers NNS O O
. . O O

Through IN O O
our PRP$ O O
research NN O O
, , O O
we PRP O O
have VBP O O
also RB O O
been VBN O O
able JJ O O
to TO O O
identify VB O O
multiple JJ O O
other JJ O O
components NNS O O
of IN O O
the DT O O
OnionDuke NNP O O
malware NN O O
family NN O O
. . O O

We PRP O O
have VBP O O
, , O O
for IN O O
instance NN O O
, , O O
observed VBN O O
components NNS B-Entity 1
dedicated VBN O O
to TO O O
stealing VBG B-Action 2
login NN B-Entity 3
credentials NNS I-Entity O
from IN B-Modifier 4
the DT B-Entity 5
victim NN I-Entity O
machine NN I-Entity O
and CC O O
components NNS B-Entity 6
dedicated VBN O O
to TO O O
gathering VBG B-Action 7
further JJ B-Entity 8
information NN I-Entity O
on IN I-Entity O
the DT I-Entity O
compromised VBN I-Entity O
system NN I-Entity O
like IN I-Entity O
the DT I-Entity O
presence NN I-Entity O
of IN I-Entity O
antivirus NN I-Entity O
software NN I-Entity O
or CC I-Entity O
a DT I-Entity O
firewall NN I-Entity O
. . O O

Some DT B-Entity 1
of IN I-Entity O
these DT I-Entity O
components NNS I-Entity O
have VBP O O
been VBN O O
observed VBN O O
being VBG B-Action 2
downloaded VBN I-Action O
and CC I-Action O
executed VBN I-Action O
by IN O O
the DT B-Entity 3
original JJ I-Entity O
backdoor JJ I-Entity O
process NN I-Entity O
but CC O O
for IN O O
other JJ O O
components NNS O O
, , O O
we PRP O O
have VBP O O
yet RB O O
to TO O O
identify VB O O
the DT O O
infection NN O O
vector NN O O
. . O O

Most JJS B-Entity 1
of IN I-Entity O
these DT I-Entity O
components NNS I-Entity O
do VBP O O
n't RB O O
embed VB O O
their PRP$ O O
own JJ O O
C NN O O
& CC O O
C NN O O
information NN O O
but CC O O
rather RB O O
communicate VBP B-Action 2
with IN B-Modifier 3
their PRP$ B-Entity 4
controllers NNS I-Entity O
through IN B-Modifier 5
the DT B-Entity 6
original JJ I-Entity O
backdoor JJ I-Entity O
process NN I-Entity O
. . O O

One CD O O
component NN O O
, , O O
however RB O O
, , O O
is VBZ O O
an DT O O
interesting JJ O O
exception NN O O
. . O O

This DT B-Entity 1
DLL NNP I-Entity O
file NN I-Entity O
( NNP O O
SHA1 NNP O O
d433f281cf56015941a1c2cb87066ca62ea1db37 NNP O O
, , O O
detected VBN O O
as IN O O
Backdoor NNP O O
: : O O
W32/OnionDuke.A FW O O
) FW O O
contains VBZ B-Action 2
among IN B-Modifier 3
its PRP$ B-Entity 4
configuration NN I-Entity O
data NNS I-Entity O
a DT B-Entity 5
different JJ I-Entity O
hardcoded NN I-Entity O
C NN I-Entity O
& CC I-Entity O
C NN I-Entity O
domain NN I-Entity O
, , I-Entity O
overpict.com NN I-Entity O
and CC O O
also RB O O
evidence NN O O
suggesting VBG O O
that IN O O
this DT B-Entity 6
component NN I-Entity O
may MD O O
abuse VB B-Action 7
Twitter NNP B-Entity 8
as IN B-Modifier 9
an DT B-Entity 10
additional JJ I-Entity O
C NN I-Entity O
& CC I-Entity O
C NN I-Entity O
channel NN I-Entity O
. . O O

What WP O O
makes VBZ O O
the DT O O
overpict.com NN O O
domain NN O O
interesting JJ O O
, , O O
is VBZ O O
it PRP O O
was VBD O O
originally RB O O
registered VBN O O
in IN O O
2011 CD O O
with IN O O
the DT O O
alias NNS O O
of IN O O
'' '' O O
John NNP O O
Kasai NNP O O
'' '' O O
. . O O

Within IN O O
a DT O O
two-week JJ O O
window NN O O
, , O O
'' '' O O
John NNP O O
Kasai NNP O O
'' '' O O
also RB O O
registered VBD O O
the DT O O
following JJ O O
domains NNS O O
: : O O
airtravelabroad.com NN O O
, , O O
beijingnewsblog.net NN O O
, , O O
grouptumbler.com NN O O
, , O O
leveldelta.com NN O O
, , O O
nasdaqblog.net NN O O
, , O O
natureinhome.com NN O O
, , O O
nestedmail.com NN O O
, , O O
nostressjob.com NN O O
, , O O
nytunion.com NN O O
, , O O
oilnewsblog.com NN O O
, , O O
sixsquare.net NN O O
and CC O O
ustradecomp.com NN O O
. . O O

This DT O O
is VBZ O O
significant JJ O O
because IN O O
the DT B-Entity 1
domains NNS I-Entity O
leveldelta.com NN I-Entity O
and CC I-Entity O
grouptumbler.com NN I-Entity O
have VBP O O
previously RB O O
been VBN B-Action 2
identified VBN I-Action O
as IN B-Modifier 3
C NN B-Entity 4
& CC I-Entity O
C NN I-Entity O
domains NNS I-Entity O
used VBN I-Entity O
by IN I-Entity O
MiniDuke NNP I-Entity O
. . O O

This NNP O O
strongly RB O O
suggests VBZ O O
that IN O O
although IN O O
OnionDuke NNP O O
and CC O O
MiniDuke NNP O O
are VBP O O
two CD O O
separate JJ O O
families NNS O O
of IN O O
malware NN O O
, , O O
the DT O O
actors NNS O O
behind IN O O
them PRP O O
are VBP O O
connected VBN O O
through IN O O
the DT O O
use NN O O
of IN O O
shared JJ O O
infrastructure NN O O
. . O O

Based VBN O O
on IN O O
compilation NN O O
timestamps NNS O O
and CC O O
discovery NN O O
dates NNS O O
of IN O O
samples NNS O O
we PRP O O
have VBP O O
observed VBN O O
, , O O
we PRP O O
believe VBP O O
the DT B-Entity 1
OnionDuke NNP I-Entity O
operators NNS I-Entity O
have VBP O O
been VBN B-Action 2
infecting VBG I-Action O
downloaded VBN B-Entity 3
executables NNS I-Entity O
at IN O O
least JJS O O
since IN B-Modifier 4
the DT B-Entity 5
end NN I-Entity O
of IN I-Entity O
October NNP I-Entity O
2013 CD I-Entity O
. . O O

We PRP O O
also RB O O
have VBP O O
evidence NN O O
suggesting VBG O O
that IN O O
, , O O
at IN O O
least JJS O O
since IN O O
February NNP O O
of IN O O
2014 CD O O
, , O O
OnionDuke NNP B-Entity 1
has VBZ O O
not RB O O
only RB O O
been VBN B-Action 2
spread VBN I-Action O
by IN B-Modifier 3
modifying VBG B-Entity 4
downloaded VBN I-Entity O
executables NNS I-Entity O
but CC O O
also RB O O
by IN B-Modifier 5
infecting VBG B-Entity 6
executables NNS I-Entity O
in IN I-Entity O
.torrent JJ I-Entity O
files NNS I-Entity O
containing VBG I-Entity O
pirated VBN I-Entity O
software NN I-Entity O
. . O O

However RB O O
, , O O
it PRP O O
would MD O O
seem VB O O
that IN O O
the DT O O
OnionDuke NNP O O
family NN O O
is VBZ O O
much RB O O
older JJR O O
, , O O
both DT O O
based VBN O O
on IN O O
older JJR O O
compilation NN O O
timestamps NNS O O
and CC O O
also RB O O
on IN O O
the DT O O
fact NN O O
that IN O O
some DT O O
of IN O O
the DT O O
embedded JJ O O
configuration NN O O
data NNS O O
make VBP O O
reference NN O O
to TO O O
an DT O O
apparent JJ O O
version NN O O
number NN O O
of IN O O
4 CD O O
suggesting VBG O O
that IN O O
at IN O O
least JJS O O
three CD O O
earlier JJR O O
versions NNS O O
of IN O O
the DT O O
family NN O O
exist VBP O O
. . O O

During IN O O
our PRP$ O O
research NN O O
, , O O
we PRP O O
have VBP O O
also RB O O
uncovered VBN O O
strong JJ O O
evidence NN O O
suggesting VBG O O
that IN O O
OnionDuke NNP O O
has VBZ O O
been VBN O O
used VBN O O
in IN O O
targeted VBN O O
attacks NNS O O
against IN O O
European JJ O O
government NN O O
agencies NNS O O
, , O O
although IN O O
we PRP O O
have VBP O O
so RB O O
far RB O O
been VBN O O
unable JJ O O
to TO O O
identify VB O O
the DT O O
infection NN O O
vector NN O O
( CD O O
s NN O O
) NN O O
. . O O

Interestingly RB O O
, , O O
this DT O O
would MD O O
suggest VB O O
two CD O O
very RB O O
different JJ O O
targeting NN O O
strategies NNS O O
. . O O

On IN O O
one CD O O
hand NN O O
is VBZ O O
the DT O O
'' '' O O
shooting VBG O O
a DT O O
fly NN O O
with IN O O
a DT O O
cannon NN O O
'' '' O O
mass-infection NN O O
strategy NN O O
through IN O O
modified VBN O O
binaries NNS O O
and CC O O
, , O O
on IN O O
the DT O O
other JJ O O
, , O O
the DT O O
more RBR O O
surgical JJ O O
targeting NN O O
traditionally RB O O
associated VBN O O
with IN O O
APT NN O O
operations NNS O O
. . O O

In IN O O
any DT O O
case NN O O
, , O O
although IN O O
much JJ O O
is VBZ O O
still RB O O
shrouded VBN O O
in IN O O
mystery NN O O
and CC O O
speculation NN O O
, , O O
one CD O O
thing NN O O
is VBZ O O
certain JJ O O
. . O O

While IN O O
using VBG O O
Tor NNP O O
may MD O O
help VB O O
you PRP O O
stay VB O O
anonymous JJ O O
, , O O
it PRP O O
does VBZ O O
at IN O O
the DT O O
same JJ O O
time NN O O
paint VBP O O
a DT O O
huge JJ O O
target NN O O
on IN O O
your PRP$ O O
back NN O O
. . O O

It PRP O O
's VBZ O O
never RB O O
a DT O O
good JJ O O
idea NN O O
to TO O O
download VB O O
binaries NNS O O
via IN O O
Tor FW O O
( FW O O
or CC O O
anything NN O O
else JJ O O
) NN O O
without IN O O
encryption NN O O
. . O O

The DT O O
problem NN O O
with IN O O
Tor NN O O
is VBZ O O
that IN O O
you PRP O O
have VBP O O
no DT O O
idea NN O O
who WP O O
is VBZ O O
maintaining VBG O O
the DT O O
exit NN O O
node NN O O
you PRP O O
are VBP O O
using VBG O O
and CC O O
what WP O O
their PRP$ O O
motives NNS O O
are VBP O O
. . O O

VPNs FW O O
( FW O O
such JJ O O
as IN O O
our PRP$ O O
Freedome NNP O O
VPN NNP O O
) NNP O O
will MD O O
encrypt VB O O
your PRP$ O O
connection NN O O
all PDT O O
the DT O O
way NN O O
through IN O O
the DT O O
Tor NNP O O
network NN O O
, , O O
so IN O O
the DT O O
maintainers NNS O O
of IN O O
Tor NN O O
exit NN O O
nodes NNS O O
will MD O O
not RB O O
see VB O O
your PRP$ O O
traffic NN O O
and CC O O
ca MD O O
n't RB O O
tamper VB O O
with IN O O
it PRP O O
. . O O

Samples NNPS O O
: : O O
