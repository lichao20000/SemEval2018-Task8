Downloaders NNS O O
, , O O
injectors NNS O O
, , O O
infostealers NNS O O
Example VBP O O
md5s NNS O O
of IN O O
files NNS O O
detected VBN O O
with IN O O
Kaspersky NNP O O
's POS O O
Virus.Win32.Pioneer.dx NN O O
and CC O O
Symantec NNP O O
's POS O O
Infostealer.Nemim NN O O
! . O O
inf NN O O
: : O O
To TO O O
ensure VB B-Action 1
only RB B-Entity 2
single JJ I-Entity O
instance NN I-Entity O
of IN I-Entity O
the DT I-Entity O
module NN I-Entity O
is VBZ I-Entity O
running VBG I-Entity O
, , O O
the DT B-Entity 3
module NN I-Entity O
verifies VBZ O O
if IN O O
system NN O O
mutex JJ O O
named VBN O O
«132DF6E» NN O O
exists VBZ O O
. . O O

If IN O O
it PRP O O
exists VBZ O O
the DT O O
module NN O O
exits NNS O O
, , O O
if IN O O
not RB O O
­the NN O O
module NN O O
creates VBZ O O
one CD O O
. . O O

The DT B-Entity 1
module NN I-Entity O
implements VBZ B-Action 2
a DT B-Entity 3
method NN I-Entity O
to TO B-Modifier 4
resist VB B-Entity 5
running VBG I-Entity O
in IN I-Entity O
virtual JJ I-Entity O
environment NN I-Entity O
. . O O

It PRP B-Entity 1
gets VBZ B-Action 2
CPU NNP B-Entity 3
name NN I-Entity O
and CC I-Entity O
identifier NN I-Entity O
from IN B-Modifier 4
the DT B-Entity 5
registry NN I-Entity O
at IN I-Entity O
HKLM\HARDWARE\DESCRIPTION\ FW I-Entity O
System\CentralProcessor\0 FW I-Entity O
and CC O O
collects VBZ B-Action 6
IP NNP B-Entity 7
and CC I-Entity O
MAC NNP I-Entity O
addresses NNS I-Entity O
of IN I-Entity O
local JJ I-Entity O
network NN I-Entity O
adapters NNS I-Entity O
. . O O

After IN O O
that IN O O
it PRP O O
compiles VBZ O O
a DT O O
string NN O O
describing VBG O O
the DT O O
system NN O O
in IN O O
the DT O O
following JJ O O
format NN O O
: : O O
« NN O O
C NN O O
P NN O O
U NN O O
: : O O
% NN O O
CPUNAME CD O O
% NN O O
< JJR O O
br IN O O
> JJR O O
Net JJ O O
card NN O O
: : O O
% NN O O
IP NNP O O
% NN O O
( CD O O
% NN O O
MACADDR NN O O
% NN O O
) NN O O
< JJR O O
br IN O O
> JJR O O
» NN O O
. . O O

Next IN O O
it PRP O O
checks VBZ O O
if IN O O
this DT O O
string NN O O
contains VBZ O O
one CD O O
of IN O O
the DT O O
following JJ O O
substrings NNS O O
: : O O
If IN O O
any DT O O
of IN O O
these DT O O
strings NNS O O
is VBZ O O
found VBN O O
, , O O
the DT O O
module NN O O
terminates VBZ O O
. . O O

After IN O O
that DT O O
, , O O
there EX O O
is VBZ O O
a DT O O
hardcoded JJ O O
value NN O O
of IN O O
10 CD O O
, , O O
which WDT O O
delays VBZ O O
further JJ O O
execution NN O O
of IN O O
the DT O O
module NN O O
for IN O O
10 CD O O
seconds NNS O O
. . O O

Then RB O O
the DT B-Entity 1
module NN I-Entity O
attempts VBZ O O
to TO O O
delete VB B-Action 2
some DT B-Entity 3
other JJ I-Entity O
, , I-Entity O
prob- JJ I-Entity O
ably RB I-Entity O
older JJR I-Entity O
, , I-Entity O
components NNS I-Entity O
which WDT I-Entity O
might MD I-Entity O
be VB I-Entity O
present JJ I-Entity O
on IN I-Entity O
the DT I-Entity O
system NN I-Entity O
. . O O

The DT O O
list NN O O
of IN O O
deleted JJ O O
files NNS O O
includes VBZ O O
the DT O O
following NN O O
: : O O
The DT O O
next JJ O O
is VBZ O O
step NN O O
is VBZ O O
to TO O O
check VB B-Action 1
if IN B-Entity 2
current JJ I-Entity O
directory NN I-Entity O
has VBZ I-Entity O
a DT I-Entity O
file NN I-Entity O
named VBN I-Entity O
«U» NN I-Entity O
. . O O

If IN O O
not RB O O
, , O O
the DT O O
module NN O O
proceeds VBZ O O
with IN O O
network NN O O
communication NN O O
routine NN O O
. . O O

But CC O O
if IN O O
this DT O O
file NN O O
is VBZ O O
found VBN O O
it PRP O O
does VBZ O O
some DT O O
additional JJ O O
checks NNS O O
. . O O

If IN O O
«U» NN O O
file NN O O
is VBZ O O
older JJR O O
than IN O O
180 CD O O
days NNS O O
, , O O
the DT B-Entity 1
module NN I-Entity O
wipes VBZ B-Action 2
the DT B-Entity 3
file NN I-Entity O
. . O O

If IN O O
not RB O O
, , O O
it PRP O O
triggers VBZ O O
a DT B-Entity 1
special JJ I-Entity O
variable NN I-Entity O
that WDT O O
makes VBZ B-Action 2
module NN B-Entity 3
dormant JJ B-Entity 4
and CC O O
dis- NN O O
ables VBZ O O
further JJ O O
communication NN O O
with IN O O
C NN O O
& CC O O
C NN O O
server NN O O
. . O O

After IN O O
all DT O O
, , O O
if IN O O
the DT O O
module NN O O
is VBZ O O
ready JJ O O
and CC O O
allowed VBN O O
to TO O O
communicate VB O O
with IN O O
C NN O O
& CC O O
C NN O O
server NN O O
it PRP O O
does VBZ O O
that IN O O
in IN O O
the DT O O
following JJ O O
manner NN O O
. . O O

1 CD O O
. . O O

The DT B-Entity 1
module NN I-Entity O
connects VBZ B-Action 2
to TO B-Modifier 3
autolace.twilightparadox.com FW B-Entity 4
( FW I-Entity O
or CC I-Entity O
automachine NN I-Entity O
. . I-Entity O
servequake.com FW I-Entity O
) FW I-Entity O
and CC O O
issues NNS B-Action 5
a DT B-Entity 6
HTTP NN I-Entity O
GET VB I-Entity O
request NN I-Entity O
with IN B-Modifier 7
hardcoded JJ B-Entity 8
User­Agent NN I-Entity O
string NN I-Entity O
: : O O
The DT O O
server NN O O
response NN O O
should MD O O
contain VB O O
«DEXT87» NN B-Entity 9
string NN I-Entity O
which WDT O O
is VBZ B-Action 10
used VBN I-Action O
to TO B-Modifier 11
rec- FW B-Entity 12
ognize FW I-Entity O
valid JJ I-Entity O
response NN I-Entity O
. . O O

The DT O O
malware NN O O
locates VBZ O O
«DEXT87» NN O O
and CC O O
reads VBZ O O
the DT O O
data NNS O O
appended VBN O O
to TO O O
it PRP O O
. . O O

The DT O O
appended VBN O O
data NNS O O
should MD O O
be VB O O
an DT O O
IP NNP O O
address NN O O
in IN O O
plaintext NN O O
. . O O

This DT O O
is VBZ O O
used VBN O O
a DT O O
real JJ O O
C NNP O O
& CC O O
C NNP O O
IP NNP O O
address NN O O
. . O O

Reading VBG O O
stops NNS O O
when WRB O O
non­digit NN O O
or CC O O
dot NN O O
symbol NN O O
is VBZ O O
found VBN O O
. . O O

Here RB O O
is VBZ O O
an DT O O
example NN O O
of IN O O
shortest JJS O O
possible JJ O O
valid JJ O O
server NN O O
response NN O O
: : O O
2 CD O O
. . O O

If IN O O
the DT O O
real JJ O O
C NNP O O
& CC O O
C NNP O O
IP NNP O O
address NN O O
is VBZ O O
not RB O O
valid JJ O O
the DT B-Entity 1
module NN I-Entity O
may MD O O
try VB O O
to TO O O
send VB B-Action 2
identical JJ B-Entity 3
request NN I-Entity O
again RB B-Entity 4
but CC O O
using VBG B-Modifier 5
a DT B-Entity 6
different JJ I-Entity O
HTTP NN I-Entity O
path NN I-Entity O
: : O O
If IN O O
the DT O O
C NNP O O
& CC O O
C NNP O O
IP NNP O O
address NN O O
is VBZ O O
valid JJ O O
, , O O
the DT B-Entity 7
module NN I-Entity O
issues NNS B-Action 8
another DT B-Entity 9
HTTP NNP I-Entity O
request NN I-Entity O
: : O O
The DT O O
server NN O O
response NN O O
can MD O O
be VB O O
one CD O O
of IN O O
the DT O O
following NN O O
: : O O
Where WRB O O
< JJR O O
DATASIZE NN O O
> JJR O O
is VBZ O O
a DT O O
decimal JJ O O
integer NN O O
that WDT O O
represents VBZ O O
length NN O O
of IN O O
< JJR O O
DATA NNP O O
> JJR O O
field NN O O
in IN O O
bytes; NN O O
< VBG O O
DATA NNP O O
> JJR O O
is VBZ O O
a DT O O
binary JJ O O
data NN O O
separated VBN O O
from IN O O
< JJR O O
DATASIZE NN O O
> JJR O O
field NN O O
by IN O O
semicolon NN O O
. . O O

Please VB O O
note NN O O
, , O O
that IN O O
after IN O O
receiving VBG O O
< JJR O O
DATA NNP O O
> JJR O O
, , O O
it PRP B-Entity 1
is VBZ B-Action 2
XORed VBN I-Action O
with IN B-Modifier 3
byte NN B-Entity 4
value NN I-Entity O
0x55 NN I-Entity O
and CC O O
saved VBD B-Action 5
to TO B-Modifier 6
a DT B-Entity 7
disk NN I-Entity O
in IN B-Modifier 8
a DT B-Entity 9
file NN I-Entity O
named VBN I-Entity O
«ctfmon.exe» FW I-Entity O
( FW O O
current JJ O O
directory NN O O
is VBZ O O
used VBN O O
) NN O O
. . O O

Upon IN O O
successful JJ O O
receiving NN O O
of IN O O
the DT O O
file NN O O
it PRP O O
is VBZ O O
started VBN O O
in IN O O
a DT O O
new JJ O O
process NN O O
. . O O

This DT O O
module NN O O
is VBZ O O
relatively RB O O
large JJ O O
( FW O O
455Kb FW O O
) FW O O
and CC O O
comes VBZ O O
as IN O O
a DT O O
part NN O O
of IN O O
WinRar NNP B-Entity 1
SFX NNP I-Entity O
file NN I-Entity O
that WDT O O
drops VBZ B-Action 2
and CC O O
starts VBZ B-Action 3
the DT B-Entity 4
module NN I-Entity O
from IN B-Modifier 5
% NN B-Entity 6
APPDATA CD I-Entity O
% NN I-Entity O
\Microsoft\Display\DmaUp3 NN I-Entity O
. . I-Entity O
exe NN I-Entity O
. . O O

The DT O O
main JJ O O
purpose NN O O
of IN O O
the DT B-Entity 1
module NN I-Entity O
is VBZ O O
to TO O O
collect VB B-Action 2
various JJ B-Entity 3
secrets NNS I-Entity O
stored VBN I-Entity O
on IN I-Entity O
a DT I-Entity O
local JJ I-Entity O
system NN I-Entity O
. . O O

This DT O O
module NN O O
is VBZ O O
designed VBN O O
not RB O O
to TO O O
run VB O O
on IN O O
Windows NNP O O
with IN O O
system NN O O
default NN O O
codepage NN O O
set VBN O O
to TO O O
Korean NNP O O
. . O O

From IN O O
the DT O O
very RB O O
beginning VBG O O
this DT B-Entity 1
module NN I-Entity O
checks NNS B-Action 2
if IN B-Entity 3
«bdagent.exe» NN I-Entity O
process NN I-Entity O
is VBZ I-Entity O
running VBG I-Entity O
on IN I-Entity O
current JJ I-Entity O
system NN I-Entity O
. . O O

Bdagent.exe NN O O
is VBZ O O
a DT O O
name NN O O
for IN O O
BitDefender NNP O O
Antivirus NNP O O
component NN O O
. . O O

If IN O O
it PRP O O
is VBZ O O
running VBG O O
, , O O
it PRP B-Entity 1
uses VBZ B-Action 2
simple JJ B-Entity 3
AV NN I-Entity O
heuristics NNS I-Entity O
evasion NN I-Entity O
technique NN I-Entity O
. . O O

The DT B-Entity 1
code NN I-Entity O
starts VBZ B-Action 2
a DT B-Entity 3
thread NN I-Entity O
that WDT I-Entity O
simulates VBZ I-Entity O
keystrokes NNS I-Entity O
of IN I-Entity O
ESC NN I-Entity O
keyboard NN I-Entity O
key NN I-Entity O
and CC I-Entity O
then RB I-Entity O
shows VBZ I-Entity O
a DT I-Entity O
system NN I-Entity O
modal JJ I-Entity O
message NN I-Entity O
box NN I-Entity O
. . O O

Pushing VBG O O
ESC NN O O
key NN O O
closes VBZ O O
the DT O O
modal JJ O O
message NN O O
box NN O O
. . O O

Right NNP O O
after IN O O
that DT O O
keystroke NN B-Entity 1
generation NN I-Entity O
thread NN I-Entity O
is VBZ B-Action 2
terminated VBN I-Action O
and CC O O
the DT O O
module NN O O
continues VBZ O O
normal JJ O O
execution NN O O
as IN O O
if IN O O
«bdagent.exe» NN O O
was VBD O O
not RB O O
running VBG O O
. . O O

Next IN O O
the DT B-Entity 1
module NN I-Entity O
makes VBZ B-Action 2
sure JJ I-Action O
only RB B-Entity 3
one CD I-Entity O
instance NN I-Entity O
of IN I-Entity O
current JJ I-Entity O
code NN I-Entity O
is VBZ I-Entity O
running VBG I-Entity O
by IN B-Modifier 4
checking NN B-Entity 5
if IN I-Entity O
system NN I-Entity O
mutex NNS I-Entity O
object VBP I-Entity O
named VBN I-Entity O
«920111215» NN I-Entity O
exists VBZ I-Entity O
. . O O

After IN O O
that DT O O
, , O O
the DT B-Entity 1
mod- FW I-Entity O
ule FW I-Entity O
collects VBZ B-Action 2
information NN B-Entity 3
about IN I-Entity O
current JJ I-Entity O
system NN I-Entity O
which WDT I-Entity O
includes VBZ I-Entity O
the DT I-Entity O
following NN I-Entity O
: : O O
If IN O O
the DT O O
module NN O O
reveals VBZ O O
that IN O O
current JJ O O
System NNP O O
default NN O O
codepage NN O O
is VBZ O O
0412 CD O O
( CD O O
Korean JJ O O
) NN O O
it PRP O O
terminates VBZ O O
. . O O

There EX O O
is VBZ O O
one CD O O
interesting JJ O O
specifics NNS O O
in IN O O
Microsoft NNP O O
IntelliForms NNP O O
which WDT O O
reveals VBZ O O
attack- FW O O
er FW O O
's POS O O
interests NNS O O
. . O O

IntelliForms NNP O O
technology NN O O
keeps VBZ O O
login/password JJ O O
information NN O O
in IN O O
the DT O O
registry NN O O
in IN O O
encrypted JJ O O
form NN O O
. . O O

However RB O O
, , O O
there EX O O
is VBZ O O
no DT O O
clear JJ O O
information NN O O
about IN O O
the DT O O
corre- FW O O
sponding FW O O
website NN O O
which WDT O O
requires VBZ O O
given VBN O O
login NN O O
and CC O O
password NN O O
. . O O

The DT O O
only JJ O O
information NN O O
Intelliforms NNS O O
offers VBZ O O
about IN O O
the DT O O
place NN O O
where WRB O O
given VBN O O
login/password NN O O
should MD O O
be VB O O
used VBN O O
is VBZ O O
a DT O O
hash NN O O
of IN O O
the DT O O
webpage NN O O
URL NN O O
. . O O

So IN O O
far RB O O
, , O O
the DT B-Entity 1
attackers NNS I-Entity O
can MD O O
steal VB B-Action 2
logins NNS B-Entity 3
and CC I-Entity O
pass- NN I-Entity O
words NNS I-Entity O
but CC O O
to TO O O
understand VB O O
where WRB O O
they PRP O O
are VBP O O
from IN O O
they PRP O O
must MD O O
guess VB O O
the DT O O
string NN O O
which WDT O O
produced VBD O O
given VBN O O
hash NN O O
. . O O

They PRP O O
have VBP O O
implemented VBN O O
this DT O O
logics NNS O O
in IN O O
the DT O O
malware NN O O
. . O O

When WRB O O
IntelliForms NNP B-Entity 1
information NN I-Entity O
is VBZ B-Action 2
stolen VBN I-Action O
the DT O O
malware NN O O
tries VBZ O O
to TO O O
check VB O O
the DT O O
list NN O O
of IN O O
known JJ O O
login NN O O
page NN O O
URLs NNS O O
to TO O O
recover VB O O
the DT O O
originating VBG O O
webpage NN O O
address NN O O
. . O O

Here RB O O
is VBZ O O
the DT O O
list NN O O
of IN O O
URLs NNS O O
that WDT O O
are VBP O O
checked VBN O O
by IN O O
the DT O O
malware NN O O
: : O O
The DT O O
list NN O O
of IN O O
targeted VBN O O
services NNS O O
includes VBZ O O
some DT O O
local JJ O O
services NNS O O
specifically RB O O
popular JJ O O
in IN O O
: : O O
The DT B-Entity 1
module NN I-Entity O
uses VBZ B-Action 2
several JJ B-Entity 3
simple JJ I-Entity O
XOR­based JJ I-Entity O
algorithms NNS I-Entity O
to TO B-Modifier 4
encrypt VB B-Entity 5
embedded JJ I-Entity O
string NN I-Entity O
data NNS I-Entity O
. . O O

String NNP O O
encryption/decryption NN O O
functions NNS O O
use VBP O O
the DT O O
following JJ O O
keys NNS O O
: : O O
The DT O O
module NN O O
works VBZ O O
with IN O O
all DT O O
Firefox NNP O O
versions NNS O O
prior RB O O
to TO O O
Mozilla NNP O O
Firefox NNP O O
12.0 CD O O
. . O O

Depend- FW O O
ing FW O O
on IN O O
version NN O O
of IN O O
Firefox NNP O O
, , O O
it PRP O O
can MD O O
read VB O O
Firefox NNP O O
database NN O O
directly RB O O
to TO O O
dump VB O O
stored VBN O O
se- NN O O
crets NNS O O
or CC O O
utilize VB O O
one CD O O
Firefox NNP O O
libraries NNS O O
to TO O O
access VB O O
the DT O O
configuration NN O O
data NNS O O
. . O O

In IN O O
addition NN O O
it PRP O O
makes VBZ O O
use NN O O
of IN O O
the DT O O
following JJ O O
Mozilla NNP O O
Firefox NNP O O
libraries NNS O O
depending VBG O O
on IN O O
Firefox NNP O O
version NN O O
: : O O
When WRB O O
stealing VBG B-Action 1
secrets NNS B-Entity 2
from IN B-Modifier 3
Firefox NNP B-Entity 4
and CC I-Entity O
Chrome NNP I-Entity O
it PRP B-Entity 5
uses VBZ O O
built­in FW O O
SQLite FW O O
library NN O O
code NN O O
. . O O

The DT O O
module NN O O
is VBZ O O
linked VBN O O
with IN O O
SQLite NN O O
version NN O O
3.7.5 CD O O
release NN O O
candidate NN O O
2 CD O O
, , O O
release NN O O
hash VBP O O
ed759d5a9edb3bba5f48f243df47be29e3fe8cd7 RB O O
dated VBN O O
as IN O O
2011­01­28 CD O O
17:03:50 CD O O
. . O O

After IN O O
stealing VBG B-Action 1
secrets NNS B-Entity 2
from IN B-Modifier 3
local JJ B-Entity 4
system NN I-Entity O
the DT B-Entity 5
malware NN I-Entity O
executes VBZ B-Action 6
some DT B-Entity 7
kind NN I-Entity O
of IN I-Entity O
embedded JJ I-Entity O
script NN I-Entity O
. . O O

It PRP B-Entity 1
is VBZ B-Action 2
logging VBG I-Action O
all DT B-Entity 3
actions NNS I-Entity O
to TO B-Modifier 4
inform VB B-Entity 5
the DT I-Entity O
operator NN I-Entity O
what WP I-Entity O
exactly RB I-Entity O
was VBD I-Entity O
executed VBN I-Entity O
by IN I-Entity O
this DT I-Entity O
variant NN I-Entity O
of IN I-Entity O
the DT I-Entity O
malware NN I-Entity O
. . O O

The DT B-Entity 1
result NN I-Entity O
of IN I-Entity O
this DT I-Entity O
execution NN I-Entity O
is VBZ O O
appended VBN O O
to TO O O
the DT O O
stolen VBN O O
data NNS O O
and CC O O
uploaded VBD B-Action 2
to TO B-Modifier 3
the DT B-Entity 4
C NN I-Entity O
& CC I-Entity O
C NN I-Entity O
server NN I-Entity O
. . O O

The DT B-Entity 1
module NN I-Entity O
uploads VBZ B-Action 2
all DT B-Entity 3
collected VBN I-Entity O
information NN I-Entity O
to TO B-Modifier 4
one CD B-Entity 5
of IN I-Entity O
the DT I-Entity O
following JJ I-Entity O
URLs NNS I-Entity O
via IN B-Modifier 6
POST NN B-Entity 7
request NN I-Entity O
: : O O
It PRP O O
's VBZ O O
the DT O O
first JJ O O
time NN O O
we PRP O O
see VBP O O
.pn JJ O O

domain NN O O
used VBN O O
in IN O O
malware NN O O
. . O O

This DT O O
top JJ O O
level NN O O
country NN O O
code NN O O
domain NN O O
is VBZ O O
quite RB O O
exotic JJ O O
and CC O O
is VBZ O O
assigned VBN O O
to TO O O
Pitcairn NNP O O
Islands NNP O O
, , O O
which WDT O O
is VBZ O O
Overseas NNP O O
ter- JJ O O
ritory NN O O
of IN O O
the DT O O
United NNP O O
Kingdom NNP O O
in IN O O
the DT O O
Pacific NNP O O
. . O O

As IN O O
of IN O O
2013 CD O O
estimated VBN O O
population NN O O
of IN O O
Pitcairn NNP O O
Islands NNP O O
is VBZ O O
only RB O O
56 CD O O
people NNS O O
. . O O

An DT O O
official JJ O O
.pn NN O O

domain NN O O
costs VBZ O O
$ $ O O
100/year CD O O
from IN O O
the DT O O
registry NN O O
, , O O
however RB O O
.eu.pn NN O O

domains NNS O O
seem VBP O O
to TO O O
be VB O O
given VBN O O
away RB O O
for IN O O
free JJ O O
. . O O

The DT O O
malware NN O O
uses VBZ O O
fixed VBN O O
User­Agent JJ O O
string NN O O
: : O O
The DT B-Entity 1
data NNS I-Entity O
is VBZ B-Action 2
uploaded VBN I-Action O
as IN B-Modifier 3
a DT B-Entity 4
POST NN I-Entity O
request NN I-Entity O
binary JJ I-Entity O
in IN B-Modifier 5
the DT B-Entity 6
following JJ I-Entity O
format NN I-Entity O
: : O O
where WRB O O
< JJR O O
UserId NN O O
> JJR O O
is VBZ O O
hardcoded JJ O O
identifier NN O O
( NNP O O
i.e NNP O O
. . O O

«user2» NN O O
in IN O O
current JJ O O
sample NN O O
) FW O O
; FW O O
< JJR O O
UniqueMachineId NN O O
> JJR O O
is VBZ O O
a DT O O
32 CD O O
characters NNS O O
long JJ O O
hex NN O O
string NN O O
which WDT O O
derived VBN O O
from IN O O
net- JJ O O
work NN O O
card NN O O
MAC NNP O O
address; NN O O
< JJR O O
EncryptionKey NN O O
> JJR O O
is VBZ O O
symmetrical JJ O O
encryption NN O O
key NN O O
used VBN O O
to TO O O
encrypt VB O O
< JJR O O
UserId NN O O
> JJR O O
and CC O O
< JJR O O
GeneralSysInfo NNP O O
> JJR O O
values NNS O O
. . O O

The DT O O
malware NN O O
uses VBZ O O
text NN O O
protocol NN O O
, , O O
which WDT O O
is VBZ O O
why WRB O O
potentially RB O O
binary JJ O O
values NNS O O
of IN O O
< JJR O O
UserId NN O O
> JJR O O
and CC O O
< JJR O O
GeneralSysInfo NNP O O
> JJR O O
are VBP O O
ad- JJ O O
ditionally RB O O
encoded VBN O O
using VBG O O
Base64 NN O O
algorithm NN O O
. . O O

< JJR O O
GeneralSysInfo NNP O O
> JJR O O
field NN O O
contains VBZ O O
only RB O O
basic JJ O O
information NN O O
about IN O O
the DT O O
system NN O O
, , O O
i.e NNP O O
. . O O

: : O O
If IN O O
the DT O O
server NN O O
reply NN O O
contains VBZ O O
a DT O O
keyword FW O O
«minmei» FW O O
it PRP B-Entity 1
continues VBZ O O
sending VBG B-Action 2
additional JJ B-Entity 3
in- NN I-Entity O
formation NN I-Entity O
. . O O

«Minmei» NN O O
may MD O O
be VB O O
a DT O O
reference NN O O
to TO O O
a DT O O
popular JJ O O
Japanese JJ O O
anime NN O O
and CC O O
manga NN O O
known VBN O O
as IN O O
«The JJ O O
Super JJ O O
Dimension NN O O
Fortress NN O O
Macross» NN O O
. . O O

A DT O O
quote NN O O
from IN O O
Wikipedia NNP O O
: : O O
«Born NN O O
in IN O O
Yokohama NNP O O
Chinatown NNP O O
, , O O
Japan NNP O O
( NNP O O
though IN O O
she PRP O O
is VBZ O O
of IN O O
partial JJ O O
Chinese JJ O O
descent NN O O
) NN O O
as IN O O
Linn NNP O O
Minmei NNP O O
, , O O
Minmay NNP O O
moved VBD O O
in RP O O
with IN O O
her PRP$ O O
uncle NN O O
Shaochin FW O O
( FW O O
少江 FW O O
) NN O O
and CC O O
aunt NN O O
Feic- NNP O O
hun NNP O O
( NNP O O
慧中 NNP O O
) NNP O O
on IN O O
South NNP O O
Ataria NNP O O
Island NNP O O
in IN O O
hopes NNS O O
of IN O O
finding VBG O O
the DT O O
path NN O O
to TO O O
fulfill VB O O
her PRP$ O O
dream NN O O
of IN O O
becoming VBG O O
a DT O O
star.» NN O O
The DT B-Entity 1
trojan NN I-Entity O
iterates VBZ B-Action 2
through IN B-Modifier 3
running VBG B-Entity 4
processes NNS I-Entity O
and CC O O
looks VBZ B-Action 5
for IN B-Modifier 6
security NN B-Entity 7
software NN I-Entity O
basing VBG I-Entity O
on IN I-Entity O
executable JJ I-Entity O
filenames NNS I-Entity O
from IN I-Entity O
the DT I-Entity O
list NN I-Entity O
below IN I-Entity O
. . O O

If IN O O
the DT O O
process NN O O
is VBZ O O
found VBN O O
it PRP O O
keeps VBZ O O
a DT O O
record NN O O
of IN O O
the DT O O
software NN O O
name NN O O
using VBG O O
short JJ O O
AV NNP O O
Identifier NNP O O
string NN O O
from IN O O
the DT O O
fol- FW O O
lowing FW O O
table NN O O
of IN O O
rules NNS O O
The DT B-Entity 1
malware NN I-Entity O
uses VBZ O O
a DT O O
trick NN O O
to TO O O
evade VB B-Action 2
running VBG B-Entity 3
on IN I-Entity O
a DT I-Entity O
VMware NNP I-Entity O
. . O O

First NNP O O
, , O O
it PRP B-Entity 1
checks VBZ B-Action 2
if IN B-Entity 3
cur- JJ I-Entity O
rent NN I-Entity O
process NN I-Entity O
is VBZ I-Entity O
running VBG I-Entity O
in IN I-Entity O
WOW64 NN I-Entity O
environment NN I-Entity O
. . O O

If IN O O
yes RB O O
it PRP O O
does VBZ O O
additional JJ O O
port NN O O
I/O NN O O
specific JJ O O
to TO O O
VMWare VB O O
virtual JJ O O
machine NN O O
( CD O O
the DT O O
VMware NN O O
hypervisor NN O O
port NN O O
: : O O
0x5658; FW O O
VMware FW O O
hypervisor NN O O
magic NN O O
value NN O O
: : O O
0x564D5868 FW O O
) FW O O
. . O O

Another DT B-Entity 1
method NN I-Entity O
to TO O O
detect VB B-Action 2
VM FW B-Entity 3
en- FW I-Entity O
vironment NN I-Entity O
is VBZ O O
to TO O O
check VB B-Action 4
local JJ B-Entity 5
network NN I-Entity O
adapter NN I-Entity O
's POS I-Entity O
IP NNP I-Entity O
address NN I-Entity O
. . O O

If IN O O
it PRP O O
belongs VBZ O O
to TO O O
subnet VB O O
192.168.100 CD O O
. . O O

* SYM O O
then RB O O
the DT O O
malware NN O O
believes VBZ O O
it PRP O O
's VBZ O O
running VBG O O
in IN O O
a DT O O
VM NN O O
. . O O

If IN B-Modifier 1
VM NN B-Entity 2
is VBZ I-Entity O
detected VBN I-Entity O
the DT B-Entity 3
process NN I-Entity O
instantly RB O O
terminates VBZ B-Action 4
. . O O

Next IN O O
the DT B-Entity 1
malware NN I-Entity O
submits VBZ B-Action 2
collected VBN B-Entity 3
information NN I-Entity O
to TO B-Modifier 4
the DT B-Entity 5
C NN I-Entity O
& CC I-Entity O
C NN I-Entity O
server NN I-Entity O
using VBG B-Modifier 6
HTTP NN B-Entity 7
GET VBP I-Entity O
request NN I-Entity O
and CC I-Entity O
the DT I-Entity O
following VBG I-Entity O
URL NN I-Entity O
format NN I-Entity O
: : I-Entity O
http NN I-Entity O
: : I-Entity O
// NN I-Entity O
< JJR I-Entity O
C2DOMAIN CD I-Entity O
> JJR I-Entity O
/bin/readi.php NN I-Entity O
? . I-Entity O
a1= CD I-Entity O
% NN I-Entity O
STEPID NN I-Entity O
% NN I-Entity O
& CC I-Entity O
a2= CD I-Entity O
% NN I-Entity O
HOSTID NN I-Entity O
% NN I-Entity O
& CC I-Entity O
a3= CD I-Entity O
% NN I-Entity O
SYSINFO NN I-Entity O
% NN I-Entity O
& CC I-Entity O
a4= CD I-Entity O
% NN I-Entity O
AVSOFTID NN I-Entity O
% NN I-Entity O
, , I-Entity O
where WRB I-Entity O
% NN I-Entity O
C2DOMAIN CD I-Entity O
% NN I-Entity O
is VBZ I-Entity O
one CD I-Entity O
of IN I-Entity O
the DT I-Entity O
following VBG I-Entity O
C NN I-Entity O
& CC I-Entity O
C NN I-Entity O
domains NNS I-Entity O
: : O O
% NN O O
STEPID CD O O
% NN O O
is VBZ O O
special JJ O O
text NN O O
string NN O O
indicating VBG O O
stage NN O O
of IN O O
malware NN O O
operation NN O O
. . O O

This DT O O
string NN O O
varies VBZ O O
depending VBG O O
on IN O O
the DT O O
local JJ O O
system NN O O
language NN O O
and CC O O
may MD O O
be VB O O
one CD O O
of IN O O
the DT O O
following NN O O
: : O O
% NN O O
HOSTID CD O O
% NN O O
is VBZ O O
a DT O O
special JJ O O
value NN O O
generated VBN O O
from IN O O
local JJ O O
network NN O O
card NN O O
MAC NNP O O
address; CD O O
% NN O O
SYSINFO NN O O
% NN O O
is VBZ O O
a DT O O
string NN O O
with IN O O
general JJ O O
system NN O O
information NN O O
( NN O O
please VBP O O
see VB O O
description NN O O
above IN O O
) FW O O
; FW O O
% NN O O
AVSOFTID NN O O
% NN O O
is VBZ O O
a DT O O
string NN O O
that WDT O O
contains VBZ O O
indexes NNS O O
of IN O O
AV NN O O
software NN O O
names NNS O O
in IN O O
internal JJ O O
table NN O O
of IN O O
AV NN O O
Identifiers NNS O O
( RB O O
please VBP O O
see VB O O
the DT O O
table NN O O
above IN O O
) NN O O
. . O O

Igfxext.exe NN B-Entity 1
can MD O O
download VB B-Action 2
a DT B-Entity 3
file NN I-Entity O
and CC O O
drop VB B-Action 4
it PRP B-Entity 5
to TO B-Modifier 6
% NN B-Entity 7
APPDATA CD I-Entity O
% NN I-Entity O
\microsoft\dis- FW I-Entity O
play\ctfmon.exe FW I-Entity O
( FW I-Entity O
md5= FW I-Entity O
e8bfb82b0dd5cef46116d61f62c25060 FW I-Entity O
) FW I-Entity O
. . O O

After IN O O
execution NN O O
, , O O
the DT B-Entity 1
downloaded VBN I-Entity O
file NN I-Entity O
drops VBZ B-Action 2
SMAGENT.EXE NNP B-Entity 3
( NNP I-Entity O
md5 NNP I-Entity O
0306f9ae- NNP I-Entity O
7786570139f78e78bc940597 NNP I-Entity O
) NNP I-Entity O
to TO B-Modifier 4
% NN B-Entity 5
APPDATA CD I-Entity O
% NN I-Entity O
\MICROSOFT\DISPLAY NN I-Entity O
and CC O O
ex- FW B-Action 6
ecutes FW I-Action O
it PRP B-Entity 7
. . O O

This DT B-Entity 1
component NN I-Entity O
is VBZ O O
a DT O O
virus NN O O
, , O O
and CC O O
is VBZ O O
used VBN O O
to TO O O
selectively RB O O
infiltrate VB B-Action 2
into IN B-Modifier 3
other JJ B-Entity 4
computers NNS I-Entity O
via IN B-Modifier 5
USB JJ B-Entity 6
or CC O O
network NN B-Entity 7
shares NNS I-Entity O
. . O O

A DT O O
large JJ O O
number NN O O
of IN O O
files NNS O O
are VBP O O
detected VBN O O
by IN O O
Kaspersky NNP O O
Lab NNP O O
scanners NNS O O
as IN O O
Virus.Win32 NN O O
. . O O

Pioneer.dx NN O O
. . O O

These DT B-Entity 1
files NNS I-Entity O
are VBP O O
all DT O O
legitimate JJ O O
files NNS O O
that WDT O O
have VBP O O
been VBN B-Action 2
infected VBN I-Action O
by IN O O
another DT B-Entity 3
Darkhotel NNP I-Entity O
component NN I-Entity O
. . O O

All DT B-Entity 1
of IN I-Entity O
these DT I-Entity O
infected JJ I-Entity O
files NNS I-Entity O
drop VBP B-Action 2
a DT B-Entity 3
63kb JJ I-Entity O
self NN I-Entity O
injecting VBG I-Entity O
compo- FW I-Entity O
nent FW I-Entity O
. . O O

This DT O O
malware NN O O
is VBZ O O
63kb JJ O O
in IN O O
size NN O O
. . O O

It PRP O O
is VBZ O O
bound VBN O O
to TO O O
a DT O O
variety NN O O
of IN O O
other JJ O O
software NN O O
packages NNS O O
that WDT O O
vary VBP O O
in IN O O
name NN O O
, , O O
but CC O O
the DT O O
host NN O O
package NN O O
is VBZ O O
consistently RB O O
detected VBN O O
as IN O O
'' '' O O
Virus.Win32 NN O O
. . O O

Pioneer.dx NN O O
'' '' O O
. . O O

The DT B-Entity 1
igfxext.exe NN I-Entity O
component NN I-Entity O
is VBZ B-Action 2
dropped VBN I-Action O
to TO B-Modifier 3
disk NN B-Entity 4
and CC O O
run NN B-Action 5
. . O O

It PRP B-Entity 1
spawns VBZ B-Action 2
an- JJ B-Entity 3
other JJ I-Entity O
suspended JJ I-Entity O
process NN I-Entity O
with IN B-Modifier 4
its PRP$ B-Entity 5
own JJ I-Entity O
igfxext.exe NN I-Entity O
image NN I-Entity O
, , O O
but CC O O
decrypts VBZ O O
a DT O O
smaller JJR O O
32kb JJ O O
executable JJ O O
( NN O O
cf1319d94f33380622ba000b7d8ad6e9 NN O O
, , O O
Trojan­Downloader NN O O
. . O O

Win32.Agent.xwge FW O O
) FW O O
from IN O O
its PRP$ O O
.data NN O O

section NN O O
in IN O O
memory NN O O
with IN O O
a DT O O
simple JJ O O
xor FW O O
0xbb FW O O
. . O O

The DT B-Entity 1
running VBG I-Entity O
process NN I-Entity O
overwrites VBZ B-Action 2
the DT B-Entity 3
igfxext.exe NN I-Entity O
image NN I-Entity O
in IN B-Modifier 4
the DT B-Entity 5
suspended JJ I-Entity O
process NN I-Entity O
with IN B-Modifier 6
this DT B-Entity 7
smaller JJR I-Entity O
chunk NN I-Entity O
of IN I-Entity O
code NN I-Entity O
. . O O

It PRP O O
then RB O O
resumes VBZ O O
the DT O O
thread NN O O
in IN O O
the DT O O
new JJ O O
process NN O O
. . O O

This DT O O
smaller JJR O O
code NN O O
section NN O O
maintains VBZ O O
similar JJ O O
functionality NN O O
to TO O O
the DT O O
'' '' O O
worm NN O O
'' '' O O
compo- FW O O
nent FW O O
: : O O
Host NN B-Entity 1
package NN I-Entity O
files NNS I-Entity O
detected VBN I-Entity O
as IN I-Entity O
'' '' I-Entity O
Virus.Win32.Pioneer.dx NN I-Entity O
'' '' I-Entity O
are VBP B-Action 2
infected JJ B-Entity 3
legitimate JJ I-Entity O
files NNS I-Entity O
, , O O
that WDT O O
do VBP O O
not RB O O
have VB O O
any DT O O
self­propagation NN O O
routines NNS O O
. . O O

It PRP O O
is VBZ O O
signed VBN O O
with IN O O
the DT O O
familiar JJ O O
'' '' O O
'' '' O O
digital JJ O O
certificate NN O O
. . O O

This DT B-Entity 1
sample NN I-Entity O
is VBZ B-Action 2
started VBN I-Action O
by IN O O
code NN B-Entity 3
running VBG I-Entity O
within IN I-Entity O
svchost.exe NN I-Entity O
on IN I-Entity O
WinXP NN I-Entity O
SP3 NN I-Entity O
. . O O

It PRP B-Entity 1
drops VBZ B-Action 2
a DT B-Entity 3
keylogger NN I-Entity O
. . O O

The DT O O
debug JJ O O
path NN O O
inside NN O O
: : O O
The DT B-Entity 1
dropper NN I-Entity O
above IN I-Entity O
maintains VBZ B-Action 2
, , I-Action O
drops VBZ I-Action O
and CC I-Action O
installs VBZ I-Action O
this DT B-Entity 3
kernel NN I-Entity O
mode NN I-Entity O
keylogger NN I-Entity O
: : O O
Likely RB O O
, , O O
it PRP O O
was VBD O O
developed VBN O O
as IN O O
a DT O O
part NN O O
of IN O O
a DT O O
mid­to­late JJ O O
2009 CD O O
project NN O O
: : O O
This DT O O
driver NN O O
package NN O O
is VBZ O O
built VBN O O
to TO O O
look VB O O
like IN O O
a DT O O
legitimate JJ O O
low JJ O O
level NN O O
Microsoft NNP O O
system NN O O
device NN O O
. . O O

It PRP B-Entity 1
is VBZ B-Action 2
installed VBN I-Action O
as IN B-Modifier 3
a DT B-Entity 4
system NN I-Entity O
kernel NN I-Entity O
driver NN I-Entity O
'' '' I-Entity O
Ndiskpro NNP I-Entity O
'' '' I-Entity O
service NN I-Entity O
, , O O
described VBN O O
as IN O O
a DT O O
'' '' O O
Microcode NNP O O
Update NNP O O
Device NNP O O
'' '' O O
. . O O

It PRP O O
is VBZ O O
somewhat RB O O
surprising JJ O O
that IN O O
there EX O O
is VBZ O O
no DT O O
rootkit NN O O
functionality NN O O
hiding VBG O O
this DT O O
service NN O O
: : O O
When WRB O O
loaded VBN B-Action 1
, , O O
the DT B-Entity 2
NDISKPRO.SYS NN I-Entity O
driver NN I-Entity O
hooks NNS B-Action 3
both CC B-Entity 4
INT FW I-Entity O
0x01 FW I-Entity O
and CC I-Entity O
INT FW I-Entity O
0xff FW I-Entity O
, , O O
and CC O O
retrieves VBZ B-Action 5
keystroke NN B-Entity 6
data NNS I-Entity O
directly RB B-Modifier 7
from IN I-Modifier O
port JJ B-Entity 8
0x60 NN I-Entity O
, , I-Entity O
the DT I-Entity O
motherboard NN I-Entity O
keyboard NN I-Entity O
con- NN I-Entity O
troller NN I-Entity O
itself PRP I-Entity O
. . O O

Here RB O O
we PRP O O
see VBP O O
the DT O O
local JJ O O
port NN O O
variables NNS O O
assigned VBD O O
values NNS O O
And CC O O
here RB O O
, , O O
the DT O O
ports NNS O O
are VBP O O
directly RB O O
being VBG O O
read VBN O O
with IN O O
READPORTUCHAR NN O O
( FW O O
0x64 FW O O
) FW O O
and CC O O
then RB O O
READPORTUCHAR NNP O O
( NNP O O
0x60 NNP O O
) NNP O O
: : O O
It PRP O O
buffers VBZ O O
, , O O
then RB O O
communicates VBZ O O
the DT O O
data NNS O O
to TO O O
the DT O O
running VBG O O
user NN O O
mode NN O O
component NN O O
. . O O

This DT B-Entity 1
component NN I-Entity O
then RB O O
encrypts VBZ B-Action 2
and CC O O
writes VBZ B-Action 3
the DT B-Entity 4
retrieved VBN I-Entity O
values NNS I-Entity O
ondisk VBP I-Entity O
to TO B-Modifier 5
a DT B-Entity 6
ran- NN I-Entity O
domly RB I-Entity O
named VBN I-Entity O
.tmp NN I-Entity O
, , I-Entity O
file NN I-Entity O
like IN I-Entity O
ffffz07131101.tmp NN I-Entity O
. . O O

This DT O O
file NN O O
is VBZ O O
located JJ O O
in IN O O
the DT O O
same JJ O O
directory NN O O
as IN O O
the DT B-Entity 1
original JJ I-Entity O
dropper NN I-Entity O
, , O O
which WDT O O
maintains VBZ B-Action 2
persistence NN B-Entity 3
across IN B-Modifier 4
reboots NNS B-Entity 5
with IN B-Modifier 6
a DT B-Entity 7
simple JJ I-Entity O
addition NN I-Entity O
to TO I-Entity O
the DT I-Entity O
HKCU NNP I-Entity O
run NN I-Entity O
key NN I-Entity O
. . O O

Here RB O O
is VBZ O O
debug JJ O O
output NN O O
demonstrating VBG O O
this DT O O
component NN O O
's POS O O
data NNS O O
retrieval NN O O
when WRB O O
the DT O O
letter NN O O
'' '' O O
D NN O O
'' '' O O
is VBZ O O
repeatedly RB O O
pressed VBN O O
on IN O O
the DT O O
keyboard NN O O
. . O O

Keyscan NNP O O
make VB O O
and CC O O
break VB O O
codes NNS O O
are VBP O O
'' '' O O
0x20 NN O O
'' '' O O
and CC O O
'' '' O O
0xA0 NN O O
'' '' O O
and CC O O
for IN O O
the DT O O
key JJ O O
press NN O O
and CC O O
key JJ O O
release NN O O
for IN O O
the DT O O
'' '' O O
D NN O O
'' '' O O
key NN O O
. . O O

The DT O O
'' '' O O
0x1D NN O O
'' '' O O
value NN O O
from IN O O
port JJ O O
0x64 NN O O
that IN O O
you PRP O O
see VBP O O
below IN O O
is VBZ O O
basically RB O O
an DT O O
indication NN O O
that IN O O
the DT O O
output NN O O
buffer NN O O
is VBZ O O
full JJ O O
and CC O O
the DT O O
keyboard NN O O
is VBZ O O
locked VBN O O
, , O O
so IN O O
it PRP O O
is VBZ O O
safe JJ O O
for IN O O
the DT O O
driver NN O O
to TO O O
access VB O O
the DT O O
key JJ O O
value NN O O
in IN O O
port JJ O O
0x60 NN O O
: : O O
These DT O O
debug JJ O O
messages NNS O O
and CC O O
code NN O O
style NN O O
are VBP O O
duplicates NNS O O
of IN O O
what WDT O O
chpie NN O O
posted VBD O O
in IN O O
the DT O O
past NN O O
. . O O

This DT B-Entity 1
keylogger NN I-Entity O
module NN I-Entity O
encrypts NNS B-Action 2
and CC O O
stores NNS B-Action 3
gathered VBD B-Entity 4
data NNS I-Entity O
in IN B-Modifier 5
a DT B-Entity 6
log NN I-Entity O
file NN I-Entity O
, , O O
as IN O O
men- NN O O
tioned VBD O O
previously RB O O
. . O O

Its PRP$ O O
encryption NN O O
algorithm NN O O
is VBZ O O
similar JJ O O
to TO O O
RC4 NN O O
. . O O

Interesting JJ O O
part NN O O
is VBZ O O
that IN O O
the DT O O
module NN O O
randomly RB O O
generates VBZ O O
the DT O O
key NN O O
and CC O O
stores NNS O O
it PRP O O
in IN O O
an DT O O
unexpected JJ O O
place NN O O
: : O O
in IN O O
the DT O O
middle NN O O
of IN O O
the DT O O
log NN O O
file NN O O
name NN O O
. . O O

Hence RB O O
, , O O
the DT O O
numeric JJ O O
part NN O O
of IN O O
the DT O O
filename NN O O
is VBZ O O
used VBN O O
as IN O O
a DT O O
seed NN O O
for IN O O
the DT O O
pseudorandom NN O O
number NN O O
generator NN O O
. . O O

Rand NNP O O
function NN O O
is VBZ O O
statically RB O O
linked VBN O O
to TO O O
insure VB O O
same JJ O O
results NNS O O
on IN O O
different JJ O O
computers NNS O O
. . O O

Here RB O O
is VBZ O O
the DT O O
commented VBN O O
RC4 NN O O
encryption NN O O
code NN O O
: : O O
