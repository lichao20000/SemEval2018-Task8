opens O
The O
dropper O

corrects O
The O
dropper O

load O
the O
dropper O

implements O
This O
export O

socially 092
engineer 092
the 092
intended 092
victim 092

is O
This O
sample O

dropped 118
the 118
dropper 118
sample 118
file 118

is O
mapped O
it O

replaces O
the O
malware O

install O
the O
malware O

installed O
a O
Dynamic O
Link O
Library O
(DLL) O

use O
the O
sample O

writes O
the O
sample O

creates O
The O
registry O
change O

set O
the O
subroutine O

be O
changed O
The O
next O
key O

set O
the O
‘msupdate’ O
key O

is O
registered O
The O
export O
‘CollectW3PerfData’ O

starts O
the O
sample O

spawns O
the O
sample O

set O
permissions O

infect 092
a 092
post 092
exploitation 092
tool 092

allows O
This O

cleaning 121
up 121
the 121
components 121
dropped 121
by 121
the 121
malware 121

remains O
the O
system O

download 118
a 118
post 118
exploitation 118
tool 118

fool O
some O
automated O
dynamic O
analysis O
or O
anti-malware O
software O

initiates O
the O
routine O

access O
the O
sample O

provided 100
All 100
three 100
samples 100

is O
handled O
The O
communication O
to O
the O
C2 O

connect O
the O
sample O

connect O
the O
sample O

sends 050
The 050
malicious 050
sample 050

remove 085
a 085
post 085
exploitation 085
tool 085

is 053
encrypted 053
The 053
beacon 053

sent 050
The 050
beacon 050

receiving 047
the 047
routine 047

executes 047
the 047
routine 047

sending 050
the 050
routine 050

is O
received O
This O
inbound O
payload O

is 100
The 100
primary 100
aim 100
of 100
this 100
backdoor 100

view 146
the 146
adversary 146

control 140
the 140
adversary 140

control 142
the 142
adversary 142

is 100
implemented 100
This 100
remote 100
control 100
functionality 100

be 100
used 100
itself 100

initiates 146
The 146
command 146
0x22000001 146

are 146
created 146
The 146
screen 146
captures 146

remove 120
0x20000000 120

is 100
then 100
started 100
The 100
backdoor 100

is O
created O
a O
temporary O
new O
user O
“_DomainUser_” O
with O
password O
“Dom4!nU- O
serP4ss” O

added O
a O
temporary O
new O
user O
“_DomainUser_” O
with O
password O
“Dom4!nU- O
serP4ss” O

is O
deleted O
the O
user O

obfuscate 019
this 019
technique 019

issued 047
commands 047

is O
initiated O
a O
connection O
to O
the O
C2 O

having O
The O
third O
sample O

support 032
The 032
command 032
line 032
options 032

support O
The O
command O
line O
options O

support O
The O
command O
line O
options O

support O
launching O
the O
executable O

support O
specifying O
a O
specific O
C2 O

filter O
the O
backdoor O

remove 085
the 085
backdoor 085

modifies 032
This 032
command 032

act O
The O
third O
sample O

is O
generally O
associated O
This O
activity O

is 052
accomplished 052
Authentication 052

sending 052
the 052
initial 052
authentication 052
packet 052

sent 052
An 052
example 052
authentication 052
packet 052

verifies 052
the 052
sample 052

is O
sent O
an O
8 O
byte O
key O

encrypt 025
and 025
decrypt 025
AES 025
encryption 025

process 047
and 047
execute 047
Command 047
handling 047
loop 047

utilized O
The O
third O
sample O

sends 049
The 049
malware 049

receives 049
The 049
malware 049

download O
files O

upload O
files O

installing 118
new 118
.NET 118
assemblies 118

calling O
methods O

connecting O
to O
new O
C2 O
servers O

executing O
processes O

hide O
The O
third O
sample O

is 100
This 100
sample 100

implements O
This O
sample O

be O
registered O
a O
DLL O

drop 118
This 118
sample 118

provide 047
This 047
sample 047

bypass 130
It 130

copies O
it O

modify 032
it 032

Adds O
itself O

Adds O
itself O

creates O
a O
copy O
of O
regsvr32.exe O
named O
Update.exe O

schedules O
the O
copy O

is O
likely O
used O
This O
third O
component O

'dropping' 118
The 118
sample 118

writing O
the O
driver O

is O
loaded O
it O

is 023
encrypted 023
The 023
driv- 023
er 023

loads O
the O
backdoor O

downloading 048
a 048
list 048
of 048
C2 048
servers 048

specifies O
the O
default O
configuration O
present O

extracting 118
from 118
itself 118

has O
The O
malware O

contains O
The O
con- O
figuration O

attempts O
the O
malware O

being O
sent O
64 O
random O
bytes O

sending O
chunks O
of O
POST O
payload O

receiving O
chunks O
of O
the O
response O

serves O
The O
GET O
request O

serves O
the O
POST O
request O

contains O
the O
malware O

use O
a O
custom O
DNS O
client O
implementation O

tunnel O
a O
custom O
DNS O
client O
implementation O

sending O
the O
malware O

receiving O
the O
malware O

reads 047
The 047
main 047
backdoor 047
thread 047

initialize 118
and 118
install 118
The 118
executable 118
14c04f88dc97aef3e9b516ef208a2bf5 118

implements 138
This 138
handler 138
class 138
for 138
command 138
ID 138
8 138

reading 047
This 047
handler 047
class 047
for 047
command 047
ID 047
8 047

writing 047
arbitrary 047
files 047

upload O
This O
handler O
class O
for O
command O
ID O
8 O

download O
arbitrary O
files O

searching O
specific O
files O

exfiltrate O
specific O
files O

launching O
this O
class O

implements O
This O
handler O
class O

establishing O
It O

listening O
It O

are O
forwarded O
The O
incoming O
connection O
contents O

is O
passed O
data O
from O
the O
C2 O

gathering O
The O
malware O

recovering 082
authentication 082
credentials 082

enables 100
the 100
malicious 100
payload 100

gathering O
This O
class O

identifying 131
This 131
class 131

identifying 111
proxy 111
accounts 111

identifying 113
version 113
numbers 113
for 113
the 113
Operating 113
System 113
(OS) 113

identifying 114
Internet 114
Explorer 114

manage 100
This 100
handler 100
class 100

start 100
This 100
handler 100
class 100

stop 100
This 100
handler 100
class 100

delete 100
This 100
handler 100
class 100

enumerate 100
This 100
handler 100
class 100

alter 100
This 100
handler 100
class 100

manage 100
This 100
handler 100
class 100

take 146
a 146
screen 146
shot 146
of 146
the 146
users 146
desktop 146

implements 047
This 047
handler 047
class 047

invoke O
the O
malware O

launching O
the O
malware O

is O
provided O
The O
standard O
output O
channel O
of O
that O
command O

deleting 120
the 120
DLL 120

terminating O
the O
DLL O

invokes O
The O
dropper O

opening O
The O
driver O

avoid O
multiple O
instances O
of O
itself O

creates O
the O
driver O

performs O
The O
second O
component O
of O
the O
entry O
point O

calling O
The O
second O
component O
of O
the O
entry O
point O

disable 012
the 012
driver 012

hooking O
The O
final O
step O
of O
the O
entry O
point O

hook O
one O

resolves O
The O
sample O

hooks O
the O
other O

queries 113
The 113
network 113
stack 113
hooking 113

hooks O
the O
driver O

scan 098
the 098
hook 098

hide 025
the 025
hook 025

is O
performed O
The O
hooking O

hooking O
The O
TCP O
hook O

filters 098
This 098
hook 098

hooks O
The O
unpacked O
kernel O
driver O
sample O

is O
then O
performed O
The O
system O
call O
hook O

applying O
a O
Detours-style O
hook O

checks O
It O

applies O
it O

write O
The O
dropper O

hide 029
this 029
driver 029

is O
made O
a O
call O

avoids O
the O
backdoor O
DLL O
sample O
with O
an O
MD5 O
of O
de7500fc1065a081180841f32f06a537 O

used O
the O
various O
network O
hooking O
techniques O

perform O
system O
call O
hooking O

performing O
a O
cached O
rootkit O

contains 100
The 100
dropped 100
DLL 100
(MD5: 100
47619fca20895abc83807321cbb80a3d) 100
itself 100

used O
PRC O
based O
actors O

be 118
dropped 118
a 118
client-side 118
exploit 118

executed O
a O
client-side O
exploit O

launch O
the O
adversary O

utilizes 025
The 025
sample 025

is 100
This 100
DLL 100

has O
This O
sample O

implements O
It O

select O
The O
tool O

avoid O
detection O
from O
solutions O
like O
DNS O
blacklisting O
and O
RFC O
protocol O
enforcement O

act O
The O
sample O

proxy O
The O
sample O

sets 032
The 032
dropper 032

shares O
the O
C2 O
client O
which O
would O
communicate O
with O
this O
sample O

dropped 118
the 118
Backdoor 118
DLL 118

blend 032
in 032
the 032
newly 032
created 032
malicious 032
 032
DLL 032

implements O
This O
kernel O
mode O
rootkit O

preventing O
This O
kernel O
mode O
rootkit O

hide 025
This 025
driver 025

dropped 118
the 118
Backdoor 118
DLL 118

implements O
This O
kernel O
mode O
rootkit O

preventing O
This O
kernel O
mode O
rootkit O

hide 025
This 025
driver 025

prevent O
This O

is 023
hidden 023
The 023
malicious 023
DLL 023
file 023
that 023
is 023
dropped 023

write O
One O
sample O

writes O
the O
dropper O

prevents O
the O
file O

